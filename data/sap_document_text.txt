6.1 Data Services functions
Functions in SAP Data Services take input values and produce a return value.
Some functions produce the same or similar values as transforms. However, functions operate on single values
and transforms operate on data sets. Use functions alone or include functions in expressions. Data Services
provides many built-in functions for you to use. You can also create custom functions by using Data Services
scripting language and the Smart Editor.
Data Services can perform implicit data type conversions on date, time, datetime, and interval values.
Find complete details about working with functions in the Designer Guide.
Related Information
Smart Editor and the function wizard [page 1038]
Data Services scripting language [page 1291]
Reference Guide
Data Services functions and procedures PUBLIC 1041
6.1.1  Data Services function types
The function type determines where you can use a function.
The following table describes each type of function and where you can call it from.
Function types
Type Description
Aggregate Generates a single value from a set of values. Aggregate functions, such as max, min, and count, use the
data set specified by the expression in the Group By tab of a query.
Call an aggregate function only from within a Query transform. You cannot call an aggregate function from
custom functions or scripts.
Iterative Maintains state information from one invocation to another. An iterative function, such as the lookup
function, contains state information that lasts only until you execute the query in which you use the
function.
Call an iterative function only from within a Query transform. You cannot call an iterative function from
other functions or scripts.
Stateless Does not maintain state information from one invocation to the next.
Use stateless functions, such as to_char or month, anywhere you can use expressions.
6.1.2  Data Services built-in functions
SAP Data Services provides built-in functions to use with specific types of transforms, transactions, and special
processes.
Data Services enables you to create custom functions. It also provides several built-in functions that you can
use throughout Data Services.
The following table lists each built-in function available in Data Services. It includes a description of each
function as well as the function category. Find the function listed under the related category in the function
wizard and smart editor.
Function Category Description
abs Math Returns the absolute value of an input
number.
abs [page 1059]
add_months Date Adds a given number of months to a
date.
add_months [page 1060]
1042 PUBLIC
Reference Guide
Data Services functions and procedures
Function Category Description
ascii String Returns the decimal value of the first
character for the given string using
ASCII character set. If the character
passed is not a valid ASCII character,
the software returns -1.
ascii [page 1061]
avg Aggregate Calculates the average of a given set of
values.
avg [page 1062]
base64_decode Miscellaneous Returns the source data after decoding
the base64-encoded input.
base64_decode [page 1063]
base64_encode Miscellaneous Returns the base64-encoded data in
the engine locale character set.
base64_encode [page 1064]
before_image Miscellaneous Returns the before image value of a
row. This function is available for the
Map_Operation transform only and is
applicable to UPDATE rows.
before_image [page 1064]
begin_delta_load Miscellaneous Marks the beginning of a delta load for
a Replication Server real-time change
data capture (CDC) job.
begin_delta_load [page 1065]
begin_initial_load Miscellaneous Marks the beginning of the initial load
for a Replication Server real-time CDC
job.
begin_initial_load [page 1066]
cast Conversion Returns a value in the cast data type.
cast [page 1067]
ceil Math Returns the smallest integer value
greater than or equal to an input number.
ceil [page 1069]
chr String Gets character representation of provided ASCII value.
chr [page 1070]
concat_date_time Date Returns a datetime from separate date
and time inputs.
concat_date_time [page 1071]
Reference Guide
Data Services functions and procedures PUBLIC 1043
Function Category Description
copy_from_remote_system Miscellaneous Associates with a file location object
that contains file transfer protocol information and local—remote server information.
Transfers a file copy from a remote
server to a local server before reading
and processing the file in a work flow.
You may use wildcard characters (*
or ?) to select a group of files.
copy_from_remote_system [page
1071]
copy_to_remote_system Miscellaneous Associates with a file location object
that contains file transfer protocol information and local—remote server information.
Transfers the generated output file,
which is output to the local server, to
a remote server. You may use wildcard
characters (* or ?) to select a group of
files.
copy_to_remote_system [page 1073]
count Aggregate Counts the number of values in a table
column.
count [page 1076]
count_distinct Aggregate Counts the number of distinct non-null
values in a table column.
count_distinct [page 1077]
current_configuration Miscellaneous Returns the name of the datastore configuration in use at runtime.
current_configuration [page 1079]
current_system_configuration Miscellaneous Returns the name of the system configuration in use at runtime. If no system
configuration is defined, returns a NULL
value.
current_system_configuration [page
1079]
dataflow_name Miscellaneous Returns the data flow name in which
this call exists. If the call is not in a data
flow, returns NULL.
dataflow_name [page 1080]
1044 PUBLIC
Reference Guide
Data Services functions and procedures
Function Category Description
datastore_field_value Miscellaneous Retrieves the value of a specified datastore field.
datastore_field_value [page 1080]
date_diff Date Returns the difference between two
dates or times.
date_diff [page 1081]
date_part Date Extracts a component of a given date.
date_part [page 1083]
day_in_month Date Determines the day in the month on
which the given date falls.
day_in_month [page 1084]
day_in_week Date Determines the day in the week on
which the given date falls.
day_in_week [page 1085]
day_in_year Date Determines the day in the year on
which the given date falls.
day_in_year [page 1086]
db_type Miscellaneous Returns the database type of the datastore configuration in use at runtime.
db_type [page 1086]
db_version Miscellaneous Returns the database version of the datastore configuration in use at runtime.
db_version [page 1088]
db_database_name Miscellaneous Returns the database name of the datastore configuration in use at runtime.
db_database_name [page 1089]
db_owner Miscellaneous Returns the real owner name for the datastore configuration that is in use at
runtime.
db_owner [page 1090]
decode Miscellaneous Returns an expression based on the
first condition in the specified list that
evaluates to TRUE.
decode [page 1091]
decrypt_aes Cryptographic Decrypts the input string using the
user-specified passphrase and key
length using the AES algorithm.
decrypt_aes [page 1093]
Reference Guide
Data Services functions and procedures PUBLIC 1045
Function Category Description
decrypt_aes_ext Cryptographic Decrypts cipher text using the AES
key generated using the specified passphrase and salt. Ensure that the passphrase and salt are the same as the
passphrase and salt you used to encrypt the data.
decrypt_aes_ext [page 1094]
double_metaphone String Encodes the input string using the Double Metaphone algorithm and returns a
string.
double_metaphone [page 1095]
encrypt_aes Cryptographic Encrypts the input string using the
user-specified passphrase and key
length using the AES algorithm.
encrypt_aes [page 1097]
encrypt_aes_ext Cryptographic Encrypts plain text and encodes it in
base64 using the AES key generated
by using the specified passphrase, salt,
and key length. Given the same input,
the encrypted output should be the
same.
The caller of this function must ensure
that the space to hold encrypted text is
at least 1.33 times larger than the original plain text.
encrypt_aes_ext [page 1098]
error_context Miscellaneous (Can only be found when
creating a script)
Returns the context of the caught
exception. For example, "|Session datapreview_job|data flow debug_ DataFlow|Transform Debug"
error_context [page 1099]
error_message Miscellaneous (Can only be found when
creating a script)
Returns the error message of the
caught exception.
error_message [page 1100]
error_number Miscellaneous (Can only be found when
creating a script)
Returns the error number of the caught
exception.
error_number [page 1100]
error_timestamp Miscellaneous (Can only be found when
creating a script)
Returns the timestamp of the caught
exception.
error_timestamp [page 1101]
1046 PUBLIC
Reference Guide
Data Services functions and procedures
Function Category Description
exec System Sends a command to the operating system for execution.
exec [page 1101]
extract_from_json Conversion Extracts JSON data directly from a single column in a database table, and
converts it into its internal nested relational data model (NRDM).
To access this function, open the function wizard from within a new function
call.
extract_from_json [page 1106]
extract_from_xml Conversion Extracts XML directly from single column in a database table, and converts
it into its internal nested relational data
model (NRDM).
To access this function, open the function wizard from within a new function
call.
extract_from_xml [page 1107]
file_copy Miscellaneous Copies an existing file to a different location using the same file name or a different file name. Copies a group of files
indicated by a wildcard to a different existing directory. Overwrites any existing
target files when overwrite flag is set
to 1. The original file still exists in the
original location after file_copy.
file_copy [page 1108]
file_delete Miscellaneous Deletes an existing file, or deletes a
group of files indicated by a wildcard.
file_delete [page 1110]
file_exists Miscellaneous Checks to see if a given file or directory
exists.
file_exists [page 1111]
Reference Guide
Data Services functions and procedures PUBLIC 1047
Function Category Description
file_move Miscellaneous Moves an existing file to a different location using the same file name or a different file name. Moves a group of files
indicated by a wildcard to a different existing directory. Overwrites any existing
target files when overwrite flag is set
to 1. Original file does not exist in the
original location after file_move.
file_move [page 1112]
fiscal_day Date Converts a given date into an integer
value representing a day in a fiscal year.
fiscal_day [page 1114]
floor Math Returns the largest integer value less
than or equal to an input number.
floor [page 1115]
gbq2file Conversion Optimizes performance when you export large-volume data from Google
BigQuery to a local file via Google Cloud
Storage.
gbq2file [page 1116]
gen_row_num_by_group Miscellaneous Returns group row number of the
record. gen_row_num_by_group [page
1118]
gen_row_num Miscellaneous Returns an integer value beginning with
1 then incremented sequentially by 1 for
each additional call. This function can
be used to generate a column of row
IDs.
gen_row_num [page 1119]
gen_uuid Miscellaneous Returns a unique varchar string identifier.
gen_uuid [page 1120]
get_domain_description Miscellaneous Returns the description of a value when
given the domain name and the value.
get_domain_description [page 1121]
get_env Environment Returns a value for the specified environmental variable.
get_env [page 1122]
1048 PUBLIC
Reference Guide
Data Services functions and procedures
Function Category Description
get_error_filename Environment Returns the full path and file name for
the error log.
get_error_filename [page 1122]
get_file_attribute Miscellaneous Returns date created, date modified, or
size (in bytes) of a physical file.
get_file_attribute [page 1123]
get_monitor_filename Environment Returns the full path and file name for
the monitor log.
get_monitor_filename [page 1124]
get_trace_filename Environment Returns the full path and file name for
the trace log.
get_trace_filename [page 1125]
greatest Miscellaneous Returns greatest of the list of one or
more expressions.
greatest [page 1126]
host_name Miscellaneous Returns the name of the computer on
which the job is executing.
host_name [page 1128]
ifthenelse Miscellaneous Allows conditional logic in mapping and
selection operations.
ifthenelse [page 1128]
index String Returns the index of a given word in a
string.
index [page 1129]
init_cap String Changes the characters in a string to
title case.
init_cap [page 1131]
interval_to_char Conversion Returns a string representation of the
interval.
interval_to_char [page 1132]
is_group_changed Miscellaneous Returns 1 if the group is changed, 0 otherwise.
is_group_changed [page 1133]
is_set_env Environment Verifies if the specified environment
variable is set.
is_set_env [page 1134]
Reference Guide
Data Services functions and procedures PUBLIC 1049
Function Category Description
is_valid_date Validation Indicates if an expression can be converted into a valid date value.
is_valid_date [page 1135]
is_valid_datetime Validation Indicates if an expression can be converted into a valid datetime value.
is_valid_datetime [page 1137]
is_valid_decimal Validation Indicates if an expression can be converted into a valid decimal value.
is_valid_decimal [page 1138]
is_valid_double Validation Indicates if an expression can be converted into a valid double value.
is_valid_double [page 1139]
is_valid_int Validation Indicates if an expression can be converted into a valid integer value.
is_valid_int [page 1140]
is_valid_real Validation Indicates if an expression can be converted into a valid real value.
is_valid_real [page 1141]
is_valid_time Validation Indicates if an expression can be converted into a valid time value.
is_valid_time [page 1142]
isempty Miscellaneous Indicates if a nested table contains
data.
isempty [page 1143]
isweekend Date Indicates that a date corresponds to
Saturday or Sunday.
isweekend [page 1144]
job_name Miscellaneous Returns the name of the job in which
the call to this function exists.
job_name [page 1147]
job_run_id Miscellaneous Retrieves the job run ID for the current
job execution.
Job_Run_ID [page 1148]
julian Date Converts a date to its integer Julian
value, the number of days between the
start of the Julian calendar and the
date.
julian [page 1148]
1050 PUBLIC
Function Category Description
julian_to_date Conversion Converts a Julian value to a date.
julian_to_date [page 1149]
key_generation Database Generates keys for the specified table,
after determining the appropriate starting value.
key_generation [page 1150]
last_date Date Returns the last date of the month for a
given date.
last_date [page 1151]
least Miscellaneous Returns the least in a list of one or more
expressions.
least [page 1152]
length String Returns the number of characters in a
given string.
length [page 1154]
literal String Returns an input constant expression
without interpolation. Allows you to assign a pattern to a variable without interpolation.
literal [page 1155]
ln Math Returns the natural logarithm of the
given numeric expression.
ln [page 1156]
load_from_azure_cloudstorage_to_synapse
Miscellaneous Loads data from files in your Azure
Cloud Storage to your Azure Synapse
Analytics workspace.
load_from_azure_cloudstorage_to_synapse [page 1157]
load_from_azure_datalakestore_to_synapse
Miscellaneous Loads data from files in your Azure Data
Lake Storage to your Azure Synapse
Analytics workspace.
load_from_azure_datalakestore_to_synapse [page 1158]
load_from_gcs_to_gbq Conversion Loads data from Google Cloud Storage
into Google BiqQuery tables.
load_from_gcs_to_gbq [page 1160]
Reference Guide
Data Services functions and procedures PUBLIC 1051
Function Category Description
load_from_fl_to_snowflake Miscellaneous Loads data from files in Azure Cloud
Storage or Amazon S3 storage to a
specified table in your Snowflake cloud
storage.
load_from_fl_to_snowflake [page 1162]
load_from_s3_to_redshift Conversion Uses the Redshift COPY command to
copy data files from an Amazon Simple
Storage Service (S3) bucket to a Redshift table.
load_from_s3_to_redshift [page 1165]
load_to_xml Conversion Generates XML text from NRDM and
loads it into a single database column.
(Assumes that the database supports
XML text in its columns.)
load_to_xml [page 1168]
local_to_utc Date Converts the input datetime of any time
zone to Coordinated Universal Time
(UTC).
local_to_utc [page 1170]
log Math Returns the base-10 logarithm of the
given numeric expression.
log [page 1171]
long_to_varchar Conversion Converts a data type from long to varchar.
long_to_varchar [page 1172]
lookup Lookup Finds a value in one table or file based
on values in a second table or file.
lookup [page 1173]
lookup_ext Lookup Finds data from a database table, flat
file, or memory datastore table.
lookup_ext [page 1177]
lookup_seq Lookup Finds a value in one table based on
values in a second table or file, and ensures that the sequence matches.
lookup_seq [page 1187]
lower String Changes the characters in a string to
lowercase.
lower [page 1191]
1052 PUBLIC
Reference Guide
Data Services functions and procedures
Function Category Description
lpad String Pads a string with characters from a
specified pattern.
lpad [page 1192]
lpad_ext String Pads a string with logical characters
from a specified pattern.
lpad_ext [page 1193]
ltrim String Removes specified characters from the
start of a string.
ltrim [page 1194]
ltrim_blanks String Removes blank characters from the
start of a string.
ltrim_blanks [page 1196]
ltrim_blanks_ext String Removes blank and control characters
from the start of a string.
ltrim_blanks_ext [page 1196]
mail_to System Sends the specified e-mail message.
mail_to [page 1197]
match_pattern String Matches whole input strings to simple
patterns supported by Data Services.
This function does not match substrings.
match_pattern [page 1199]
match_regex String Matches whole input strings to the pattern that you specify with regular expressions (regular expressions based
on the POSIX standard) and flags. This
function does not match substrings.
match_regex [page 1202]
match_simple String Matches a whole input string to simple patterns supported by the software
for this function. Does not match substrings.
match_simple [page 1208]
max Aggregate Returns the maximum value from a list.
max [page 1210]
min Aggregate Returns the minimum value from a list.
min [page 1211]
Reference Guide
Data Services functions and procedures PUBLIC 1053
Function Category Description
mod Math Returns the remainder when one number is divided by another.
mod [page 1212]
month Date Determines the month in which the
given date falls.
month [page 1213]
num_to_interval Conversion Converts a numeric value to an interval.
num_to_interval [page 1213]
nvl Miscellaneous Replaces NULL values.
nvl [page 1215]
power Math Returns the value of the give expression
to the specified power.
power [page 1216]
previous_row_value Miscellaneous Returns the column value of previous
row.
previous_row_value [page 1216]
print String Prints the given string to the trace log.
print [page 1218]
pushdown_sql Miscellaneous Allows you to create dynamic WHERE
clauses.
pushdown_sql [page 1219]
quarter Date Determines the quarter in which the
given date falls.
quarter [page 1220]
raise_exception Miscellaneous Causes the software to generate an exception.
raise_exception [page 1221]
raise_exception_ext Miscellaneous Same as raise_exception, but takes a
second parameter for an exit code.
raise_exception_ext [page 1222]
rand Math Returns a random number between 0
and 1.
rand [page 1223]
rand_ext Math Returns a random number between 0
and 1.
rand_ext [page 1224]
1054 PUBLIC
Reference Guide
Data Services functions and procedures
Function Category Description
regex_replace String Matches the whole input string to the
pattern that is specified with regular expressions. The regular expressions are
based on the POSIX standard. Then
flags and replaces the matching part of
the input string with the replacement
string provided.
regex_replace [page 1225]
replace_substr String Returns a string where every occurrence of a given search string in the input is substituted by the given replacement string.
replace_substr [page 1226]
replace_substr_ext String Takes an input string, replaces specified
occurrences of a specified sub-string
with a specified replacement, and returns the result. You can also use this
function to search for hexadecimal or
reference characters.
replace_substr_ext [page 1227]
repository_name Miscellaneous Returns a database connection string
and owner name. The connection string
and owner name are the ID for the repository from which the job is run. For
example: beq-local.DBUser.
repository_name [page 1229]
restore_repserver_cdb_backlogged_transactions
Miscellaneous Restores backlogged transactions
saved in the Replication Server realtime CDC datastore.
restore_repserver_cdb_backlogged_transactions [page 1230]
round Math Rounds a given number to the specified
precision.
round [page 1231]
rpad String Pads a string with characters from a
given pattern.
rpad [page 1232]
rpad_ext String Pads a string with logical characters
from a given pattern.
rpad_ext [page 1233]
Reference Guide
Data Services functions and procedures PUBLIC 1055
Function Category Description
rtrim String Removes given characters from the end
of a string.
rtrim [page 1234]
rtrim_blanks String Removes blank characters from the end
of a string.
rtrim_blanks [page 1235]
rtrim_blanks_ext String Removes blank and control characters
from the end of a string.
rtrim_blanks_ext [page 1236]
sap_openhub_processchain_execute SAP Starts the process chain that extracts
data from an SAP NetWeaver Business
Warehouse (BW) and loads the extracted data into an Open Hub Destination table.
sap_openhub_processchain_execute
[page 1237]
sap_openhub_set_read_status SAP Sends the read status for the Open Hub
table to SAP NetWeaver BW.
sap_openhub_set_read_status [page
1240]
search_replace String Searches input parameters and replaces by matching criteria and values
specified by search table.
search_replace [page 1242]
set_cdc_checkpoint Miscellaneous Sets a check-point for a Microsoft SQL
Server changed-data-capture (CDC
method) job for data flows that run in
a WHILE loop.
set_cdc_checkpoint [page 1245]
set_env Environment Sets an environmental variable temporarily to a specified value.
set_env [page 1246]
sleep Miscellaneous Suspends the execution of the data flow
or work flow from where it is called.
sleep [page 1247]
soundex String Encodes the input string using the
Soundex algorithm and returns a string.
Use when you want to push down the
function to the database-level.
soundex [page 1248]
1056 PUBLIC
Reference Guide
Data Services functions and procedures
Function Category Description
sql Database Runs a SQL operation in the specified
database.
sql [page 1249]
sqrt Math Returns the square root of the given expression.
sqrt [page 1251]
smtp_to System Sends the specified e-mail message using the SMTP protocol.
smtp_to [page 1251]
string_to_number String Returns the integer sum of all characters from the input string.
string_to_number [page 1253]
substr String Returns a specific portion of a string
starting at a given point in the string.
substr [page 1254]
sum Aggregate Calculates the sum of a given set of values.
sum [page 1255]
sysdate Date Returns the current date as listed by
the Job Server operating system.
sysdate [page 1256]
system_user_name Miscellaneous Returns the user name used to log into
the Job Server operating system.
system_user_name [page 1257]
systime Time Returns the current time as listed by
the operating system.
systime [page 1258]
table_attribute Miscellaneous Retrieves the value of a specified table
attribute.
table_attribute [page 1260]
to_char Conversion Converts a date or numeric type to a
string.
to_char [page 1261]
to_date Conversion Converts a string to a date.
to_date [page 1264]
to_decimal Conversion Converts a varchar to a decimal.
to_decimal [page 1265]
Reference Guide
Data Services functions and procedures PUBLIC 1057
Function Category Description
to_decimal_ext Conversion Converts a varchar to a decimal, including precision as a parameter.
to_decimal_ext [page 1266]
to_varchar Conversion Converts a date or numeric expression
to varchar based on a given format.
to_varchar [page 1267]
to_WKT_point Conversion Converts latitude and longitude to a geometry point in Well Known Text (WKT)
format.
to_WKT_point [page 1272]
total_rows Database Returns the number of rows in a particular table in a datastore.
total_rows [page 1274]
translate String Takes the input string and translates
each character to its corresponding
mapping to return the output string.
translate [page 1275]
trunc Math Truncates a given number to the specified precision.
trunc [page 1276]
truncate_table Miscellaneous Allows you to explicitly expunge data
from a memory table.
truncate_table [page 1277]
upper String Changes the characters in a string to
uppercase.
upper [page 1278]
utc_to_local Date Converts the input in Coordinated Universal Time (UTC) to the desired timezone value.
utc_to_local [page 1279]
varchar_to_long Conversion Converts a data type from varchar to
long.
varchar_to_long [page 1280]
wait_for_file Miscellaneous Returns the existing files that match the
input file pattern.
wait_for_file [page 1281]
week_in_month Date Determines the week in the month in
which the given date falls.
week_in_month [page 1282]
1058 PUBLIC
Reference Guide
Data Services functions and procedures
Function Category Description
week_in_year Date Determines the week in the year in
which the given date falls.
week_in_year [page 1283]
WL_GetKeyValue String Returns the value of a given keyword in
Web log search strings.
WL_GetKeyValue [page 1285]
word String Returns one word out of a string.
word [page 1285]
word_ext String Returns the word identified by its position in a delimited string.
word_ext [page 1286]
workflow_name Miscellaneous Returns the work flow in which this call
exists. Returns the name of the inner
most work flow in cases where several
work flows enclose this function call. If
no work flow is found, returns job name.
workflow_name [page 1288]
year Date Determines the year in which the given
date falls.
year [page 1288]
6.1.3  Descriptions of Data Services built-in functions
Each built-in function has specific syntax and uses specific SAP Data Services objects to achieve the stated
objective.
For details about the specific syntax and related objectes for each function, see the individual function topics.
 Note
For information about operators, functions, and transforms that you can use as push-down functions with
Data Services, see SAP Note 2212730 .
6.1.3.1 abs
Use the abs function to return the absolute value of a number. The absolute value (sometimes known as the
modulus) of a number is the value of a number without regard to its sign – it can also be thought of as the
distance of a number from zero.
Reference Guide
Data Services functions and procedures PUBLIC 1059
 Syntax
abs(<num>)
Return value
decimal, double, int, or real
The absolute value of the given number, <num>. The type of the return value is the same as the type of the
original number.
Where
<num> The source number.
 Example
Function Results
abs(12.12345) 12.12345
abs(-12.12345) 12.12345
6.1.3.2 add_months
Use add_months to add a given number of months to a date.
 Syntax
add_months(<original_date>,<months_to_add>)
Return value
date
1060 PUBLIC
Reference Guide
Data Services functions and procedures
Where
<original_date> Specify the starting year.month.date.
<months_to_add> Number of months to add to the original date.
Details
The <months_to_add> can be any integer. If <original_date> is the last day of the month or if the resulting
month has fewer days than the day component of <original_date>, then the result is the last day of the
resulting month. Otherwise, the result has the same day component as <original_date>.
 Example
Function Results
add_months('1990.12.17', 1) '1991.01.17'
add_months('2001.10.31', 4) '2002.2.28'
6.1.3.3 ascii
Use the ascii function to return a decimal value of an ASCII code of the first character in the input string.
 Syntax
 Syntax
ascii(<input_string>)
Return Value
Int
Reference Guide
Data Services functions and procedures PUBLIC 1061
Where
<input_string> The source string.
Details
Returns the decimal value of the ASCII code of the first character in the input string. Returns -1 if the first
character is not a valid ASCII character.
 Example
Function Results
ascii('AaC') 65
6.1.3.4 avg
Use the avg function to calculate the average of a given set of values.
 Syntax
avg(<value_list>)
Return value
decimal, double, int, or real
The calculated average of <value_list> . The function calculates the average to the same precision as the
input value.
Where
<value_list> The source values for which to calculate an average, such as values in a table column.
1062 PUBLIC
Reference Guide
Data Services functions and procedures
 Example
To calculate the average of values in the SALARY column of a table, use the avg function in a query:
• In the Mapping tab of the query editor, enter:
avg(SALARY)
• In the Group By tab in the query editor, specify the columns for which you want to group the salary,
such as the department column. For each unique set of values in the group by list, such as each unique
department, Data Services calculates the average salary.
6.1.3.5 base64_decode
Use the base64_decode function to return the source data after decoding the base64-encoded input.
 Syntax
base64_decode(<base64-encoded input>, 'UTF-8')
Return Value
varchar or blob
If the base64-encoded input is NULL, or the size of the data is 0, Data Services returns NULL. Otherwise, it
returns the base64-decoded data that conforms to RFC 2045.
Where
<base64-encoded input > The base64-encoded input data. Supports varchar and blob data types.
UTF-8 The code page of the output data.
 Note
UTF-8 is required for Data Integrator version 11.7.3.
This parameter is not required when the input data type is blob.
Related Information
base64_encode [page 1064]
Reference Guide
Data Services functions and procedures PUBLIC 1063
6.1.3.6 base64_encode
Use the base64_encode function to return the base64-encoded data in the engine locale character set.
 Syntax
base64_encode(<input data>, 'UTF-8')
Return Value
varchar or blob
Returns base64-encoded data. If the input data is NULL or the size is 0, Data Services returns NULL.
Otherwise, it returns the base64-encoded data that conforms to RFC 2045.
Where
<input data> The input data that needs to be encoded to base64. Supports varchar and blob data types.
UTF-8 The code page of the input data.
 Note
UTF-8 is required for Data Integrator version 11.7.3.
This parameter is not required when the input data type is blob.
Related Information
base64_decode [page 1063]
6.1.3.7 before_image
Use the before_image function to retrieve the before image value of a row.
This function is available only for the Map_Operation transform and is applicable to UPDATE rows.
1064 PUBLIC
Reference Guide
Data Services functions and procedures
 Note
You cannot use quoted strings in the parameter value for before_image. Because of this
limitation, you cannot use a global variable. For example, before_image(T1.Col1) is valid, but
before_image('T1.Col1') is not.
 Syntax
 before_image(<column_name>)
Return value
Inline
The return value is the same data type as the input column data type. For example, if the input column
(column_name) is an integer, the software returns an integer.
Where
<column_name> The name of the table column.
Example
 before_image(Epml.SALARY)
Related Information
Map_Operation [page 929]
6.1.3.8 begin_delta_load
Use the begin_delta_load function to mark the beginning of a delta load for a real-time Replication Server
change data capture (CDC) job.
 Syntax
begin_delta_load()
Reference Guide
Data Services functions and procedures PUBLIC 1065
Details
Use this optional function to configure CDC for databases that use the Replication Server. The function
provides the source table CDC configuration in the Replication Server for the entire job. This function also
prepares the Replication Server for making changed data available for the CDC reader to process. It also
processes restore requests at the beginning of each iteration of the continuous work flow.
If the software does not call this function explicitly in a script in a continuous work flow (CWF), then it calls
the function implicitly at the beginning of each iteration of the CWF. Because the software requires that the
job calls all Replication Server CDC data flows inside one continuous work flow, begin_delta_load executes
implicitly when the continuous work flow starts. But if you have other steps to perform before processing your
CDC data flows, you can explicitly mark the beginning of a delta load inside the CWF.
The guidelines for the begin_delta_load function are as follows:
• If the job does not call the function begin_initial_load, then begin_delta_load validates the Replication
Server configuration (create CDC queue, and replication definition, and subscription).
• If the job calls begin_initial_load, then the begin_delta_load function does the necessary configuration to
transition from initial load to delta load.
• Ensure that the begin_delta_load function is executed inside a continuous work flow.
For each iteration of the continuous work flow, the begin_delta_load function does the following:
• Begins the transaction
• Communicates with child data flow CDC readers whether there is CDC data available to process
• After all the readers have successfully processed CDC data, commits the transaction
• Repeats these steps in next iteration. Committing the transaction moves the pointer in the CDC queue
in Replication Server to the next set of changed data.
6.1.3.9 begin_initial_load
Use the begin_initial_load function to mark the beginning of an initial load for a real-time Replication Server
change data capture (CDC) job.
 Syntax
begin_initial_load()
Details
If the work flow calls begin_initial_load, it must call it before the begin_delta_load function. When
begin_initial_load executes, it provides the source table CDC configuration for the Replication Server real-time
CDC data stores for the entire job. This function also prepares the Replication Server for capturing CDC
transactions from the source system while the initial load is in progress.
When begin_delta_load executes in the CDC continuous work flow, it notifies the Replication Server to mark
the endpoint of CDC transactions that were captured by the Replication Server during initial load. If you
1066 PUBLIC
Reference Guide
Data Services functions and procedures
select Enable Auto Correct in the CDC reader, the reader generates automatically corrected records for all the
transactions that occurred during the initial load.
6.1.3.10  cast
Use the cast function to explicitly convert an expression of one data type to another.
 Syntax
Cast('<expression>','<data_type>')
Return Value
Returns the same value as in data_type.
Where
<expression> Input expression to be cast to target data type.
<data_type> Target data type that is a built-in data type and specified as a
constant string. For example, 'decimal(28,7)'.
Details
The cast function explicitly converts the value of the first parameter into the built-in data type that you specify
in the second parameter. The following table shows all explicit data type conversions that are valid for this
function.
Cast type compatibility matrix
From / To Date
Date
time Decimal Double Int Interval Real Time
Time
stamp Varchar
Date X X X X
Date
time
X X X X X
Reference Guide
Data Services functions and procedures PUBLIC 1067
Cast type compatibility matrix
From / To Date
Date
time Decimal Double Int Interval Real Time
Time
stamp Varchar
Decimal X X X X X X
Double X X X X X X
Int X X X X X X
Interval X X X X X X
Real X X X X X X
Time X X X X
Time
stamp
X X X X X
Varchar X X X X X X X X X X
The following table contains syntax for the given data_type.
Target data type syntax
Data type Syntax
varchar 'varchar(length)'
decimal 'decimal(precision,scale)'
integer 'int'
real 'real'
double 'double'
timestamp 'timestamp'
datetime 'datetime'
date 'date'
time 'time'
interval 'interval'
The following table shows the date&time format for the cast() function:
Timestamp yyyy.mm.dd hh24:mi:ss.ff
1068 PUBLIC
Reference Guide
Data Services functions and procedures
Datetime yyyy.mm.dd hh24:mi:ss
Date yyyy.mm.dd
Time hh24:mi:ss
 Example
Input Output
cast('20.3','decimal(3,1)') 20.3
6.1.3.11  ceil
Use the ceil function to return the smallest integer value greater than or equal to a number.
 Syntax
ceil(<num>)
Return value
decimal, double, int, or real
The indicated integer, cast as the same type as the original number, <num>.
Where
<num> The source number.
 Example
Function Results
ceil(12.12345) 13.00000
Reference Guide
Data Services functions and procedures PUBLIC 1069
Function Results
ceil(12) 12
ceil(-12.223) -12.000
6.1.3.12  chr
Use the chr function to convert a decimal ASCII code to a character.
 Syntax
chr (<integer_expression>)
Return Value
ASCII character
Where
<integer_expression> Integer from 0 through 255. Returns NULL if the integer expression is not in this
range.
Details
This function returns the character associated with the specified ASCII code decimal number. If you specify a
value of less than 0 or greater than 255 for the integer_expression parameter, the software returns NULL. Use
chr to insert control characters into character strings. For example, chr(9) can be used to insert <tab>.
 Example
Function Results
chr(65)
'A'
1070 PUBLIC
Reference Guide
Data Services functions and procedures
6.1.3.13  concat_date_time
Use the concat_date_time function to return a datetime from separate date and time inputs.
 Syntax
concat_date_time(<date>,<time>)
Where
<date> Date input value.
<time> Time input value.
Return value
datetime
The datetime value obtained by combining the inputs.
 Example
concat_date_time(MS40."date",MS40."time")
6.1.3.14  copy_from_remote_system
Use the copy_from_remote_system function to copy files from a remote server to your local server.
 Syntax
copy_from_remote_system(“<file_location_object name>”, “<remote_file_name>”, 
“<remote_sub_directory>”)
Return value
Int
Returns 1 if function is successful. Returns 0 if function is not successful.
Reference Guide
Data Services functions and procedures PUBLIC 1071
Where
<file_location_object
name>
Name of file location object.
<remote_file_name> Name of the file to copy from the remote server.
<remote_sub_directory> Optional. Subdirectory path to the remote location for the file specified in the <file_name>
parameter. Complete this parameter when the file is located farther in the hierarchy than
what is specified in the file location object.
Data Services concatenates this information with the location specified in the file location
object to form a complete directory path.
 Example
You want to download the file named nw_sales_q2 from the Sub_directory1
folder in the following directory structure in your Amazon S3 cloud storage:
The file location named “AmazonS3_bucket” for an Amazon S3 cloud storage has
the Remote directory option set to <bucket>/<Parent folder>/<Child
folder2>. However, the file is located in the Sub_directory1 folder. Therefore,
you use the function to add the additional subdirectory:
copy_from_remote_system('AmazonS3_bucket','nw_sales_q2','Su
b_directory1')
The parameter is applicable to the following cloud storage types:
• Amazon S3
• Azure blob storage
• Azure Data Lake Store
• Hadoop File System
• Google Cloud storage
Details
Use this function in a workflow script to transfer a file from a remote server to a local server. Then use the file
as a source in a data flow. Also set the workflow script to copy groups of files from a remote server to your local
1072 PUBLIC
Reference Guide
Data Services functions and procedures
server. Indicate groups of files with a wildcard in the file name using either an asterisk (*) or question mark (?)
character.
The software uses the local directory, remote directory, remote path prefix, and transfer protocol information
(FTP, SFTP, or SCP) from the named file location object. Then it concatenates the file location information with
the information in the copy_from_remote_system function.
More details
• Use this function on regular files only. For example, you cannot use this function to copy directory or
symbolic links.
• Directory information is included in the file location object in such a way that this function does not copy
any directories.
• This function does not recursively copy files under any subdirectories.
 Example
You want to copy a file named prod.txt from a remote server to a local server to use it in a data flow.
Data flow includes a query transform. A file location object named flo_ftp_1 contains the file transfer
protocol. You set up a script object that contains the copy_from_remote_system function as follows:
 Sample Code
copy_from_remote_system(“flo_ftp_1”, “prod.txt”);
The function uses the FTP information in the file location object flo_ftp_1 to copy the file named
prod.txt that is located in a remote directory.
Related Information
Use built-in functions for file transfer protocol
6.1.3.15  copy_to_remote_system
Use the copy_to_remote_system function to copy generated files from your local server to a remote server
after SAP Data Services processing.
 Syntax
copy_to_remote_system(“<file_location_object name>”, “<local_file_name>”, 
“<remote_sub_directory>”)
Reference Guide
Data Services functions and procedures PUBLIC 1073
Return value
int
Returns 1 if function is successful. Returns 0 if function is not successful.
Where
<file_location_object
name>
Name of file location object.
<local_file_name> Name of the file to read from the local directory.
Data Services concatenates with the local directory information specified in the file location
object to form the full file name.
 Example
Local directory is C:\local<
local_file_name> is file.j
Concatenated location and file name is C:\local\file.j
Use wildcards in the file name to designate a group of files. Use either * or ? characters. For
example, C:\local\*.j.
1074 PUBLIC
Reference Guide
Data Services functions and procedures
<remote_sub_directory> Optional. Subdirectory path to the remote location in the cloud for the file specified in
the <file_name> parameter. Complete this parameter when the location in the remote
directory is located farther in the hierarchy than what is specified in the file location object.
Data Services concatenates this information with the location specified in the file location
object to form a complete directory path.
 Example
You want to place the file generated from Data Services named nw_sales_q2 from
your local server to the Sub_directory1 folder in the following directory structure in
your Amazon S3 cloud storage:
The file location named “AmazonS3_bucket” for an Amazon S3 cloud storage has
the Remote directory option set to <bucket>/<Parent folder>/<Child
folder2>. However, the file named nw_sales_q2 should be uploaded to the
Sub_directory1 folder. Therefore, you use the function to add the additional subdirectory:
copy_to_remote_system('AmazonS3_bucket','nw_sales_q2','Sub_
directory1')
The parameter is applicable to the following cloud storage types:
• Amazon S3
• Azure blob storage
• Azure Data Lake Store
• Hadoop File System
• Google Cloud storage
Details
Use the copy_to_remote_system function in a workflow script to transfer the generated output file, which
is output to the local server, to a remote server. The software uses the attributes, such as local directory,
remote directory, remote path prefix, and transfer protocol information (FTP, SFTP, or SCP) from the named
file location object.
Reference Guide
Data Services functions and procedures PUBLIC 1075
• Use this function on regular files only. For example, you cannot use this function to copy directory or
symbolic links.
• Directory information is included in the file location object in such a way that this function does not copy
any directories.
• This function does not recursively copy files under any subdirectories unless the subdirectory is included in
the remote directory value.
 Example
You want to move a file after Data Services processing from a local server to a remote server using file
transfer protocol.
The file name is prod_out.txt. You set the file transfer protocol in a file location object named
flo_ftp_1. To copy the file to the remote system, you create a script as follows:
 Sample Code
copy_to_remote_system(“flo_ftp_1”, “prod_out.txt”);
The script uses the FTP information in the file location object flo_ftp_1 to copy the file named
prod_out.txt that is located in the local directory.
Related Information
Use built-in functions for file transfer protocol
6.1.3.16  count
Use the count function to count the number of values in a group.
count
 Syntax
count(<column>)
Return value
int
The number of rows in the column that have a non-NULL value.
1076 PUBLIC
Reference Guide
Data Services functions and procedures
Where
<column> The column in the input table in which to count values.
Example
To determine the number of customers located in a specific sales region, use the count function with a filter
defined in the Where tab of the query editor. The following WHERE clause selects the rows in the REGION
column with the value TX:
REGION = "TX"
With the target column selected, enter the count function in the Mapping tab of the editor:
count(REGION)
Example
6.1.3.17  count_distinct
Use the count_distinct function to return the number of distinct non NULL values in a group.
 Syntax
count_distinct(<expression>) 
Return Value
Integer
Where
<expression> Any valid expression of any type except NRDM or long data type.
Reference Guide
Data Services functions and procedures PUBLIC 1077
Example
In a customer table, the customer region is stored in a column named REGION. To count the number of distinct
regions the customers come from, use the count_distinct function with a filter defined in the Where tab of the
query editor. Enter the count_distinct function in the Mapping tab of the editor, as follows:
count_distinct(REGION)
Input
Name Region Country
Cust 1 East US
Cust 2 East US
Cust 3 West US
Cust 4 East France
Output
count_distinct(REGION) = 2
To calculate the number of distinct regions per country, add the country column to the group by clause, as
follows:
count_distinct(REGION) Country
2 US
1 France
 Note
If you want to provide more resources to execute the count_distinct function, select Run as a separate
process. This option creates a separate sub data flow process for the count_distinct function when
Data Services executes the data flow.
Related Information
Distributed data flow execution
6.1.3.18  current_configuration
Use the current_configuration function to return the name of the datastore configuration that the software
uses at runtime.
If the datastore does not support multiple configurations, for example, the datastore is a memory datastore,
the function returns the name of the datastore instead.
 Syntax
current_configuration(ds_name)
Return Value
varchar
Where
<ds_name> The name you enter when you create the datastore.
Example
Create a job and add a script with, for example, the following line.
print('Datastore Configuration used at runtime: [current_configuration()]')
Returns, for example, the following to the trace log:
Datastore configuration used at runtime: Test_DS
6.1.3.19  current_system_configuration
Use the current_system_configuration function to return the name of the system configuration the software
uses at runtime.
If there is no system configuration defined, the function returns a NULL value.
 Syntax
current_system_configuration()
Reference Guide
Data Services functions and procedures PUBLIC 1079
Return Value
varchar
Example
Create a job and add a script with, for example, the following line:
print('System Configuration used at runtime: [current_system_configuration()]')
This line returns, for example, the following to the trace log:
System configuration used at runtime: Production
6.1.3.20  dataflow_name
Use the dataflow_name function to return the name of the data flow in which this call exists.
If the call is not in a data flow, the function returns NULL.
 Syntax
dataflow_name()
Return Value
varchar
 Example
print('Data Flow Name: [dataflow_name()]')
6.1.3.21  datastore_field_value
Use the datastore_field_value function to retrieve the value of a specified datastore field.
 Syntax
datastore_field_value(<ds_name, field_name>)
1080 PUBLIC
Reference Guide
Data Services functions and procedures
Return Value
varchar
Where
<ds_name> The name you enter when you create the datastore.
<field_name> The name of the field.
Details
The <field_name> should match the name in the language of the datastore. To view the language of the
datastore, open the datastore editor and click Show ATL. The ATL contains the valid field names. If the function
cannot find a specified field or the datastore is invalid, the software returns NULL. If the <field_name> is
'password,' the software returns NULL..
 Example
Function Results
datastore_field_value('mssql', 
'sql_server_database')
'DBUser'
6.1.3.22  date_diff
Use the date_diff function to return the difference between two dates or times.
 Syntax
date_diff(<date1>,<date2>,'<fmt_str>')
Reference Guide
Data Services functions and procedures PUBLIC 1081
Return Value
int
Where
<date1, date2> The dates between which the function determines the difference.
<fmt_str> The string that describes the format of the dates. Choose from the following values:
D Day
H Hours
M Minutes
S Seconds
MM Months
YY Years
Details
If date1 is smaller than date2, the date_diff function returns a positive value. To cause the function to return
only a positive value, surround the function with the abs() function.
 Note
When you use the sysdate function with date_diff, be aware that the value the sysdate function returns is
datetime. Internally Data Services reads both the date and the time when it runs a sysdate function. The
data that is used by the job depends on the data type of a particular column. For example, if the data type of
a column in a query is date, Data Services uses only the date for calculations. It ignores the time data. If you
change the data type to datetime, Data Services uses both a date and a time. If the data type is datetime
and you don’t want to use the time data, use the to_char function to truncate the timestamp from sysdate.
 Example
Function Results
date_diff(start_date,sysdate(),'D')
The number of days between the date in the column start_date and the current date.
date_diff(start_time,systime(),'M')
The number of minutes between the time in the
column start_time and the current time.
1082 PUBLIC
Reference Guide
Data Services functions and procedures
6.1.3.23  date_part
Use the date_part function to extract a component of a given date.
 Syntax
date_part(<in_date>,'<fmt_str>')
Return Value
int
Where
<in_date> The input date.
<fmt_str> The string describing the format of the extracted part of the date. Choose from the following values:
YY Year
MM Month
DD Day
HH Hours
MI Minutes
SS Seconds
Details
This function takes in a datetime and extracts the component requested as an integer.
 Note
The function displays year as four digits, not two.
Reference Guide
Data Services functions and procedures PUBLIC 1083
 Example
Function Results
date_part('1990.12.31', 'YY') 1990
date_part('1991.01.17 23:44:30', 
'SS')
30
6.1.3.24  day_in_month
Use the day_in_month function to determine the day in the month on which the input date falls.
 Syntax
day_in_month(<date1>)
Return value
int
The number from 1 to 31 that represents the day in the month that <date1> occurs.
Where
<date1> The source date.
This function extracts the day component from the date value.
 Example
Function Results
day_in_month(to_date('Jan 22, 1997','mon dd, yyyy')) 22
day_in_month(to_date('02/29/1996','mm/dd/yyyy')) 29
1084 PUBLIC
Reference Guide
Data Services functions and procedures
Function Results
day_in_month(to_date('1996.12.31','yyyy.mm.dd')) 31
6.1.3.25  day_in_week
Use the day_in_week function to determine the day in the week on which the input date falls.
 Syntax
day_in_week(<date1>)
Return value
int
The number from 1 (Monday) to 7 (Sunday) that represents the day in the week that <date1> occurs.
Where
<date1> The source date.
This function allows you to categorize dates according to the day of the week the date falls on. For example, all
dates for which this function returns a "3" occur on Wednesday.
 Example
Function Results
day_in_week(to_date('Jan 22, 1997','mon dd, 
yyyy'))
3 (Wednesday)
day_in_week(to_date('02/29/1996','mm/dd/yyyy'))
4 (Thursday)
day_in_week(to_date('1996.12.31','yyyy.mm.dd'))
2 (Tuesday)
Reference Guide
Data Services functions and procedures PUBLIC 1085
6.1.3.26  day_in_year
Use the day_in_year function to determine the day in the year on which the input date falls.
 Syntax
day_in_year(<date1>)
Return value
int
The number from 1 to 366 that represents the day in the year that <date1> occurs.
Where
<date1> The source date.
 Example
Function Results
day_in_year(to_date('Jan 22, 1997','mon dd, 
yyyy'))
22
day_in_year(to_date('02/29/1996','mm/dd/yyyy')) 60
day_in_year(to_date('1996.12.31','yyyy.mm.dd')) 366
(1996 was a leap year.)
6.1.3.27  db_type
Use the db_type function to return the database type of the datastore configuration in use at runtime.
 Syntax
db_type(<ds_name>)
1086 PUBLIC
Reference Guide
Data Services functions and procedures
Return Value
varchar
Possible db_type() return values for datastore types are as follows:
Datastore Types Possible db_type() Return Value
Adapter Adapter
Database Attunity_Connector, DB2, Informix, Memory, Microsoft_SQL_Server, ODBC, Oracle, SAP,
SAP_BW, SQL_Anywhere, SAP Sybase (for SAP ASE), Sybase_IQ, Teradata
JDE One World DB2, Microsoft_SQL_Server, ODBC, or Oracle
JDE World ODBC
Oracle Applications Oracle
PeopleSoft Microsoft_SQL_Server, or Oracle
SAP Applications SAP
SAP BW Source SAP
SAP BW Target SAP_BW
Siebel DB2, Microsoft_SQL_Server, or Oracle
Where
<ds_name> The datastore name you enter when you create the datastore.
Details
This function is useful if your datastore has multiple configurations. For example, you can use this function in a
SQL statement instead of using a constant. Using the function in a SQL statement allows the SQL statement to
use the correct database type for each run no matter what datastore configuration is in use.
 Example
If you have a SQL transform that performs a function that you have to write differently for database types,
you can tell the system what to do if the database type is Oracle.
In this example, the sql() function is used within a script.
IF (db_type('sales_ds') = 'Oracle')
Reference Guide
Data Services functions and procedures PUBLIC 1087
BEGIN
 IF (db_version('sales_ds') = 'Oracle 9i')
 $sql_text = '…';
 ELSE 
 $sql_text = '…';
END
Sql('sales_ds', '{$sql_text}');
6.1.3.28  db_version
Use the db_version function to return the database version of the datastore configuration in use at runtime.
 Syntax
db_version(<ds_name>)
Return Value
varchar
Possible db_version() return values are:
Database type Version
Oracle Currently supported versions
Microsoft SQL Server Currently supported versions
DB2 UDB Currently supported versions
Informix IDS Currently supported versions
SQL Anywhere Currently supported versions
SAP ASE Currently supported versions
SAP Sybase IQ Currently supported versions
Teradata Currently supported versions
"" An empty string is returned for any other database type
1088 PUBLIC
Reference Guide
Data Services functions and procedures
Where
<ds_name> The datastore name you enter when you create the datastore.
Details
This function is useful if your datastore has multiple configurations. For example, you can use this function in a
SQL statement instead of using a constant. Using the function in a SQL statement allows the SQL statement to
use the correct database version for each run no matter what datastore configuration is in use.
 Example
If you have a SQL transform that performs a function that is written differently for different versions of
Oracle, you can tell the system which text to use for each database version. In this example, the sql()
function is used within a script.
IF (db_type('sales_ds') = 'Oracle')
BEGIN
 IF (db_version('sales_ds') = 'Oracle 9i')
 $sql_text = '…';
 ELSE 
 $sql_text = '…';
END
Sql('sales_ds', '{$sql_text}');
6.1.3.29  db_database_name
Use the db_database_name function to return the database name of the datastore configuration in use at
runtime.
 Syntax
db_database_name(<ds_name>)
Return Value
varchar
Reference Guide
Data Services functions and procedures PUBLIC 1089
Where
<ds_name> The datastore name you enter when you create the datastore.
Details
This function is useful if your datastore has multiple configurations and is accessing an MS SQL Server or SAP
ASE database. For a datastore configuration that is using either of these database types, you enter a database
name, when you create a datastore. This function returns that database name.
For example, master is a database name that exists in every Microsoft SQL Server and SAP ASE database.
However, if you use different database names, you can use this function in, for example, a SQL statement
instead of using a constant. Using the function in a SQL statement allows the SQL statement to use the correct
database name for each run no matter what datastore configuration is in use.
This function returns an empty string for datastore configurations without MS SQL Server or SAP ASE as the
Database Type.
 Example
If you have a SQL transform that performs a function that is written differently for different versions of
database types, you can tell the system which text to use for each database version. In this example, the
sql() function is used within a script.
IF (db_type('sales_ds') = 'DB2')
 $sql_text = '…';
ELSE
BEGIN
 IF (db_type('sales_ds') = 'MicroSoft_SQL_Server')
 $db_name = db_database_name('sales_ds'); 
 $sql_text = '…';
END
Sql('sales_ds', '{$sql_text}');
6.1.3.30  db_owner
Use the db_owner function to return the real owner name for the datastore configuration that is in use at
runtime.
 Syntax
db_owner(<ds_name>, <alias_name>)
1090 PUBLIC
Reference Guide
Data Services functions and procedures
Return Value
varchar
Where
ds_name The datastore name that you entered when you created the
datastore.
alias_name The name of the alias that you created in the datastore,
then mapped to the real owner name when you created a
datastore configuration.
Details
This function is useful if your datastore has multiple configurations because with multiple configurations, you
can use alias owner names instead of database owner names. By using aliases instead of real owner names,
you limit the amount of time it takes to port jobs to different environments.
For example, you can use this function in a SQL statement instead of using a constant. This allows the SQL
statement to use the correct database owner for each run no matter what datastore configuration is in use.
 Example
$real_owner = db_owner('sales_ds', 'sales_person');
6.1.3.31  decode
Use the decode function to return an expression based on the first condition in the specified list of conditions
and expressions that evaluates to TRUE.
 Syntax
decode(<condition_and_expression_list>,<default_expression>)
Return value
<expression> or <default_expression>
Reference Guide
Data Services functions and procedures PUBLIC 1091
Returns the value associated with the first <condition> that evaluates to TRUE. The data type of the return
value is the data type of the first <expression> in the <condition_and_expression_list>.
If the data type of any subsequent <expression> or the <default_expression> is not convertible to the
data type of the first <expression>, Data Services produces an error at validation. If the data types are
convertible but do not match, a warning appears at validation.
Where
<condition_and_expression_li
st>
A comma-separated list of one or more pairs that specify a variable number of conditions. Each pair contains one <condition> and one <expression> separated
by a comma. Specify at least one <condition> and <expression> pair.
The <condition> evaluates to TRUE or FALSE.
If the <condition> evaluates to TRUE, the <expression> is the value that the
function returns.
<default_expression> An expression that the function returns if none of the conditions in <condition_and_expression_list> evaluate to TRUE. A
<default_expression> is required.
Details
The decode function provides an easier way to write nested ifthenelse functions. In nested ifthenelse
functions, you write nested conditions and ensure that the parentheses are in the correct places, as the
following example shows:
 Example
ifthenelse ((EMPNO = 1), '111', 
 ifthenelse((EMPNO = 2), '222',
 ifthenelse((EMPNO = 3), '333',
 ifthenelse((EMPNO = 4), '444', 
 'NO_ID'))))
In the decode function, you list the conditions, as the following example shows. Therefore, decode is less error
prone than nested ifthenelse functions.
 Example
decode ((EMPNO = 1), '111',
(EMPNO = 2), '222',
(EMPNO = 3), '333',
(EMPNO = 4), '444',
'NO_ID')
To improve performance, Data Services pushes this function to the database server when possible. Thus, the
database server, rather than Data Services, evaluates the decode function.
1092 PUBLIC
Reference Guide
Data Services functions and procedures
Use this function to apply multiple conditions when you map columns or select columns in a query. For more
flexible control over conditions in a script, use the IF keyword in the scripting language.
If a condition compares a varchar value with trailing blanks, the decode function ignores the trailing blanks.
To compare a NULL value (NULL constant or variable that contains a NULL constant), use the IS NULL or IS
NOT NULL operator. If you use the Equal (=) or Not equal to (<>) operator, the comparison against a NULL
value always evaluates to FALSE.
 Example
Function Results
decode((COUNTRY = 'FRANCE'), 
'French',
 (COUNTRY = 'GERMANY'), 'German',
 (COUNTRY = 'ITALY'), 'Italian',
 (COUNTRY = 'USA'), 'America',
 (COUNTRY IS NULL), 'Unknown',
 'Others')
If the value in the COUNTRY column is FRANCE, the value
returned is French. If COUNTRY is NULL, the value returned is Unknown. If COUNTRY does not contain any of
the values listed, the decode function returns the value
Others.
6.1.3.32  decrypt_aes
Use the decrypt_aes function to decrypt the input string with the user-specified pass phrase and key length
using the AES algorithm.
 Note
The decrypt_aes function is intended to decrypt data that was encrypted by encrypt_aes function.
 Syntax
decrypt_aes(<encrypted_input_string>,<passphrase>,<key_length_in_bits>)
Return value
Returns plain string as varchar.
In case of a failure, the function throws an exception of type execution error, which results in termination of the
job. You can catch the exception by using try/catch handlers.
If the encrypted input string is empty, then the return value is an empty string.
If the encrypted input string is NULL, then the return value is NULL.
Reference Guide
Data Services functions and procedures PUBLIC 1093
Where
<encryptedinput_string> A varchar input string to be decrypted.
<passphrase> A varchar character string.
<key_length_in_bits> An int value of 128, 192, or 256.
Example
For security purposes, secure the passphrase in a database and read it using a sql() function into a local or
global variable. Then you can pass the variable to the passphrase parameter.
 #read the passphrase
from a secured source such as a database
$G_passphrase = sql('PASSWORD_DATASTORE', 'select PASSPHRASE from PASSWORD');
encrypt_aes(SOURCE.SSN,
$G_passphrase, 128);
Similar to other string functions, this function can be called from a custom function, in the column mapping of
a Query transform, or in a script in the work flow.
Related Information
encrypt_aes [page 1097]
6.1.3.33  decrypt_aes_ext
Use the decrypt_aes_ext function to decrypt the input string with the user-specified passphrase, salt, and key
length using the AES algorithm.
Ensure that the passphrase and salt are the same as the passphrase and salt used to encrypt the data.
The function generates an AES key of the specified key length using the specified passphrase and the key
generation algorithm PKCS5_PBKDF2_SHA256. This key is used for decrypting the encrypted input string.
 Syntax
decrypt_aes_ext(<Varchar Encrypted_input_string>,<Varchar 
Passphrase>,<Varchar Salt>,<Int Key_length_in_bits>)
1094 PUBLIC
Reference Guide
Data Services functions and procedures
Return value
Returns plain string as varchar.
In case of a failure, the function throws an exception of type execution error, which results in the termination of
the job. You can catch the exception by using try/catch handlers.
If the encrypted input string is empty, then the return value is an empty string.
If the encrypted input string is NULL, then the return value is NULL.
If you fail to provide the same passphrase and key length used for encryption to this function, then the call does
not fail but instead returns an incorrect output.
Where
<Encrypted_input_string> A varchar input string to be decrypted.
<Passphrase> A varchar character string with at least one character.
<Salt> A varchar that must be exactly eight ASCII characters.
<Key_length_in_bits> An int value of 128, 192, or 256.
Example
For security purposes, secure the passphrase and salts in a database and read it using a sql() function into a
local or global variable. Then you can pass the variable to the passphrase parameter.
#read the passphrase from a secured source such as a database
$G_passphrase = sql('PASSWORD_DATASTORE', 'select PASSPHRASE from PASSWORD');
$G_salt = sql('PASSWORD_DATASTORE', 'select SALT from PASSWORD');
decrypt_aes_ext(ENCRYPTED.SSN, $G_passphrase, $G_salt, 128);
Similar to other string functions, call this function from a custom function, in the column mapping of a Query
transform, or in a script in the work flow.
6.1.3.34  double_metaphone
Use the double_metaphone function to encode the input string using the Double Metaphone algorithm.
 Syntax
double_metaphone(<input_str, alternate, return_if_empty>)
Reference Guide
Data Services functions and procedures PUBLIC 1095
Return Value
varchar
Returns the string containing the double metaphone encoding of the input string. The length of the return
string depends on the length of the input string, but it is always shorter than the input string.
Where
<input_str> The source string to encode.
<alternate> A flag to control how the function returns the encoded strings.
• When 0, returns the primary encoding. When no primary encoding, returns NULL or the input string based on how you set
<return_if_empty>.
• When input is not 0, returns the alternate encoding. If no alternate
encoding, returns NULL or the input string based on how you set
<return_if_empty>.
• When NULL or invalid, such as non numeric, defaults to 0.
<return_if_empty> A flag to determine whether to return null or the input string when there
is no encoding.
When 0, return NULL. Otherwise, return the input string when there
is no encoding. When the parameter is NULL or invalid, such as non
numeric, defaults to 1.
When input is empty, there is no primary or secondary encodings. When <return_if_empty> = 0, then returns NULL. When
<return_if_empty> = 1, then returns the empty string.
Details
Only use this function for input strings in English. The function ignores non-English characters.
When input is NULL, the function returns NULL.
When the second or third parameter has an invalid value, defaults to 0 and 1, respectively.
 Example
Function Result
Print(double_metaphone('Hello',0,0); Prints the double metaphone of the word “Hello.”
1096 PUBLIC
Reference Guide
Data Services functions and procedures
Function Result
double_metaphone($VAR, 1,1); If the string stored in $VAR does not have encoding
available, then returns the original string.
double_metaphone($VAR,'a','b'); Returns the primary double metaphone encoding or
the variable $VAR when the primary encoding does not
exist.
6.1.3.35  encrypt_aes
Use the encrypt_aes function to encrypt the input string using the specified passphrase and key length with
the AES algorithm.
 Note
Do not decrypt data that you encrypted within Data Services using the encrypt_aes function outside of
Data Services. Instead, use the decrypt_aes function to decrypt this data.
 Syntax
encrypt_aes(<input_string>,<passphrase>,<key_length_in_bits>)
Return value
Returns encrypted string as varchar. The size of the encrypted string is about twice as large as the size of plain
text. Therefore, ensure that you have enough space to hold the encrypted string.
In case of a failure, the function throws an execution error and terminates the job. You can catch the exception
by using try/catch handlers.
If the input string is empty, then the function returns an encrypted string. The encrypted string is different for
multiple calls of the encrypt_aes() function with an empty input string.
If the input string is NULL, then the return value is NULL.
Where
<input_string> A varchar input string to be encrypted.
<passphrase> A varchar character string.
Reference Guide
Data Services functions and procedures PUBLIC 1097
<key_length_in_bits> An int value of 128, 192, or 256.
Details
For security purposes, secure the passphrase in a database and read it using a sql() function into a local or
global variable. Then you can pass the variable to the passphrase parameter.
 Example
 #read the passphrase
from a secured source such as a database
$G_passphrase = sql('PASSWORD_DATASTORE', 'select PASSPHRASE from PASSWORD');
encrypt_aes(SOURCE.SSN,
$G_passphrase, 128);
Like other string functions, you can call the encrypt_aes function from a custom function, in the column
mapping of a Query transform, or in a script in the work flow.
6.1.3.36  encrypt_aes_ext
Use the encrypt_aes_ext function to encrypt an input string using the specified passphrase, salt, and key
length with the AES algorithm.
 Syntax
encrypt_aes_ext(<Varchar Input_string>,<Varchar Passphrase>,<Varchar 
salt>,<Int Key_length_in_bits>)
Return value
Returns encrypted string as base64 encoded string. The size of the encrypted string is 1.3 times larger than the
size of plain text. Therefore you must have enough space to hold the encrypted string.
In case of a failure, the function throws an exception of type execution error, which results in the termination of
the job. You can catch the exception by using try/catch handlers.
If the input string is empty, then the return value is empty.
If the input string is NULL, then the return value is NULL.
1098 PUBLIC
Reference Guide
Data Services functions and procedures
Where
<Input_string> A varchar input string to be encrypted.
<Passphrase> A varchar character string.
<Salt> A varchar that must be exactly eight ASCII characters.
<Key_length_in_bits> An int value of 128, 192, or 256.
Details
The function generates an AES key of specified key length using the specified passphrase, salt, and the key
generation algorithm PKCS5_PBKDF2_SHA256. The function uses this key for encrypting the input string.
For security purposes, secure the passphrase and salts in a database and read it using a sql() function into a
local or global variable. Then you can pass the variable to the passphrase parameter.
 Example
#read the passphrase from a secured source such as a database
$G_passphrase = sql('PASSWORD_DATASTORE', 'select PASSPHRASE from PASSWORD');
$G_salt = sql('PASSWORD_DATASTORE', 'select SALT from PASSWORD');
encrypt_aes_ext(SOURCE.SSN, $G_passphrase, $G_salt, 128);
Like other string functions, you can call the encrypt_aes_ext function from a custom function, from the column
mapping of a Query transform, or from a script in the work flow.
6.1.3.37  error_context
Use the error_context function to return the context of a caught exception.
 Syntax
error_context()
Return value
varchar 512
 Example
The following shows an example of the caught exception.
"|Session datapreview_job|Dataflow debug_DataFlow|Transform Debug"
Reference Guide
Data Services functions and procedures PUBLIC 1099
Related Information
Catch error functions [page 29]
6.1.3.38  error_message
Use the error_message function to return the error message from a caught exception.
 Syntax
error_message()
Return value
varchar 512
Related Information
Catch error functions [page 29]
6.1.3.39  error_number
Use the error_number function to return the error number of a caught exception.
 Syntax
error_number()
Return value
int
1100 PUBLIC
Reference Guide
Data Services functions and procedures
Related Information
Catch error functions [page 29]
6.1.3.40  error_timestamp
Use the error_timestamp function to return the timestamp of a caught exception.
 Syntax
error_timestamp()
Return value
timestamp
Related Information
Catch error functions [page 29]
6.1.3.41  exec
Use the exec function to send a command to the operating system.
 Note
This function presents an elevated risk for command injection. Make sure you carefully check all
parameters to avoid possible vulnerabilities.
If an injection could occur, a warning will be displayed the first time each such function is computed. If you
prefer that that the job is terminated with an error when an injection could occur, add a DSConfig flag
ENABLE_SECURITY_ERROR = TRUE.
Sends a command to the operating system for execution. With this function, you can add a program to a Data
Services job.
 Syntax
exec(<command_file, parameter_list, flag>)
Reference Guide
Data Services functions and procedures PUBLIC 1101
Return value
Varchar(1020)
Returns up to 1020 characters that depend on the value of <flag> .
Where
<command_file
>
A string that indicates the location and file name to execute. This string is relative to the Job Server
location. It can be an absolute or relative path. Ensure that the files and directories in the path are
available from the Job Server computer.
The <command_file> can be a Windows batch file, a UNIX shell script, or a binary executable. To run
other interpreted scripts, ensure that the <command_file> is the name of the command interpreter,
such as 'perl', and the script is the first parameter in the <parameter_list>.
<parameter_li
st>
A string that lists the values to pass as arguments to the command file. Separate parameters with
spaces. When passing no parameters to an executable, enter an empty string (' ').
<flag> An integer that specifies what information appears in the return value string and how to respond when
<command_file> cannot be executed or exits with a nonzero operating system return code.
Exec function flags
Flag If successful, returns: On error: Notes:
0 Standard output Raises an exception:
System function
failure.
1 NULL string Raises an exception:
System function
failure.
Use this flag to track error
states in either of the following cases:
• The command never
produces output
• The calling job does not
need output
2 Standard output NULL string Use this flag if you do not
intend to track the status of
the command other than the
presence or absence of output.
3 NULL string NULL string
4 Standard output Error message string
5 NULL string Error message string
1102 PUBLIC
Reference Guide
Data Services functions and procedures
Flag If successful, returns: On error: Notes:
8
The concatenation of the return code
and the combined stdout and stderr
(standard error).
Returns the concatenation
of the return code and the
combined stdout and stderr
(standard error).
256 NULL string NULL string Use this flag to run your program independently of Data
Services.
Unlike flags 0-8, if you
use flag 256, Data Services
does not wait until the command (executable program)
completes before continuing
with job processing. In this
case, the command runs independently of Data Services
and stdout, stderr, and return
code cannot be returned.
Raises an exception
(System function
failure) if the program
cannot be launched (e.g.,
program file not found).
Details
• Ensure that the program that this function executes does not wait for any user input (such as a prompt
for a password). For flags 0-8, Data Services waits for the program to complete, therefore if the program
hangs for input, Data Services also hangs. For flag 256, Data Services continues if the program hangs for
input.
• For flags 4 and 5, the return value format for an error message string is:
'error-number: error-message-text'
The first field is exactly 7 characters wide and the second character begins at index 10. If the program
cannot be executed, the error number is 50307. If the program exits with a non zero return code, the error
number is 50306. The text is from SAP errormessage.txt. For example:
' 50306: Function <exec> failed to execute program 'foo.exe'. Program 
terminated with exit code 3.'
• For flag 8, the return value format is:
'return-code: stdout-and-stderr'
Reference Guide
Data Services functions and procedures PUBLIC 1103
The first field is exactly 7 characters wide and the second field begins at index 10. The program produces
the return code. Zero indicates success. Consult your program documentation to determine the meaning
of other codes.
 Example
For example:
• ' 0: 8 file(s) copied.'
• ' 1: The system cannot find the file specified.'
• ' 1: a.tmp -> /usr/tmp/a.tmp cp: *.lcl: The system cannot find the file
specified.'
• ' -2: manmix(): fatal application error.'
The 7-character format enables you to easily extract the first field, which is the return code from the
executed command, as a string of digits. Data Services automatically converts the string of digits to an
integer wherever necessary. The second field extracts as a regular string.
 Example
For example:
• In a script:
$foo = exec('foo.bat', ' ', 8);
$foo_rc = substr($foo, 1, 7);
$foo_txt = substr($foo, 10, 1020);
• In a data flow, map
exec('foo.bat', '', 8)
to an output column “foo” in a query. Then in a subsequent query, refer to the components of that
column in a mapping or WHERE clause. For example:
substr(query.foo, 1, 7);
substr(query.foo, 10, 1020);
Details about exec: Use of remote shells [page 1104]
For the exec function, use a remote shell to run a command elsewhere on the network.
6.1.3.41.1  Details about exec: Use of remote shells
For the exec function, use a remote shell to run a command elsewhere on the network.
To use a remote shell, consider the following information:
• The <command_file> named in an exec call can be 'rsh' on either Windows or UNIX systems to call the
remote shell facility. Use the 'rsh' as a means of running a command on a machine elsewhere on the
network.
1104 PUBLIC
Reference Guide
Data Services functions and procedures
 Example
For example:
• exec('rsh', '<RemoteMachineName> <CommandToRunRemotely> <CmdArg1>
<CmdArg2>', 0);
• exec('rsh', '<RemoteBox> -l<RemoteUser> <RemoteCommand> <CmdArg>', 3);
Call the remote shell facility sparingly, because the remote connection setup, remote authentication, and
increased message traffic reduce performance.
• For <flag> values 4, 5, and 8, Data Services receives the 'rsh' (or 'remsh') command type return code.
For example, 0 if it successfully gets a remote connection and authorization, non zero if it does not get a
remote connection and authorization. There is no relation between this return code and the return value of
the remote command inherent in the remote shell mechanism on all the operating systems.
To work around this behavior, wrap the remote command in a .bat file (Windows) or shell script (UNIX).
Wrapping the remote command gets the command return code %errorlevel% if Windows or $? if UNIX,
and prints it to stdout or stderr.
 Example
For example:
• exec('rsh', '<RemoteMachineName> <remcmdWrapper>.bat <CmdArg1> <CmdArg2>',
8);
• exec('rsh', '<RemoteBox> -l<RemoteUser> /usr/acta/<remcmdWrapper>
<CmdArg>', 4);
• The system administrator of the remote machine sets up access for the product user. The .rhosts and—
or the hosts.equiv file has an entry allowing this access.
• If the remote machine is Windows, ensure that the Remote Shell Service is running on it.
• If the remote machine is UNIX, ensure that the Remote Shell daemon rshd is running on it.
Consult your operating system documentation for more information.
 Example
The following examples apply to Windows or UNIX. If you use the first two examples for UNIX, substitute
'sh', 'csh', 'ksh', 'bash' or 'tcsh' for 'cmd'. Also, the first two examples call 'cmd' rather than the program
directly. Use 'cmd' or its equivalent if either:
• The “command” is a built-in of the shell. For example, 'DIR' is not a program in Windows.
• Piping, a single '|' in an argument, occurs
• In either Windows or UNIX, the pipe symbol sends the output of one command to another command.
Only use a pipe symbol inside quotes. In Data Services, the double pipe symbol (||) concatenates
strings. Only use double pipes outside quotes.
Also, remember that the forward and backward slash symbols ('\' '/') are interchangeable in Windows.
However use only the forward slash ('/') as a directory separator on UNIX.
exec('cmd', 'dir ' || $filename, 8);
exec('cmd', 'x:/bin/program1.exe | x:/bin/postprocess.bat', 4);
exec(SRC.PROGNAME, ARGTBL.ARGS || ' lastArg', 2);
exec('c:\Data Services\bin\clone_and_rename.bat', TBL.FNAME, 1);
exec('C:\Perl5\bin\perl.exe', 'C:\sandbox\stats.pl 20 50 3000', 0);
Reference Guide
Data Services functions and procedures PUBLIC 1105
6.1.3.42  extract_from_json
Use the extract_from_json function to extract JSON data from a field or database table into the output schema
in a Query transform using SAP Data Services nested relational data model (NRDM) structure.
 Syntax
extract_from_json(<json_column_name>,<schema_json_name>,<enable_validation>)
Where
Value Description
<json_column_name> The name of the input column that contains the JSON data. Ensure that the column
data type is varchar.
< schema_json_name > The name of the JSON Schema format that describes the incoming JSON data.
Import the metadata for this format into Data Services. Data Services displays the
format names in the Formats tab of the object library. Ensure that the input value is a
constant so that Data Services knows the output schema at design time.
<enable_validation> Enable a comparison of the incoming JSON data against the format you specify for
<schema_json_name>. The JSON data structure and the JSON format structure must
match. If the incoming data is not valid, and you enable this option, the data flow throws
an exception. Enter 1 to validate. Enter 0 to disable the validation option.
Validation is useful during development. It provides a more precise error if a problem
occurs with the incoming JSON string.
Details
The function supports varchar data types in the input column. Use the following methods to extract data from
clob and long data types.
• Data Services converts a clob data type input to varchar when you select the Import unsupported data
types as VARCHAR of size option. Select the option when you create a database datastore connection in
the Datastore editor.
• If your source uses a long data type, use the long_to_varchar function to convert data to varchar.
The output schema of this function matches that of the JSON format that you specify. Select any of the top
level columns or the two columns that Data Services generates in the NRDM for output:
• Select any number of the top level columns from the JSON schema. The return types of each column are
the same as the type defined in the JSON schema.
• AL_ERROR_NUM - Generated column that returns an error code that indicates that the error occurred inside
the function. A 0 indicates success and any non zero integer indicates an error.
1106 PUBLIC
Reference Guide
Data Services functions and procedures
• AL_ERROR_MSG - Generated column that returns an error message if AL_ERROR_NUM is not 0. Otherwise,
returns NULL.
 Example
extract_from_json(<cust_note_column>,<note_format>,1)
6.1.3.43  extract_from_xml
Use the extract_from_xml function to extract XML data from a field or database table into the output schema in
a Query transform using SAP Data Services nested relational data model (NRDM) structure.
 Syntax
extract_from_xml(<xml_column_name>,<schema_dtd_name>,<enable_validation>)
Value Description
<xml_column_name> The name of the input column that contains the XML text. Ensure that the column data
type is varchar.
< schema_dtd_name > The name of the DTD or XML Schema format that describes the incoming XML text.
Import the metadata for this format into Data Services. Data Services displays the
format names in the Formats tab of the object library. Ensure that the input value is a
constant so that Data Services knows the output schema at design time.
<enable_validation> Enable a comparison of the incoming XML data against the format you specify for
<schema_dtd_name>. Ensure that the XML data structure and the XML format structure match. When you enable <enable_validation>, the data flow throws an exception if the incoming data is not valid. Enter 1 to validate. Enter 0 to disable the validation
option.
Validation is useful during development. It provides a more precise error if a problem
occurs with the incoming XML.
Details
The software supports varchar data types in the input column. Use the following methods to extract data from
clob and long data types.
• Data Services converts a clob data type input to varchar if you select the Import unsupported data types as
VARCHAR of size option when you create a database datastore connection in the Datastore editor.
• If your source uses a long data type, use the long_to_varchar function to convert data to varchar.
Once you provide parameter values, the output schema of this function matches that of the XML that you
specified. Select any of the top-level columns or the two columns that Data Services generates in the NRDM for
output:
Reference Guide
Data Services functions and procedures PUBLIC 1107
• Select any number of the top-level columns from XML schema. The return type of each column matches
the type that you define in the XML schema.
• AL_ERROR_NUM - Generated column that returns an integer that indicates if an error occurred inside the
function. A 0 indicates success and any non-zero integer indicates an error.
• AL_ERROR_MSG - Generated column that returns an error message when AL_ERROR_NUM is not 0.
Otherwise, returns NULL.
 Example
extract_from_xml(<cust_note_column>,<note_format>,1)
Related Information
XML extraction and parsing for columns
6.1.3.44  file_copy
Use the file_copy function to copy an existing file to a different location using the same file name or a different
file name.
 Note
This function presents an elevated risk for command injection. Make sure you carefully check all
parameters to avoid possible vulnerabilities.
If an injection could occur, a warning will be displayed the first time each such function is computed. If you
prefer that that the job is terminated with an error when an injection could occur, add a DSConfig flag
ENABLE_SECURITY_ERROR = TRUE.
 Syntax
file_copy(<source>,<target>,overwrite_if_exist)
Return Value
int
Returns 1 if the file is copied to the target location. Returns 0 if the file is not copied.
1108 PUBLIC
Reference Guide
Data Services functions and procedures
Where
<source> The absolute path and name of the file to copy. Use a wildcard (*) in the file name to copy a
group of files that match the wildcard criteria.
Ensure that you have permission to access the source file location.
<target> The absolute path for the location of the copied file.
• To keep the same name as the source file, do not include a file name.
• To rename the moved file, include a different file name.
If you copy a group of files using a wildcard (*), enter the absolute path for the location of the
copied files.
Ensure that you have permission to access the target file and location.
overwrite_if_exist Enter a 0 or 1.
0 = Do not overwrite any existing file. The software does not overwrite the file if it exists in
the target location.
 Note
In this case, the software return value is 0, and the software issues a warning that no
files were copied to the target location.
1 = Overwrite any existing file. The software automatically overwrites the file if it exists in the
target location.
 Note
In this case, the software return value is 1, the software copies the source file to the
target location, and it overwrites any existing file with the same name in the target
location.
Details
The file_copy function overwrites any existing target file when you set the overwrite flag to 1. The source file still
exists in the original location after file_copy.
Use file_copy on regular file types only. For example, you cannot use file_copy for directory file types or
symbolic links.
Do not use the following characters in the source and target file name: \ / : * ? " < > | except when you
use the asterisk (*) in a file name to indicate a wildcard.
Reference Guide
Data Services functions and procedures
 Example
Function Results
file_copy('C:\temp\my_list.txt','D:\my_
lists\list_a.txt',1)
Copies a file and pastes it into a different location with a
different file name.
The function copies the my_list.txt file from the
source location C:\temp and pastes it to the target location D:\my_lists\ using a new name list_a.txt.
The function automatically overwrites any existing file of
the same name in the target location because the overwrite flag is set to 1.
file_copy('C:\temp\my_*.txt','D:\my_lis
ts',1)
Copies a group of files from one location and pastes them
into a different location.
The function copies all files that match the wildcard file
name my_*.txt from the source location C:\temp
to the target location D:\my_lists. The function automatically overwrites any existing files of the same name in
the target location because the overwrite flag is set to 1.
6.1.3.45  file_delete
Use the file_delete function to delete an existing file, or delete a group of files indicated by a wildcard (*).
 Note
This function presents an elevated risk for command injection. Make sure you carefully check all
parameters to avoid possible vulnerabilities.
If an injection could occur, a warning will be displayed the first time each such function is computed. If you
prefer that that the job is terminated with an error when an injection could occur, add a DSConfig flag
ENABLE_SECURITY_ERROR = TRUE.
 Syntax
file_delete(<DelFileName>)
Return Value
int
Returns 1 if the stated file is deleted. Returns 0 if the stated file is not deleted.
1110 PUBLIC
Reference Guide
Data Services functions and procedures
Where
<DelFileName> The absolute path and file name of an existing file to delete. Use a wildcard (*) in the file
name to delete a group of files that match the wildcard criteria.
Ensure that you have permission to the file and directory.
Details
Use file_delete on regular file types only. For example, you cannot use file_delete for directory file types
or symbolic links.
You may not use the following characters in the deleted file name: \ / : * ? " < > | except when you use
the asterisk (*) in a file name to indicate a wildcard.
 Example
Function Results
file_delete('C:\users\myfile.txt') Deletes a file.
The function deletes the file named myfile.txt from
C:\users.
file_delete('C:\users\my*.txt') Deletes a group of files matching a wildcard.
The function deletes all files that match the wildcard file
name my*.txt from the C:\users directory.
6.1.3.46  file_exists
Use the file_exists function to see if a file or directory exists.
 Syntax
file_exists(<file_path>)
Return Value
int
Returns 1 if a file or directory is present on the disk, even if it is 0 bytes long. Returns a 0 if the file or directory is
not present on the disk.
Reference Guide
Data Services functions and procedures PUBLIC 1111
Where
<file_path> The file name and path, relative to where the Job Server is running. It can be an absolute or
relative path.
Details
 Example
Examples:
Call sleep for 1 second when the file temp.msg exists in the directory called "c:".
while (file_exists('c:/temp.msg') = 1)
begin
 sleep(1000); 
end
Set a variable to a file name and use the function to check whether the file exists:
$unix_file = '/tmp/t.cpp';
if (file_exists($unix_file)) $type = 'unix';
Set a variable based on the value of the function:
$i = file_exists('c:/autoexec.bat')
6.1.3.47  file_move
Use the file_move function to move an existing file or group of files to a different location using the same file
name or a different file name.
 Note
This function presents an elevated risk for command injection. Make sure you carefully check all
parameters to avoid possible vulnerabilities.
If an injection could occur, a warning will be displayed the first time each such function is computed. If you
prefer that that the job is terminated with an error when an injection could occur, add a DSConfig flag
ENABLE_SECURITY_ERROR = TRUE.
 Syntax
file_move(<source>,<target>, overwrite_if_exist)
1112 PUBLIC
Reference Guide
Data Services functions and procedures
Return Value
int
Returns 1 if the file is moved to the target location. Returns 0 if the file is not moved.
Where
<source> The absolute path and name of the file to move. Use a wildcard (*) in the file name to move a
group of files that match the wildcard criteria.
Ensure that you have permission to access the source file and location.
<target> The absolute path for the location of the moved file (or files). Ensure that you have permission to access the target file and location.
overwrite_if_exist Enter a 0 or 1.
0 = Do not overwrite any existing file. The software does not overwrite the file if it exists in
the target location.
 Note
In this case, the function return value is 0, and the software issues a warning that no files
were moved to the target location.
1 = Overwrite any existing file. The software automatically overwrites the file if it exists in the
target location.
 Note
In this case, the function return value is 1, the software moves the source file to the
target location, and any existing file with the same name in the target location is overwritten.
Details
Overwrites any existing target file when the overwrite flag is set to 1. The source file does not exist in the
original location after file_move.
Use file_move on regular file types only. For example, you cannot use file_move for directory file types or
symbolic links.
• The source file no longer exists in the original location after file_move.
• You may not use the following characters in the source and target file name: \ / : * ? " < > |
However, you may use the asterisk character (*) in a file name to indicate a wildcard.
Reference Guide
Data Services functions and procedures PUBLIC 1113
• You can also use the file_move function to rename a file.
 Example
Function Results
file_move('C:\temp\my_list.txt','C:\use
rs',1)
Moves a file from one folder to a different folder in the
same directory.
The software moves the file named my_list.txt from
the C:\temp folder to the C:\users folder. After
file_move, the source file my_list.txt no longer
exists in the source folder. The software automatically
overwrites any existing file named my_list.txt in the
target location because the overwrite flag is set to 1.
file_move('C:\temp\my_list.txt','C:\tem
p\my_list2.txt',0)
Renames a file.
The software renames the file my_list.txt to
my_list2.txt. After the function successfully executes, the source file my_list.txt no longer exists.
In this example, the overwrite_if_exist flag is set
to 0, which means:
• If the file doesn't already exist in the target location,
the function return value is 1, and the file is moved to
the target location.
• If the file already exists in the target location, the
function return value is 0, and the software issues
a warning that the file was not moved to the target
location because the file already exists.
file_move('C:\temp\my*.txt',
'C:\users', 1)
Move a group of files using a wildcard.
The software moves all files that match the wildcard file
name my*.txt from the source C:\temp to the target
C:\users. After file_move, the files that match the
wild card file name no longer exist in the source folder. The
software automatically overwrites any files that already
exist in the target folder because the overwrite flag is set
to 1.
6.1.3.48  fiscal_day
Use the fiscal_day function to convert a date into an integer value that represents a day in a fiscal year.
 Syntax
fiscal_day('<start_year_date>',<in_date>)
1114 PUBLIC
Reference Guide
Data Services functions and procedures
Return Value
int
Where
<start_year_date> The first month and day of a fiscal year. Use the format:
'mm.dd'.
<in_date> The date you want to convert. Use any valid datetime.
Details
 Example
Function Results
fiscal_day('03.01', '1999.04.20') 51
6.1.3.49  floor
Use the floor function to return the largest integer value equal to or less than a number.
 Syntax
floor(<num>)
Return value
decimal, double, int, or real
The indicated integer, cast as the same type as the original number, <num> .
Reference Guide
Data Services functions and procedures PUBLIC 1115
Where
<num> The source number.
Details
 Example
Function Results
floor(12.12345) 12.00000
floor(12) 12
floor(-12.223) -13.000
6.1.3.50  gbq2file
Use the gbq2file function to optimize software performance when you export large-volume Google BigQuery
results to a user-specified file on your local machine.
 Syntax
gbq2file('<GBQ_datastore_name>','<any_query_in_GBQ>','<local_file_name>','<fil
e_location_object>', '<field_delimiter>','/<numeric_row_delimiter>');
Return value
int
Returns 1 if function is successful. Returns 0 if function is not successful.
1116 PUBLIC
Reference Guide
Data Services functions and procedures
Where
<GBQ_datastore_name> Name of the Google BigQuery application datastore in Data Services.
<any_query_in_GBQ> Name of the query in Google BigQuery.
<local_file_name> Local file location and file name in which to store the Google data.
Should be the same location as your local server.
<file_location_object> Name of the Google Cloud Storage file location object in Data Services.
<field_delimiter> Optional. The field delimiter to use between fields in the exported data. The default is a
comma.
<numeric row
delimiter>
Numeric value for the row delimiter
For example, /013
 Note
Default is 10, hex 0A.
Details
The software uses information in the associated Google cloud storage (GCS) file location object to identify your
GCS connection information, bucket name, and compression information.
How the function works:
1. The function saves your Google BigQuery results to a temporary table in Google.
2. The function uses export job to export data from the temporary table to GCS.
 Note
If the data is larger than 1 GB, Google exports the data in multiple files.
3. The function transfers the data from your Google Cloud Storage to the local file that you specified.
4. After the transfer is complete, the function deletes the temporary table and any files from Google Cloud
Storage.
For details about creating a Google BigQuery application datastore, see the Supplement for Google BigQuery.
Related Information
Google Cloud Storage file location
Reference Guide
Data Services functions and procedures PUBLIC 1117
6.1.3.51  gen_row_num_by_group
Use the gen_row_num_by_group function to generate a column of row identification numbers for each ID group
in the specified column.
 Syntax
gen_row_num_by_group(<expression_list>)
Return Value
Integer
Where
<expression_list> A list of one or more comma-separated expressions.
Details
This function groups the rows in a table based on the values in the specified expression_list in the natural order.
It returns a row ID beginning with 1, then increments it sequentially by 1 for each row in the group. When the
group changes, the function restarts numbering at 1.
 Example
For example, you have a table that lists record contracts by record number and contract ID. Values in
Contract ID column are not unique.
Input
Record Contract_ID Revised_by Revision_date
record 1 1 John 1/1/2005
record 2 1 Mary 1/15/2005
record 3 1 Tim 2/1/2005
1118 PUBLIC
Reference Guide
Data Services functions and procedures
Input
Record Contract_ID Revised_by Revision_date
record 4 2 Joe 2/24/05
record 5 2 Sue 2/30/05
When you apply gen_row_num_by_group function to the Contract_ID column, the software adds a new
column to the output table that contains row numbers by group.
A version = gen_row_num_by_group (Contract_ID)
There are two groups in the Contract_ID column: Three rows for Contract_ID 1 and two rows for
Contract_ID 2. The following table shows the output with the additional Version_Num column.
Output
Record Contract_ID Version_Num Revised_by Revision_date
record 1 1 1 John 1/1/2005
record 2 1 2 Mary 1/15/2005
record 3 1 3 Tim 2/1/2005
record 4 2 1 Joe 2/24/05
record 5 2 2 Sue 2/30/05
If the <expression_list> value corresponds to a column in a table, like in the preceding example, the
column must not be a nested relational data model (NRDM) or have the data type long. Also, do not use this
function with any group by clauses or aggregate functions.
6.1.3.52  gen_row_num
Use the gen_row_num function to return an integer value beginning with 1, then incremented sequentially by 1
for each additional call.
 Syntax
gen_row_num()
Reference Guide
Data Services functions and procedures PUBLIC 1119
Return Value
int
Details
Each occurrence, or call, of the function in a data flow is a unique instance, resulting in a unique sequence. Two
instances return values independent of each other. The first time the software calls an instance of this function,
the function returns a value of 1. Subsequent calls of the same instance return the previous value incremented
by 1, such as 2, 3, 4.
Each time the software calls the data flow, the software reinitializes all instances, and starts incrementing from
1.
 Example
Function Results
gen_row_num(Col1)
Col1
0
0
0
0
0
0
0
0
0
0
Col1
1
2
3
4
5
6
7
8
9
10
6.1.3.53  gen_uuid
Use the gen_uuid function to generate a unique identifier.
 Syntax
gen_uuid()
1120 PUBLIC
Reference Guide
Data Services functions and procedures
Return value
Varchar
Returns a unique 32-character varchar string. For example, 550e8400e29b41d4a716446655440000.
6.1.3.54  get_domain_description
Use the get_domain_description function to return the description of a value when provided with the domain
name and the value.
 Syntax
get_domain_description(<domain_name>,<domain_value>)
Return value
varchar
The description is returned as a quoted string. If the value is not in the domain, then a NULL is returned.
Where
<domain_name> Fully qualified domain name, including the database owner if required. For example:
<datastorename> . <owner.domain>
<datastorename> .. <domain>
<domain_value> The constant value for which you want to return a description.
Details
 Example
Function Results
get_domain_description('psoft..ACTION','ADL')
"Additional"
Reference Guide
Data Services functions and procedures PUBLIC 1121
6.1.3.55  get_env
Use the get_env function to return a value for the specified system environment variable.
 Syntax
get_env('<variable_name'>)
Return Value
varchar(255)
Returns the value of the environment variable. Returns NULL if the environment variable is not set. Therefore,
you can use the is_set_env function to determine whether a variable is set.
Where
<variable_name> The name of the environment variable. Ensure that you surround the name with single quotes.
Details
 Example
Function Results
getenv('TMP') C:\Temp
6.1.3.56  get_error_filename
Use the get_error_filename to return the full path and file name for the error log file that SAP Data Services
generates after a job run.
 Syntax
get_error_filename()
1122 PUBLIC
Reference Guide
Data Services functions and procedures
Return Value
varchar
Details
Data Services generates log files in the <DS_COMMON_DIR>\log\<Job Server>\<repository> directory.
This log file name starts with 'error_'.
Data Services generates a different set of log files for each batch job run. It generates a different set of log
files for each real-time job run in test mode. Data Services creates only one set of log files during the life of a
real-time service.
 Example
Create a job and add a script with, for example, the following lines.
print('Error File Name:');
print(get_error_filename());
Returns the following to the trace log:
Error File Name:
d://DI11/log/JS_Ora/repo__riv/
error_12_10_2004_12_06_41_12__8507da25_0b33_4ac1_9b53_fcf1e004c968.txt
6.1.3.57  get_file_attribute
Use the get_file_attribute function to return the value for a specified attribute of a physical file.
 Syntax
get_file_attribute(<filename>, <attribute>)
Return value
double if the attribute is size.
datetime if the attribute is either date_created or date_modified.
Reference Guide
Data Services functions and procedures PUBLIC 1123
Where
<filename> The file name and path relative to the current Job Server. Enter a file name as a relative path or
an absolute path.
<attribute> One of the following attributes, entered with single quotes: date_created, date_modified, or size.
Details
 Example
Function Results
get_file_attribute('//order', 
'date_created')
'2004:09:15:20:25:00'
The format in this example is YYYY:MM:DD:HH24:MM:SS.
get_file_ 
attribute(c:\database\order,'size')
'63281'
Displays file size in bytes.
Limitations
• The function cannot be pushed down.
• The function cannot be used in an ABAP data flow.
• For MS Window systems, the function cannot return the create time from FAT formatted disk drives. It
works with the NTFS (New Technology File System) format. Most systems use NTFS today because it is
more powerful and offers a security advantage over FAT.
6.1.3.58  get_monitor_filename
Use the get_monitor_filename function to return the full path and file name for the monitor log (trace) file
generated during a job run.
 Syntax
get_monitor_filename()
1124 PUBLIC
Reference Guide
Data Services functions and procedures
Return Value
varchar
Details
Data Services generates log files in the <DS_COMMON_DIR>\log\<Job Server>\<repository> directory.
This log file name starts with 'monitor_'.
Data Services generates a different set of log files for each batch job run and each real-time job run in test
mode. Data Services creates only one set of log files during the life of a real-time service.
 Example
Create a job and add a script with the following lines.
print('Monitor File Name');
print(get_monitor_filename());
Returns, for example, the following to the trace log:
Monitor File Name
d://DI11/log/JS_Ora/repo__riv/
monitor_12_1_2004_12_06_41_12__8507da25_0b33_4ac1_9b53_fcf1e004c968.txt
6.1.3.59  get_trace_filename
Use the get_trace_filename function to return the full path and file name for the trace log that is generated
during a job run.
 Syntax
get_trace_filename()
Return Value
varchar
Reference Guide
Data Services functions and procedures PUBLIC 1125
Details
Data Services generates log files in the <DS_COMMON_DIR>\log\<Job Server>\<repository> directory.
This log file name starts with 'trace_'.
Data Services generates a different set of log files for each batch job run and each real-time job run in test
mode. Data Services creates only one set of log files during the life of a real-time service.
 Example
Create a job and add a script with the following lines.
print('Trace File Name');
print(get_trace_filename());
Returns, for example, the following to the trace log:
Trace File Name
d://DI11_97/log/JS_Ora/o920i1__riv/
trace_12_10_2004_12_06_41_12__8507da25_0b33_4ac1_9b53_fcf1e004c968.txt
6.1.3.60  greatest
Use the greatest function to return the greatest of the list of one or more expressions.
 Syntax
greatest(<expression_list>)
Return Value
Data Services uses the first expression to determine the return type. After comparison, Data Services converts
the result into the return data type.
Where
<expression_list> A list of one or more comma-separated expressions.
1126 PUBLIC
Reference Guide
Data Services functions and procedures
Details
Greatest returns the greatest of the list of one or more expressions. Data Services implicitly converts
expression in the list to a normalized data type before comparison.
The software uses the following rules to determine the normalized data type.
• If the return data type is varchar, then the software implicitly normalizes all expressions to varchar before
comparison.
• If the return data type is one of the date data types, then the software implicitly normalizes all the
expressions in the list to that data type before comparison.
 Example
For example, if the return data type is date, and another data type is 'datetime', then the software
normalizes the 'datetime' data type to 'date' before comparison.
• If the return data type is numeric, then the software implicitly normalizes all the expressions to the highest
precedence numeric expression in the list.
 Example
For example, greatest (expr1,expr2,expr3,expr4) where expr1 is as integer, expr2 is a decimal
(4,2), expr3 is a float, expr4 is a decimal (38,7). The normalized data type is decimal.
The software converts all the expressions in the list to decimal data type before comparison. If the
normalized data type is decimal, then the precision is the highest precision among all decimal data
type expressions. The software preserves the scale for decimal data type expressions during implicit
conversion. When the software converts an integer data type expression to a decimal data type, its scale is
0. When float, double and varchar data types are converted into decimal data types, their scale is 6.
 Note
greatest() returns NULL when at least one argument is NULL.
 Example
Input
ID GRADE_Q1 GRADE_Q2 GRADE_Q3 GRADE_Q4
1 'A' 'B' 'B' 'C'
2 'F' 'F' 'E' 'C'
3 'B' 'B' NULL NULL
Output
MAX_GRADE=greatest(GRADE_Q1,GRADE_Q2,GRADE_Q3,GRADE_Q4)
ID MAX_GRADE
1 'C'
2 'F'
Reference Guide
Data Services functions and procedures PUBLIC 1127
Output
MAX_GRADE=greatest(GRADE_Q1,GRADE_Q2,GRADE_Q3,GRADE_Q4)
ID MAX_GRADE
3 NULL
6.1.3.61  host_name
Use the host_name function to return the name of the computer on which the job executes.
 Syntax
host_name()
Return Value
varchar
 Example
print('Host Name: [host_name()]');
6.1.3.62  ifthenelse
Use the ifthenelse function to enable conditional logic in expressions.
 Syntax
ifthenelse(<condition>, <true_branch>, <false_branch>)
Return value
<true_branch> or <false_branch>
Returns one of the values provided, based on the result of <condition>. The data type of the return value
is the data type of the expression in <true_branch>. If the data type of <false_branch> is not convertible
1128 PUBLIC
Reference Guide
Data Services functions and procedures
to the data type of <true_branch>, Data Services produces an error at validation. If the data types are
convertible but don't match, a warning appears at validation.
Where
<condition> An expression that evaluates to TRUE or FALSE.
<true_branch> An expression that the function returns if <condition> evaluates to TRUE.
<false_branch> An expression that the function returns if <condition> evaluates to FALSE.
Details
If <condition> compares a varchar value with trailing blanks, the ifthenelse function ignores the trailing
blanks.
To compare a NULL value (NULL constant or variable that contains a NULL constant), use the IS NULL or IS
NOT NULL operator. If you use the Equal (=) or Not equal to (<>) operator to compare against a NULL value,
<condition> always evaluates to FALSE.
To improve performance, Data Services pushes this function to the database. Thus, the database evaluates the
IFTHENELSE logic rather than the engine.
Use this function to apply conditional logic when mapping columns or selecting columns in a query. For more
flexible control over conditions in a script, use the IF keyword in the scripting language.
 Example
Function Results
ifthenelse (ZIP < 94000, 'SOUTH', 
'NORTH')
If the value in the column ZIP is less than 94000, the
value returned is SOUTH. If ZIP is greater than 94000,
then the value returned is NORTH.
6.1.3.63  index
Use the index function to return the index of a give character sequence in a string.
 Syntax
index(<input_string>, <index_string>, <start>)
Reference Guide
Data Services functions and procedures PUBLIC 1129
Return value
int
Specifies the first location of the indicated character sequence.
Where
<input_string> The source string.
<index_string> The character sequence sought in <input_string>.
<start> The position where the function starts searching in <input_string> for the character sequence contained in <index_string>.
<Start> should be a positive number between 1 and the length of <input_string>.
Details
The function searches for the <index_string> beginning at the <start> position in the input_string.
• If <start> is 0, the function resets it to 1.
• If <start> is greater than the number of characters in <input_string>, the function returns NULL.
• If <index_string> is not found in <input_string>, the function returns NULL.
Ensure that the characters in <index_string> exactly match the sequence of characters in
<input_string>.
 Example
The search is case-sensitive.
Function Results
index('Accounting Department', 'DEPARTMENT', 1) NULL
The index_string does not
match the case of the input_string so the function returns NULL.
1130 PUBLIC
Reference Guide
Data Services functions and procedures
Function Results
index('Accounting Department', 'Department', 1) 12
The string "Department" starts
at position 12 when you begin
counting at position 1, which is
the "A" of Accounting.
6.1.3.64  init_cap
Use the init_cap function to convert the first letter of each word in a string to upper case and the rest of the
value to lowercase. The function ignores all characters that are not alphabetic.
 Syntax
init_cap(<value>,'<locale>')
Return value
varchar
The title case string. Words are delimited by white space or characters that are not alphanumeric.
Where
<value> The string to be modified.
<locale> Optional parameter that converts the string to the specified locale.
 Note
The function supports ISO 639 language code and ISO 3166 country code formats.
Reference Guide
Data Services functions and procedures PUBLIC 1131
Details
 Example
Function Results
init_cap('Data Services') 'Data Services'
init_cap(StreetAddress) Writes the value, for example '1234 west washington school road', in column StreetAddress as
'1234 West Washington School Road'.
Print(Init_cap('have a nice day –hypen
+plus _underscore \slash $dollar *star
@at tab mIXedWORd UPPER lower !punctations
1234digits'));
Have A Nice Day -Hypen +Plus _Underscore
\Slash $Dollar *Star @At Tab Mixedword Upper
Lower !Punctuations 1234digits
init_cap(LastName,'tr') Converts the value in columnLastName to have
the first letter capitalized. If there are more than
one last name in this column, the first letter of
each word is capitalized.
Converts the values in LastName to the Turkish
locale, using the ISO 639 language code.
Limitations
• The function can be pushed down to Oracle databases only.
• You cannot use this function in an ABAP data flow.
6.1.3.65  interval_to_char
Use the interval_to_char function to convert an interval value to a string.
 Syntax
interval_to_char(<input_interval, interval_type>)
Return value
varchar
The converted string.
1132 PUBLIC
Reference Guide
Data Services functions and procedures
Where
<input_interval> The value of type interval to convert.
<interval_type> A string describing the format of the interval. Choose from the following values:
D
H
M
S
Days
Hours
Minutes
Seconds
Details
 Example
Function Results
interval_to_char(start_date -
sysdate(), 'd')
The number of days between the date in the column
start_date and the current date.
interval_to_char(start_time -
systime(), 'm')
The number of minutes between the time in the column
start_time and the current time.
6.1.3.66  is_group_changed
Use the is_group_changed function to return an integer, which indicates if the current occurrence of a group of
values has changed from the previous occurrence.
 Syntax
is_group_changed(<expression>)
Return Value
Integer
1 = Group has changed
0 = Group has not changed
Reference Guide
Data Services functions and procedures PUBLIC 1133
Where
<expression> One or more valid input expressions separated by commas.
Details
This function groups records based on the equal value of the input expressions in parameter1 in the natural
order of the input record stream. It returns 1 when the group is changed, 0 otherwise.
 Example
In the following example, the results show that four of the input groups have changed.
Function Results
is_group_changed(state,city) 1,0,1,0,0,1,1
Group ID State City Group change
1 California Los Angeles 1
2 California Los Angeles 0
3 California San Francisco 1
4 California San Francisco 0
5 California San Francisco 0
6 Nevada Reno 1
7 Colorado Reno 1
6.1.3.67  is_set_env
Use the is_set_env function to verify that the specified system environment variable is set.
 Syntax
is_set_env(<variable_name>)
1134 PUBLIC
Reference Guide
Data Services functions and procedures
Return value
int
Returns 1 if the environment variable is set, otherwise, returns 0.
Where
<variable_name> The name of the environment variable. Ensure that you surround the variable name by single quotes.
Details
 Example
Function Results
is_set_env('MODE') Returns 1 if the MODE variable has already been set; returns 0 if the MODE variable has not been set.
6.1.3.68  is_valid_date
Use the is_valid_date function to indicate whether an expression can be converted into a valid calendar date
value.
 Syntax
is_valid_date(<input_expression>,'<date_format>')
Return value
int
• 1 = The expression is not NULL and is valid.
• 0 = The expression is not NULL and is invalid.
• NULL = The expression is NULL.
Reference Guide
Data Services functions and procedures PUBLIC 1135
Where
<input_expression> The expression to be validated.
If the expression does not resolve to a value of data type varchar, the software issues a
warning that the value has been converted to a varchar.
<date_format> The string identifying the date format of the input string. Construct the date format using the
following codes and other literal strings or punctuation:
DD
MM
MONTH
MON
YY
YYYY
2-digit day of the month
2-digit month
Full name of month
3-character name of month
2-digit year
4-digit year
Details
 Example
For example the following expression returns 0 because there is no such date as January 34th.
is_valid_date ('01/34/2002', 'mm/dd/yyyy') 
 Example
Function Results
is_valid_date (Orders.SubmitDate,'mm/dd/yyyy') Tests whether the string
Orders.SubmitDate can be converted to a calendar date with the
mm/dd/yyyy date format.
1136 PUBLIC
Reference Guide
Data Services functions and procedures
6.1.3.69  is_valid_datetime
Use the is_valid_datetime to indicate whether an expression can be converted into valid calendar date and time
values.
 Syntax
is_valid_datetime(<input_expression>,'<datetime_format>')
Return value
int
• 1 = The expression is not NULL and is valid.
• 0 = The expression is not NULL and is invalid.
• NULL = The expression is NULL.
Where
<input_expression> The expression to be validated.
<datetime_format> The string identifying the datetime format of the input expression. Construct the datetime
format using the following codes and other literal strings or punctuation:
DD
MM
MONTH
MON
YY
YYYY
HH24
MI
SS
2-digit day of the month
2-digit month
Full name of month
3-character name of month
2-digit year
4-digit year
2-digit hour of the day (00-23)
2-digit minute (00-59)
2-digit second (00-59)
Reference Guide
Data Services functions and procedures PUBLIC 1137
Details
 Example
For example the following expression returns 0 because there is no such hour as 26:
is_valid_datetime ('01/14/2002 26:56:09', 'mm/dd/yyyy hh24:mi:ss') 
 Example
Function Results
is_valid_datetime
(Orders.Received,'mm/dd/yyyy
hh24:mi:ss')
Tests whether the string Orders.Received can be
converted to the mm/dd/yyyy hh24:mi:ss datetime
format.
6.1.3.70  is_valid_decimal
Use the is_valid_decimal to indicate whether an expression can be converted into a valid decimal value.
 Syntax
is_valid_decimal(<input_expression>,'<decimal_format>')
Return value
int
• 1 = The expression is not NULL and is valid.
• 0 = The expression is not NULL and is invalid.
• NULL = The expression is NULL.
Where
<input_expression> The expression to be validated.
1138 PUBLIC
Reference Guide
Data Services functions and procedures
<decimal_format> A string indicating the decimal format of the input expression. Use pound characters (#)
to indicate digits and a decimal indicator. If necessary, include commas as thousands
indicators. For example, to specify a decimal format for numbers smaller than 1 million
with 2 decimal digits, use the following string: '#,###,###.##'.
To indicate a negative decimal number, add a minus "-" sign at the beginning or end of this
value. For example, to test if the stock price difference can be converted to decimal format,
use the following function:
is_valid_decimal (Stocks.Price_difference, '-###.##')
Details
 Example
Function Results
is_valid_decimal (Orders.Price,'###,###.##') Tests whether the string Orders.Price
can be converted to decimal format.
6.1.3.71  is_valid_double
Use the is_valid_double function to indicate whether an expression can be converted into a valid double value.
 Syntax
is_valid_double(<input_expression>,'<double_format>')
Return value
int
• 1 = The expression is not NULL and is valid.
• 0 = The expression is not NULL and is invalid.
• NULL = The expression is NULL.
Reference Guide
Data Services functions and procedures PUBLIC 1139
Where
<input_expression> The expression to be validated.
<double_format> A string indicating the double format of the input expression.
Use pound characters (#) to indicate digits and a decimal
indicator. If necessary, include commas as thousands indicators. For example, to specify a double format for numbers
smaller than 1 million with 2 decimal digits, use the following
string: #,###,###.##'
Details
 Example
Function Results
is_valid_double
(Product.Weight,'###.###')
Tests whether the string Product.Weight can be converted to double format.
6.1.3.72  is_valid_int
Use the is_valid_int function to indicate whether an expression can be converted into a valid integer value.
 Syntax
is_valid_int(<input_expression>,'<int_format>')
Return value
int
• 1 = The expression is not NULL and is valid.
• 0 = The expression is not NULL and is invalid.
• NULL = The expression is NULL.
1140 PUBLIC
Reference Guide
Data Services functions and procedures
Where
<input_expression> The expression to be validated.
<int_format> The format specifying the thousands separator of the input
expression. For example, to specify an integer format, use
the following string: #.###.###'. Valid separators include
the period (.) and the comma (,). However, you can use only
one valid separator type in a format.
Separator defaults to the comma (,) when none is specified.
Details
 Example
Function Results
is_valid_int
(QuarterResults.Volume,'###.###')
Tests whether the string QuarterResults.Volume
can be converted to the ###.### integer format.
6.1.3.73  is_valid_real
Use the is_valid_real function to indicate whether an expression can be converted into a valid real value.
 Syntax
is_valid_real(<input_expression>,'<real_format>')
Return value
int
• 1 = The expression is not NULL and is valid.
• 0 = The expression is not NULL and is invalid.
• NULL = The expression is NULL.
Reference Guide
Data Services functions and procedures PUBLIC 1141
Where
<input_expression> The expression to be validated.
<real_format> A string indicating the real format of the input expression.
Use pound characters (#) to indicate digits and a decimal
indicator. For example, to specify a real format for numbers
smaller than 1 million with 2 decimal digits, use the following
string: '#,###,###.##'.
Details
 Example
Function Results
is_valid_real
(QuarterResults.Mean,'#,###.#####')
Tests whether the string QuarterResults.Mean can
be converted to real format.
6.1.3.74  is_valid_time
Use the is_valid_time function to indicate whether an expression can be converted into a valid time value.
 Syntax
is_valid_time(<input_expression>,'<time_format>')
Return value
int
• 1 = The expression is not NULL and is valid.
• 0 = The expression is not NULL and is invalid.
• NULL = The expression is NULL.
1142 PUBLIC
Reference Guide
Data Services functions and procedures
Where
<input_expression> The expression to be validated.
<time_format> The string identifying the time format of the input expression. Construct the time
format using the following codes and other literal strings or punctuation:
HH24
MI
SS
2-digit hour of the day (00-23)
2-digit minute (00-59)
2-digit second (00-59)
Details
 Example
Function Results
is_valid_time
(Orders.ReceivedTime,'hh24:mi:ss')
Tests whether the string Orders.ReceivedTime can
be converted to the hh24:mi:ss datetime format.
6.1.3.75  isempty
Use the isempty function to indicate whether a nested table contains data.
 Syntax
isempty(<table_name>)
Return value
int
The result of the content test:
• Returns 1 when the table does not contain data.
• Returns 0 when the table contains data.
Reference Guide
Data Services functions and procedures PUBLIC 1143
Where
<table_name> The fully qualified name of the nested table to test. A fully
qualified name contains the parent table names up to the
top level of the table in the current context.
If you specify only a table name, Data Services looks for the
table among the tables available through the FROM clause of
the current context. If you specify a partially qualified table
name, only part of the table hierarchy, Data Services looks
for the table among the tables available in the FROM clause
of the context indicated by the partial qualification.
Details
When performing operations on hierarchical data, the isempty function allows you to exclude rows in a higherlevel table based on whether a lower-level table contains data.
Data Services determines that a nested table is empty when the table contains no rows. If the nested table
contains even one row with null values in all columns, the isempty function indicates that the table has content.
If the nested table is empty except for another nested table, and the second nested table contains data, then
Data Services considers the first nested table as not empty.
 Example
Use the isempty function to determine if there are line items associated with a sales order. If the sales order
is the input data set to a Query transform and you want the query to exclude orders without line items,
include the following expression in the WHERE clause of the top-level context of the query:
isempty (order_table.line_items_table)
6.1.3.76  isweekend
Use the isweekend function to indicate whether a date corresponds to Saturday or Sunday.
 Syntax
isweekend(<date1>)
Return value
int
1144 PUBLIC
Reference Guide
Data Services functions and procedures
The result of the date test:
• Returns 1 when the date is a Saturday or Sunday.
• Returns 0 when the date is not a Saturday or Sunday.
Where
<date1> The value of type date or datetime to test.
Details
 Example
Function Results
isweekend(hire_date) Tests whether the date in hire_date is a Saturday or
Sunday.
isweekend(SYSDATE) Tests whether the current date is a Saturday or Sunday.
6.1.3.77  jde_date
Converts an input Julian date stored in a J.D. Edwards database to the equivalent SAP Data Services date data
type.
 Syntax
jde_date(<jde_julian_date>)
Return Value
date
Reference Guide
Data Services functions and procedures PUBLIC 1145
Where
<jde_julian_date> The integer column in the input table that contains a J.D.
Edwards Julian date.
Details
Use <jde_date> when Data Services does not automatically translate dates.
 Example
Function Results
jde_date (099049) 2/18/1999
Enter the function in the Mapping tab or the Where tab of the Query transform editor.
 Note
Because this function takes an integer as input, map the incoming column to an integer column before
applying the function.
Related Information
Date data type conversion
6.1.3.78  jde_time
Converts an input J.D. Edwards (JDE) number that represents time into an SAP Data Services character value
that represents the twenty-four hour time equivalent.
 Syntax
jde_time(<time_integer>)
Return value
char (8)
1146 PUBLIC
Reference Guide
Data Services functions and procedures
Where
<time_integer> The JDE number that represents a time.
Details
Given a number representing time in J.D. Edwards, jde_time returns a Data Services character value that
represents the equivalent twenty-four-hour time in <HH24:MI:SS> format:
• <HH> = hours
• <MI> = minutes
• <SS> = seconds
Enter the JDE time function in the Where tab or the Mapping tab of the Query transform.
 Example
Function Results
jde_time(92513) 09:25:13
 Note
Because this function takes an integer as input, map the incoming column to an integer column before
applying the function.
6.1.3.79  job_name
Use the job_name function to return the name of the object, such as a job, in which the call to this function
exists.
Returns the name of the job in which the call to this function exists.
 Syntax
job_name()
Return Value
varchar
Reference Guide
Data Services functions and procedures 
Details
 Example
print('Starting execution of Job: [job_name()] as user: [system_user_name()]');
6.1.3.80  Job_Run_ID
Use the job_run_id function to retrieve the job run ID for the current job execution.
 Syntax
Retrieves the job run ID for the current job execution.
job_run_id()
Return value
Varchar (20)
6.1.3.81  julian
Use the julian function to convert a date to the integer julian value. The Julian value is the number of days
between the start of the Julian calendar and the given date.
 Syntax
julian(<date1>)
Return value
int
The Julian representation of the date.
1148 PUBLIC
Reference Guide
Data Services functions and procedures
Where
<date1> The source value of type date or datetime.
Details
 Example
The following example uses the to_date function to convert the string to a date using the stated format.
Then, the julian function converts the date to the Julian representation of the date.
Function Results
julian(to_date('Apr 19, 1997', 'mon dd,
yyyy'))
729436
6.1.3.82  julian_to_date
Use the julian_to_date function to convert a given Julian value to a date.
 Syntax
julian_to_date(<input_julian>)
Return value
date
The date that corresponds to the input Julian value.
Where
<input_julian> An integer representing the Julian value to be converted.
Reference Guide
Data Services functions and procedures PUBLIC 1149
Details
 Example
Function Results
julian_to_date(Julian_Date) Converts the number indicated by Julian_Date to its
date value.
6.1.3.83  key_generation
Use the key_generation function to generate the next value in a series, after first determining the last value in
the series.
 Syntax
key_generation (<table>, <key_column>, <key_increment>)
Return value
int
The column value found to meet the function requirements.
Where
<table> The full path name of the file or full database specification
of the table in which the <key_column> is located. Enclose
this value in single quotation marks.
Use a fully qualified table name that includes the datastore,
owner, and table name. For example: oracle_ds.TIGER.sales.
For Netezza 7.x multischema, include the datastore,
owner, schema, and table name. For example:
NZ7_ds.DSDEV.SCHEMA1.TABLE1. If you do not specify the
schema name SCHEMA1, the function uses the default
schema. For example: NZ7_ds.DSDEV.TABLE1.
1150 PUBLIC
Reference Guide
Data Services functions and procedures
<key_column> A column with existing keys from which this function determines the largest existing key value. Enclose this value in
single quotation marks.
<key_increment> The integer increment used between key values that this
function generates.
Details
The key_generation function determines the maximum existing key value in a given column in the table in the
database manager and uses that value as a starting point to generate key values for the target schema.
 Note
Data Services does not support the key_generation function when you use SAP tables as readers.
 Example
Function Results
key_generation('target_ds.dbo.sales','o
rder_number',1)
Looks for the last key value in the order_number column in the sales database and returns the largest value
plus one.
6.1.3.84  last_date
Use the last_date function to return the last date of the month for a given date.
 Syntax
last_date(<in_date>)
Return Value
date
Reference Guide
Data Services functions and procedures PUBLIC 1151
Where
<in_date> The date for which the last date of the month is to be calculated.
Details
 Example
Function Returns
last_date('1990.10.01') '1990.10.31'
6.1.3.85  least
Use the least function to return the least of the list of one or more expressions.
 Syntax
least(<expression_list>)
Return Value
Data Services uses the first expression to determine the return type. After comparison, Data Services converts
the result into the return data type.
Where
<expression_list> A list of one or more comma-separated expressions.
Details
Data Services implicitly converts expressions in the list to a normalized data type before comparison.
1152 PUBLIC
Reference Guide
Data Services functions and procedures
The software uses the following rules to determine the normalized data type:
1. If the return data type is varchar, then implicitly normalizes all expressions to varchar before comparison.
2. If the return data type is one of the date data types, then implicitly normalizes all expressions in the list to
that data type before comparison.
 Example
For example, if the return data type is date, and another data type is 'datetime', then the 'datetime'
data type is normalized to 'date' before comparison.
3. If the return data type is numeric, then implicitly normalizes all the expressions to the highest precedence
numeric expression in the list.
 Example
For example, least(expr1,expr2,expr3,expr4) where expr1 is an integer, expr2 is a decimal
(4,2), expr3 is a float, expr4 is a decimal (38,7). The normalized data type is decimal.
The software converts all the expressions in the list to decimal data types before comparison. If the
normalized data type is decimal, then the precision is the lowest precision among all decimal data type
expressions. The decimal data type expressions preserve their scale during implicit conversion. When the
software converts an integer data type expression to a decimal data type, the scale is 0. When the software
converts float, double, and varchar data types into decimal data types, the scale is 6.
 Note
least() returns NULL when at least one argument is NULL.
 Example
Input
ID GRADE_Q1 GRADE_Q1 GRADE_Q3 GRADE_Q4
1 'A' 'B' 'B' 'C'
2 'F' 'F' 'E' 'C'
3 'B' 'B' NULL NULL
Output
MIN_GRADE=least (GRADE_Q1,GRADE_Q2,GRADE_Q3,GRADE_Q4)
ID MAX_GRADE MIN_GRADE
1 'C' 'A'
2 'F' 'C'
3 NULL NULL
Reference Guide
Data Services functions and procedures PUBLIC 1153
6.1.3.86  length
Use the length function to return the number of characters in a given string.
 Syntax
length(<value>)
Return value
integer
The number of characters in <value>.
Where
<value> A string indicating the column name, variable, or other element whose length is calculated.
Details
 Example
In the Mapping box of a query, use the length function to return the number of characters in each row of a
column. With the OUTPUT field selected in the target schema of a query, enter the following statement in
the Mapping box:
length(dal_emp.ename)
The software produces the following results:
Source column (dal_emp.ename) Target column (output)
jones 5
nguyen 6
tanaka 6
1154 PUBLIC
Reference Guide
Data Services functions and procedures
6.1.3.87  literal
Use the literal function to return an input constant expression without interpolation.
 Syntax
literal(<input>)
Return value
Same value as the value given for the input parameter but without interpolation.
Where
<input> A constant expression of any data type.
Details
Data Services does not use variable interpolation on constants. However, if you pass in a variable as a constant
expression, Data Services automatically uses variable interpolation, replacing special characters.
Replacing special characters is an issue with the match_pattern and match_regex functions because they
require these special characters. If your pattern_string or regular_expresion_pattern parameter in
these functions is a constant, you may want to disable interpolation. If so, use the literal function.
 Example
For example, you want to match $my_pattern with the pattern 'PART[123]'.
If you code it as $my_pattern = 'PART[123]'; match_pattern(product,$my_pattern);, the
interpolation changes the pattern being matched to 'PART123'. However, if you code it as $my_pattern
= literal ('PART[123]'); match_pattern(product, $my_pattern);, the return value is 1
because the pattern remains 'PART[123]'.
Alternatively, if you do not want to use a variable, you can code it as match_pattern
(product,'PART[123]');. Then the software does not interpolate on the constant 'PART[123]'.
There is no runtime cost for the literal function. Data Services substitutes the constant expression at compile
time.
 Example
To match only PART1 or PART2 or PART3 using the match_pattern function, assign a pattern to a variable
without interpolation. Use the literal function in the following type of expression:
Reference Guide
Data Services functions and procedures PUBLIC 1155
$pattern = literal('PART[123]');
If you do not use the literal function, the value assigned to $my_pattern in the following sample is
'PART123'. That is because Data Services automatically removes square brackets during interpolation.
$my_pattern='PART[123]';
print($my_pattern);
if (match_pattern('PART1',$my_pattern) <> 0)
 print('Matched');
else 
print('Not Matched');
To disable interpolation, use the literal function. The following example returns the expected result.
$my_pattern=LITERAL('PART[123]');
print($my_pattern);
if (match_pattern('PART1',$my_pattern) <> 0)
print('Matched');
else 
print('Not Matched');
6.1.3.88  ln
Use the In function to return the natural logarithm of the given numeric expression.
 Syntax
ln(<numeric_expression>)
Return Value
Float
If input is negative, return value is NULL.
Where
<numeric_expression> Any numeric expression.
Details
Returns the natural logarithm of the given numeric expression.
1156 PUBLIC
Reference Guide
Data Services functions and procedures
 Example
Function Results
ln(5.436563656918) 1.693147
6.1.3.89  load_from_azure_cloudstorage_to_synapse
Use the load_from_azure_cloudstorage_to_synapse function to load data from your Azure Cloud
Storage to your Azure Synapse Analytics workspace.
 Syntax
load_from_azure_cloudstorage_to_synapse('<Azure_Synapse_datastore>', 
'<table_name>', '<file_location>', '<file_name>', '<file_type>', 
<file_options>')
Category
The load_from_azure_cloudstorage_to_synapse built-in function is in the Miscellaneous category.
Prerequisites
Before you use this function, ensure that you've completed the following tasks:
• Established an Azure Synapse Analytics workspace.
• Created an Azure Synapse Analytics datastore in SAP Data Services and imported table metadata.
 Note
Azure Synapse Analytics is a sub data type of Microsoft SQL Server database datastore. It was
formerly listed as Azure DW.
• Created a File Location object in Data Services for your Azure Cloud Storage (Blob Storage).
Where
<Azure_Synapse_datastore> Name of the Azure Synapse Analytics datastore.
Reference Guide
Data Services functions and procedures PUBLIC 1157
<table_name> Name of the Azure Synapse Analytics table.
<file_location> Name of the Azure Cloud Storage File Location object.
<file_name> Name of the Azure Cloud Storage file or files to be loaded.
You can use the wildcard (*) to generate a list of files.
 Note
If you enter the wrong file name, or a file that doesn't exist in the Azure cloud storage, the function fails without
an error.
<file_type> The type of file to be loaded:
• CSV (default)
• PARQUET
• ORC
<file_options> Optional. Enter information, such as encoding information or
field delimiters.
For information about Azure Cloud Storage (Blob Storage) in Data Services, see the Data Services Supplement
for Big Data.
6.1.3.90  load_from_azure_datalakestore_to_synapse
Use the load_from_azure_datalakestore_to_synapse function to load data from files in your Azure
Data Lake Storage to your Azure Synapse Analytics workspace.
 Syntax
load_from_azure_datalakestore_to_synapse('<Azure_Synapse_datastore>', 
'<table_name>', '<file_location>', '<file_name>', '<file_type>', 
<file_options>')
Category
The load_from_azure_datalakestore_to_synapse built-in function is in the Miscellaneous category.
Prerequisites
Before you use this function, ensure that you've completed the following tasks:
1158 PUBLIC
Reference Guide
Data Services functions and procedures
• Established an Azure Synapse Analytics workspace.
• Created an Azure Synapse Analytics datastore in SAP Data Services and imported table metadata.
 Note
Azure Synapse Analytics is a sub data type of Microsoft SQL Server database datastore. It was
formerly listed as Azure DW.
• Created a File Location object in Data Services for your Azure Data Lake Store.
Where
<Azure_Synapse_datastore> Name of the Azure Synapse Analytics datastore.
 Note
Azure Synapse Analytics is a sub data type of the Microsoft SQL Server database datastore.
<table_name> Name of the Azure Synapse Analytics table.
<file_location> Name of the Azure Data Lake Store file location object.
<file_name> Name of the Azure Data Lake Store file or files to be loaded.
You can use the wildcard (*) to generate a list of files.
 Note
If you enter the wrong file name, or a file that doesn't
exist in the Azure Data Lake Store, the function fails
without an error.
<file_type> The type of file to be loaded:
• CSV (default)
• PARQUET
• ORC
<file_options> Optional. Enter information, such as encoding information or
field delimiters.
For information about Azure Data Lake Store in Data Services, see the Data Services Supplement for Big Data.
Reference Guide
Data Services functions and procedures PUBLIC 1159
6.1.3.91  load_from_gcs_to_gbq
Use the load_from_gcs_to_gbq function to transfer data from a Google Cloud Storage into a Google
BigQuery table.
 Syntax
load_from_gcs_to_gbq(“<datastore_name>”, “<remote_file_name>”, 
“<table_name>”, “<write_mode>”, “<file_format>”)
Before you can use this function, ensure that the Google BigQuery table exists. The table doesn't have to be in
your repository, however.
Return value
int
Returns 1 if function is successful. Returns 0 if function isn’t successful.
Where
<datastore_name> Name of the Google BigQuery datastore.
<remote_file_name> Name of the file to copy from the remote server in the format gs://bucket/filename. You can use wildcards.
<table_name> Name of the Google BigQuery table in the format
dataset.table.
<write_mode> Optional. The write mode values are:
• Append
• Truncated
Append is the default.
1160 PUBLIC
Reference Guide
Data Services functions and procedures
<file_format> The format of the data files using one of the following values:
• CSV: (Default value)
• DATASTORE_BACKUP
• NEWLINE_DELIMITED_JSON
• AVRO
• PARQUET
• ORC
 Note
For information about additional requirements for file
formats, see the Google Cloud documentation at
https://cloud.google.com/bigquery/docs . Search for
“Introduction to loading data from Cloud Storage”.
Details
Data Services uses the local and remote paths and Google Cloud Storage protocol information from the file
location object. The file location object is specified in the named datastore. After the table is in a Google
BigQuery table, use it as a source in a data flow.
 Example
You want to copy a JSON file in a Google BigQuery datastore on a remote server to a Google BigQuery table
on your local server. Here are the specifics:
• Google BigQuery datastore name: DS_GBQ1
• Remote file name: (JSON file name) gs://test-bucket_1229/from_gbq/
json08_from_gbq.json
• Google BigQuery table name: test.json08
• Write mode: Append
• File Format: NEWLINE_DELIMITED_JSON
You set up the following script:
load_from_gcs_to_gbq('DS_GBQ1', 'gs://test-bucket_1229/from_gbq/
json08_from_gbq.json', 'gbq_table.json08', 'append', 
'NEWLINE_DELIMITED_JSON');
The following example contains a sample expression for each type of supported file format.
 Example
CSV:
load_from_gcs_to_gbq('DS_CSV_GBQ', 'gs://bucket_1230/from_gbq/
csv_from_gbq.csv', 'gbq_csv.table', 'append', 'CSV');
Reference Guide
Data Services functions and procedures PUBLIC 1161
DATASTORE_BACKUP:
load_from_gcs_to_gbq('DS_DATASTRORE_GBQ', 'gs://bucket_1231/from_gbq/
datastore_from_gbq.export_metadata', 'gbq_datastore.table', 'append', 
'DATASTORE_BACKUP');
AVRO:
load_from_gcs_to_gbq('DS_AVRO_GBQ', 'gs://bucket_1232/from_gbq/
avro_from_gbq.avro', 'gbq_avro.table', 'append', 'AVRO');
PARQUET:
load_from_gcs_to_gbq('DS_PARQUET_GBQ', 'gs://bucket_1233/from_gbq/
parquet_from_gbq.parquet', 'gbq_parquet.table', 'append', 'PARQUET');
ORC:
load_from_gcs_to_gbq('DS_ORC_GBQ', 'gs://bucket_1234/from_gbq/
orc_from_gbq.orc', 'gbq_orc.table', 'append', 'ORC);
6.1.3.92  load_from_fl_to_snowflake
Use the load_from_fl_to_snowflake function to load data from files in Azure Cloud Storage, Amazon S3
storage, or Google Cloud Storage to a specified table in your Snowflake cloud storage.
 Syntax
load_from_fl_to_snowflake(<datastore>,<files>,<file location>,<fully qualified
table>,<mode>, <format>)
The load_from_fl_to_snowflake function is in the Miscellaneous category.
Return
int
Returns 1 if function is successful. Returns 0 if function isn't successful.
Where
<datastore> Specifies the name of the Snowflake datastore that you created in SAP Data Services.
1162 PUBLIC
Reference Guide
Data Services functions and procedures
<files> Specifies the name of the file or files to load from your local
file system. Use one of the following formats:
• Single file, such as 'test.dat'.
• Multiple files in a comma-separated list. For example:
'test1.dat, test2.dat,test3.dat'.
• Regular expression, such as 'test.*', which
includes all files with the word “test” in the
name. For example, 'test1.dat', 'test2.dat',
'test3.dat'.
<file location> Specifies the name of the Azure Cloud Storage, Amazon S3,
or Google Cloud Storage file location object that you created
in Data Services.
<fully qualified table> Specifies the fully qualified Snowflake table name using the
following format:
'<owner>.<schema>.<table>'
<mode> Specifies the method for loading the file or files to the target
Snowflake table.
 Example
Use 'append', 'trunc', or other native options for a 'COPY' statement in Snowflake, such as:
• ON_ERROR=CONTINUE
• FORCE=TRUE
Reference Guide
Data Services functions and procedures PUBLIC 1163
<format> Specifies the source file format.
Source file format can be one of the following formats:
• JSON
• XML
• CSV
• PARQUET
• ORC
• AVRO
• S3
• Azure
• GCS
You can include other format options.
 Example
For CSV format, provide the following attributes:
ENCODING=UTF8, FIELD_DELIMITER=',',
RECORD_DELIMITER='\N'
 Note
SAP Data Services supports substitution parameters for all of the load_from_fl_to_snowflake
parameters.
 Example
The following are examples of using the load_from_fl_to_snowflake function.
 Note
Line breaks added for readability.
Load single CSV from Amazon S3:
load_from_fl_to_snowflake('Snowflake_DS', '1.csv', 'S3', 
'SF_TUTS.PUBLIC.T2', 'append|FORCE=true', 'CSV|S3');
Load multiple files:
load_from_fl_to_snowflake('Snowflake_DS', '1.csv,2.csv,3.csv', 
'S3', 'SF_TUTS.PUBLIC.T2', 'append|FORCE=true', 'csv|S3);
Specify encoding:
load_from_fl_to_snowflake('Snowflake_DS', '1.csv', 'Azure', 
'SF_TUTS.PUBLIC.T2', 'append|FORCE=true', 'CSV|ENCODING=UTF8');
1164 PUBLIC
Reference Guide
Data Services functions and procedures
Specify delimiter:
load_from_fl_to_snowflake('Snowflake_DS', '1.csv', 'Azure', 
'SF_TUTS.PUBLIC.T3', 'append|FORCE=true', 'CSV| FIELD_DELIMITER=","');
Copy options:
# size limit 25MB
load_from_fl_to_snowflake('Snowflake_DS', '1.csv', 'Azure', 
'SF_TUTS.PUBLIC.T2', 'append|FORCE=true|ON_ERROR=CONTINUE, 
SIZE_LIMIT=25000000' , 'csv|azure|TRIM_SPACE=true');
6.1.3.93  load_from_s3_to_redshift
Use the load_from_s3_to_redshift function to use the Redshift COPY command to copy data files from an
Amazon Simple Storage Service (S3) bucket to a Redshift table.
 Syntax
load_from_s3_to_redshift("<datastore name>", "<table name>", "<file location 
name>", "<file name>", "<file options>") 
Where
<datastore name> Name of the Redshift datastore.
<table name> Name of the target table.
You can also specify the following:
• <table name> = <table name>
• <table name> = <schema name>.<table name>
• <table name> = <Redshift datastore name>.<schema name>.<table name>
• <table name> = <Redshift datastore name>.<Alias name used in
datastore>.<table name>
<file location
name>
Location of the S3 file.
<file name> Fully qualified name of the Amazon S3 file to copy to the Redshift table. Wild cards are allowed.
Reference Guide
Data Services functions and procedures PUBLIC 1165
<file options> Optional. Use the following file options as applicable when copying a file:
• acceptanydate: Accepts any date, even those with invalid formats, without throwing an
error.
• acceptinvchars: Replaces invalid UTF-8 characters.
• blankasnull: Inserts null if the input data is blank.
• dateformat: Defines the date format. For example, \'YYYY-MM-DD\'.
• delimiter: Defines the column delimiter. For example, \'|\'.
• emptyasnull: Inserts null if input data is empty.
• encoding: Defines the data file encoding type. Valid values include utf8 (default), utf16,
utf16le, and utf16be.
• encrypted: Loads encrypted data files from S3.
• escape: Removes escape (\) character. For example,a\\b\\c would be a\b\c.
• explicit_ids: Data values must match the Identity format and Identity columns.
• fillrecord: Fills null if any record is missed.
• ignoreblanklines: Ignores blank lines.
• ignoreheader: Skips the specified number rows as a file header. The default is 0.
• manifest: Loads manifest data files from S3.
• maxerror: Defines the maximum number of errors allowed. The default is 0.
• null as: Defines the special null string
• removequotes: Removes quotes from the data file.
• roundec: Rounds up numeric values when the input value is greater than the scale defined
for the column.
• timeformat: Defines the timestamp format. For example, \'YYYY-MM-DD
HH:MI:SS\'.
• trimblanks: Removes whitespace characters. Only applies to the varchar data type.
• truncatecolumns: Truncates data in columns when the input value is greater than the
column defined. Applies to varchar or char data types and rows 4MB or less in size.
• gzip: Loads compressed data files from S3.
• lzop: Loads compressed data files from S3.
• bzip2: Loads compressed data files from S3.
Details
 Sample Code
CREATE __AL_REPO_FUNCTION load_from_s3_to_redshift("Datastore" __FUNC_CHAR 
IN, "Table name" __FUNC_CHAR IN, "File location name" __FUNC_CHAR IN, 
"File name" __FUNC_CHAR IN, "File options" __FUNC_CHAR IN )
SET(database_type = 'ACTA',
function_type = 'Miscellaneous_Function',
DB_FunctionName = 'load_from_s3_to_redshift',
Description = 'This function loads Amazon S3 data file(s) to a Amazon 
Redshift table',
Parallelizable = 'NO', 
External_name = 'load_from_s3_to_redshift',
return_param_dep = 'null',
return_datatype = '5',
return_datatype_size = '4',
param0 = 'Name of the Amazon Redshift datastore.',
1166 PUBLIC
Reference Guide
Data Services functions and procedures
param1 = 'Name of the target table.',
param2 = 'Name of the Amazon S3 File location.' ,
param3 = 'Fully qualified name of the Amazon S3 file(s). Wild cards are 
allowed.' , 
param4 = 'File options that can be applied when copying the file. For 
example, \'delimiter \',\' encoding \'utf8\'\'.'
)
 Example
To copy a data file inside <bucket name>/<sub directory> on S3 to a Redshift table, define the
following in the S3 datastore:
• Bucket = <bucket name>
• Remote Directory=<sub directory>
Then enter the following:
load_from_s3_to_redshift('redshift_ft', ‘customer ', 'S3_to_Redshift’,
'customer.dat', 'delimiter \',\' ');
 Example
To generate an AES256 key, enter the following:
encrypt_aes('<plain password>', '<passphrase>', 256)
You can then use the key to upload data from the Redshift table to the S3 bucket.
unload ('select * from <redshift table>')
to 's3://<bucket name>/<sub directory>/' 
credentials 'aws_access_key_id=<access key>;aws_secret_access_key=<secret 
access key>;master_symmetric_key=<AES256 key> ' 
delimiter '|' encrypted bzip2;
 
To copy the encrypted data files on S3 back to a Redshift table, enter the following:
load_from_s3_to_redshift('redshift_ft', 'public.t31_household', 
'S3_to_Redshift_3', 't31_encrypted', 'master_symmetric_key \'<AES256 key> \' 
encrypted bzip2 delimiter \'|\''); 
 Example
To copy JSON data from S3 to a Redshift table, with a JSON path, enter the following:
load_from_s3_to_redshift('redshift_ft', 'public.t32_category', 
'S3_to_Redshift_3', 't33_category.json', 'json \'s3://dsqa-redshift-bkt3/
t33_category_jsonpath.json\''); 
 Example
To copy CSV data from S3 to a Redshift table, enter the following:
load_from_s3_to_redshift('redshift_ft', 'public.t32_category', 
'S3_to_Redshift_3', 't34_category_csv.txt', 'csv quote as \'%\''); 
Reference Guide
Data Services functions and procedures PUBLIC 1167
 Example
To copy fixed-width data from S3 to a Redshift table, enter the following:
load_from_s3_to_redshift('redshift_ft', 'public.t35_fixed_width', 
'S3_to_Redshift_3', 't35', 'fixedwidth 
\'catid:5,catgroup:10,catname:9,catdesc:40\''); 
Related Information
Amazon S3 file location protocol options
6.1.3.94  load_to_xml
Use the load_to_xml function to convert a nested relational data model (NRDM) table into XML and place the
XML in a single column during a data load.
 Syntax
load_to_xml (nested_table_name, schema_dtd_name, enable_validaton, 
xml_header, replace_string_nulls, is_top_level_element, max_size) 
Return value
If the function fails due to an error when trying to produce the XML output, Data Services returns NULL for the
scalar columns that you select for output and returns an empty nested table for NRDM columns.
Example
load_to_xml(nested_table_name, billing_address_schema, 0, '<?xml version="1.0" 
encoding="UTF-8"?>', NULL, 1, 4000)
Where
nested_table_name The name of the NRDM table that you want to convert into an XML format.
1168 PUBLIC
Reference Guide
Data Services functions and procedures
schema_dtd_name The name of the DTD or XML Schema that you want Data Services to use to format
the XML text in the output column.
Be sure to match the structure of the nested table to the structure provided by
the DTD or XML Schema. Or match the structure of its only child. Otherwise, Data
Services does not produce output. See the is_top_level_element for an example of specifying an only child.
 Note
Use Data Services to generate an XML Schema or DTD from an NRDM schema.
enable_validation Validates that Data Services generates XML that matches the XML format you specify for schema_dtd_name.
• Enter 1 to enable validation.
• Enter 0 to disable validation.
xml_header If the value specified is NULL, the header of the output XML has UTF-8 in the header.
The default header that the software generates is:
<?xml version="1.0" encoding="UTF-8"?>
If this value is not null, Data Services replaces the default XML header with a header
that you provide. Make sure the XML_header that you provide matches the encoding
of the target datastore where you store the XML data.
replace_null_string If this value is not null, Data Services replaces NULL values with the specified string.
Reference Guide
Data Services functions and procedures PUBLIC 1169
is_top_level_element • Enter 1 if the input column representing the NRDM table matches the root
element of the given DTD or XML Schema.
• Enter 0, if the input column should match the only child of the root element of
the DTD or XML Schema.
 Example
Imagine that an XML reader creates an NRDM structure with the root element named PO and an XML Schema po.xsd, which defines a root element also called PO . When you select the input column name PO as the
nested_table_name, it matches the root element of the schema, so set the
value of is_top_level_element to 1.
 Example
Imagine that a database table called employees has a row for each
employee. Also, you use an XML Schema called employees.xsd. The
employees.xsd schema defines a root element called allEmployees and
defines a single element called employee with unbounded occurrence.
In Data Services, the employee table exists in an NRDM structure with
employee as the root name.
If you enter employee as the nested_table_name, set the value for
is_top_level_element to 0 because it does not match the root element of
the schema allEmployees.
The function returns data with allEmployees as the root element and the
number of employee elements under it to match the number of rows in the input
employees table.
max_size The expected maximum size of the generated XML.
Related Information
XML extraction and parsing for columns
Generating DTDs and XML Schemas from Query mapping
6.1.3.95  local_to_utc
Use the local_to_utc function to convert the input datetime of any time zone to Coordinated Universal Time
(UTC).
 Syntax
local_to_utc(<input datetime>, <timezone of the input with UTC offset>) 
1170 PUBLIC
Reference Guide
Data Services functions and procedures
Return Value
datetime
Details
The second parameter, UTC offset, is a constant value. If you do not provide the UTC offset value, then Data
Services uses the time zone of the Job Server host to calculate the UTC offset.
Details
 Example
Function Results
local_to_utc(‘2014.02.01 00:00:00’,
‘UTC+08:30’)
'2014.01.31 15:30:00'
6.1.3.96  log
Use the log function to return the base-10 logarithm of the given numeric expression.
 Syntax
log(<num>)
Return Value
Float
If the input is negative, the return value is NULL.
Reference Guide
Data Services functions and procedures PUBLIC 1171
Where
<num> The number for which you want a base- 10 logarithm returned.
Details
 Example
Function Results
log(100.000) 2.000000
6.1.3.97  long_to_varchar
Use the long_to_varchar function to convert a data type value of a given column from long to varchar.
 Syntax
long_to_varchar(<column_name>, <max_size, start_position>)
Return value
varchar
Where
<column_name> The name of the column containing the long data type.
<max_size> The maximum size for the converted data in the table column.
<start_position> Optional. Starting character position from which data is converted. The default start position is 1. A negative number
indicates that Data Services starts counting backwards from
the last character.
1172 PUBLIC
Reference Guide
Data Services functions and procedures
Details
 Example
long_to_varchar(content_column, 4000)
long_to_varchar(content_column, 4000, -5000)
Related Information
XML extraction and parsing for columns
6.1.3.98  lookup
Use the lookup function to retrieve a value in a table or file based on the values in a different source table or file.
 Syntax
lookup (<lookup_table>, <result_column>, <default_value>, <cache_spec>, 
<compare_column>, <expression>)
Return value
Any type
The value in the <lookup_table> that meets the lookup requirements. The return type is the same as
<result_column>.
Reference Guide
Data Services functions and procedures PUBLIC 1173
Where
<lookup_table> The table or file that contains the result or value you are looking up (<result_column>).
The Use a fully qualified table name that includes the datastore, owner, and table name. For
example: oracle_ds.TIGER.sales. <compare_column> is also located in this table.
For Netezza 7.x multischema, include the datastore, owner, schema, and table name. For
example: NZ7_ds.DSDEV.SCHEMA1.TABLE1. If you do not specify the schema name, the
software uses the default schema. For example: NZ7_ds.DSDEV.TABLE1.
You might need to put the owner in quotes, particularly if you use lower case letters.
<result_column> The column containing the values you want to retrieve. This column is in the table or file
listed for <lookup_table>.
<default_value> The value returned when there is no matching row in the table or file listed for
<lookup_table>Use a fully qualified table name that includes the datastore, owner, and
table name. For example:.
<cache_spec> The caching method that the lookup operation uses. Enclose with single quotes. There are
three possible settings:
• NO_CACHE: Reads values from the <lookup_table> for every row without caching
values.
• PRE_LOAD_CACHE: Loads the <result_column> and <compare_column> into memory after applying filters but before executing the function.
Select this option if the number of rows in the table is small or you expect to access a
high percentage of the table values.
• DEMAND_LOAD_CACHE: Loads <result_column> and <compare_column> values
into memory as the function identifies them.
Select this option if the number of rows in the table is large and you expect to access a
low percentage of the table values frequently.
Select this option when you use the table in multiple lookups and the compare conditions are highly selective, resulting in a small subset of data.
<compare_column> The column in the <lookup_table> that the function uses to find a matching row.
When the function reads a varchar column in the <lookup_table>, it does not trim trailing
blanks.
1174 PUBLIC
Reference Guide
Data Services functions and procedures
<expression> The value that the function searches for in the <compare_column>. The value can be a simple column reference, such as a column found in both a source and the <lookup_table>.
The value can also be a complex expression given in terms of constants and input column
references.
When <expression> refers to a unique source column, you do not need to include a table
name qualifier. If <expression> is from another table or is not unique among the source
columns, you need a table name qualifier.
If <expression> is an empty string, the function searches for a zero-length varchar value in
the <compare_column>.
The function ignores trailing blanks in comparisons of <expression > and values in
<compare_column>.
 Note
You can specify more than one <compare_column> and <expression> pair. To specify more than one
pair, add additional pairs at the end of the function statement. Ensure that the values match for all specified
pairs in order for the lookup function to find a matching row.
Details
 Note
You cannot use this function with a J. D. Edwards datastore. Use the lookup_ext function instead.
The lookup function uses a value that you provide in <expression> to find a corresponding value in a file or
different table. Specifically, the function searches for the row in the <lookup_table> where the value in the
<compare_column> matches the value in <expression>. The function returns the <result_column> value
from this matching row.
For example, if your source schema uses a customer ID to identify each row, but you want the customer name
in your target schema, you can use the lookup function to return the customer name given the customer ID.
In SQL terms, the lookup function evaluates <expression> for each row, then executes the following
command:
SELECT <result_column>
 FROM <lookup_table>
 WHERE <compare_column> = <expression>
The value returned by this SELECT statement is the result of the lookup function for the row.
You can specify multiple <compare_column> and <expression> pairs to uniquely identify the
<result_column> value. However, the software provides only fields for one pair; add extra
<compare_column> and <expression> pairs to the output.
When there are no matching rows in the <lookup_table>, the lookup function returns the
<default_value>. When multiple matching rows exist in the <lookup_table>, the row that the lookup
Reference Guide
Data Services functions and procedures PUBLIC 1175
function returns is based on whether the lookup table is a standard RDBMS table, an SAP application table, or a
flat file:
• For standard RDBMS tables, the lookup function finds the matching row with the maximum value in the
<result_column> and returns that value.
• For SAP application tables or flat files, the lookup function randomly selects a matching row and returns
the value in the <result_column> for that row.
 Note
To avoid random row selection when the <lookup_table> is an SAP application table or a flat file, we
recommend that you use the lookup_seq() function.
To enhance performance, configure the lookup function to hold the values from the <lookup_table> in
memory. To do so, use the <cache_spec> setting. The optimal setting depends on the number of rows the
function must read, the number of rows in the table, and the available memory.
Example
You can use the lookup function to return a text value given a numerical identifier. For example, suppose that
you have a source table containing a numerical identifier, such as an employee number, and you want to use
the employee name in your target.
You can use the lookup function to return the employee name based on the employee number. The lookup
function uses a third table that translates the values from the source table to the desired values in the target
table.
To produce the desired target column:
1. Select the column that you want to look up in the target schema.
2. Click the Functions button located over the Mapping text box. The function wizard opens.
3. Select Miscellaneous_function under Function categories.
4. Select lookup under Function name.
5. Click Next. The Define Input Parameters dialog box opens.
6. Enter the function parameters as follows:
Option Value
Lookup table ODS_DS.SSB.EMPLOYEE
Result column LastName
Default value 'NoLastName'
Cache spec 'No_CACHE'
Compare column EmployID
Expression EmployID
The <expression> value refers to a column in the source file or table and, therefore, does not require
qualification with a table name. If this <expression> was from another table or was not unique among the
source columns, it would require a table name qualifier.
1176 PUBLIC
Reference Guide
Data Services functions and procedures
The function wizard automatically produces the following mapping text:
lookup(SQL_rbh.DBO.ODS_EMPLOYEE, LastName, 'NoLastName', 'NO_CACHE',
 EMP_ID, EMP_ID)
You can create a lookup function with two <expression> and <compare_column> pairs:
lookup(sap_ds..VBUP, GBSTA, 'none', 'NO_CACHE', VBELN, VBAK.VBELN, POSNR, 
VBAP.POSNR)
This lookup function returns the value from the GBSTA column in:
• the VBUP table that corresponds to the VBELN value in the VBAK table
• the POSNR value in the VBAP table
When the function does not fine a corresponding value, it returns "none."
6.1.3.99  lookup_ext
Use the lookup_ext function to retrieve data from a lookup table based on user-defined lookup conditions that
match input data to the lookup table data.
The lookup_ext function has an optional graphical editor.
The following syntax includes line breaks for clarity.
 Syntax
lookup_ext(
[<lookup_table,cache_spec,return_policy>],
[<return_column_list>],
[<default_value_list>],
[<condition_list>],
[<orderby_column_list>],
[<output_variable_list>],
[<sql_override>]
set ("run_as_separate_process"='yes'),
("output_cols_info"='<?xml version="1.0" 
encoding="UTF-8"?> 
<output_cols_info>
<col index="1" expression="yes"/>
</output_cols_info>')
)
Return value
any type
The return type is the first lookup column in <return_column_list>.
Reference Guide
Data Services functions and procedures PUBLIC 1177
Where
<lookup_table> The table, file, or memory datastore that contains the results
or values you are looking up (<result_column_list>).
Database table: If the <lookup_table> is a database table, enter the value using the <datastore.owner.table>
format.
 Example
ERP_ds.OWNER.EMPLOYEES
For Netezza 7.x multischema, include the datastore, owner,
schema, and table name in the value.
 Example
NZ7_ds.DSDEV.SCHEMA1.TABLE1.
If you do not specify the schema name, SCHEMA1 in the
example, the function uses the default schema.
 Example
NZ7_ds.DSDEV.TABLE1.
Flat file: If the <lookup_table> is a flat file, use the
<file_ds.filename> format when you enter the value.
 Example
delim."c:/temp/employees"
To substitute a variable for a file name, replace the data
inside the double quotes.
 Example
delim."$employees".
The variable used to store a file name can be a local or global
variable or a parameter passed to a work flow or a data flow.
If the cache specification is NO_CACHE, SAP Data Services
passes in a different file name each time it calls lookup_ext.
 Example
Call lookup_ext in a WHILE loop and assign a different
file name to the variable passed as the lookup file.
If the cache specification is PRE_LOAD_CACHE or DEMAND_LOAD_CACHE, the software uses only the first
1178 PUBLIC
Reference Guide
Data Services functions and procedures
file name that is passed. The software ignores all file
names passed during subsequent calls.
Memory datastore table: If the <lookup_table> is
a memory datastore table, enter the value using the
<memory_ds.table> format.
 Example
mem_ds.employees.
cache_spec The caching method the lookup_ext function uses. You can
select one of the following cache specifications:
• NO_CACHE: Reads values from the <lookup_table>
for every row without caching values.
• PRE_LOAD_CACHE: Loads the
<return_column_list>, <compare_column> (see
<condition_list>), and <orderby_column_list>
into memory after applying constant filters and before
executing the function. Select PRE_LOAD_CACHE if the
number of rows in the table is small or you expect to
access a high percentage of the table values.
• DEMAND_LOAD_CACHE: Loads
<return_column_list>, <compare_column> (see
<condition_list>), and <orderby_column_list>
into memory as the function identifies them. Select DEMAND_LOAD_CACHE under one or both of the following circumstances:
• The number of rows in the table is large and you
expect to frequently access a low percentage of
table values.
• You use the table in multiple lookups and the compare conditions are highly selective, resulting in a
small subset of data.
return_policy Optional. Specify whether the software obtains the return
columns from the smallest or the largest row based on values in the order by columns.
Use <return_policy> when you expect multiple rows and
want output data from one of the selected rows. Use one of
the following values:
• MAX (default)
• MAX-NS
• MIN
• MIN-NS
MAX-NS and MIN-NS allow the lookup_ext function to treat
NULL as the smallest value instead of the largest value.
Reference Guide
Data Services functions and procedures PUBLIC 1179
return_column_list Specify the names of output columns in the
<lookup_table> in a comma-separated list.
For a given output column in the lookup table, select the
Expression? checkbox in the lookup_ext editor when some
of the data is in the form of expressions. If you select the
Expression? checkbox and the data begins with an equal sign
(=), the software evaluates the data as an expression and
returns the result. Otherwise, it returns the column value.
<default_value_list> A comma-separated list containing the default expressions
for the output columns. When no rows match the lookup
condition, the software returns the default values for the
output column.
Ensure that each default expression type is compatible with
the corresponding output column type such that, if the types
are not exactly the same, automatic conversion is still possible.
If <default_value_list> is empty or has fewer expressions than the number of output columns, the software returns NULL by default. You cannot have more default expressions than the number of output columns.
1180 PUBLIC
Reference Guide
Data Services functions and procedures
<condition_list> A list of triplets that specify lookup conditions.
Each set in a triplet contains <compare_column>,
<compare_operator>, and <compare_expression>. The
value for <compare_operator> can be one of the following
symbols or words:
• <
• <=
• >
• >=
• =
• !=
• IS
• IS NOT
• ~
The <compare_column> is a column from the
<lookup_table>. The function compares the column
against the value in <compare_expression> to compute
the output row.
Write the <compare_expression> in terms of constants,
variables, and columns in the calling data flow or scripts.
While <compare_expression> cannot contain column reference from the <lookup_table>, it can be a simple constant, variable, column reference, or a complex expression
involving arithmetic operations and function calls.
Use compare operators IS and IS NOT to examine
<compare_column> against the NULL constant. When
you use IS or IS NOT as the compare operator, ensure
that the <compare_expression> contains the NULL constant. When you use other compare operators against a
<compare_expression> that contains a NULL, the lookup
condition return value is always FALSE.
Use the tilde (~) compare operator to indicate that the column from the lookup table contains a pattern. The required
pattern tags in the lookup table are as follows:
• mp(<pattern>): Indicates the match_pattern type
of pattern syntax
• mr(<pattern>): Indicates the match_regex type of
pattern syntax
• ms(<pattern>): Indicates the match_simple type of
pattern syntax
If <compare_expression> is an empty string, the
function looks up a zero length varchar value in the
Reference Guide
Data Services functions and procedures PUBLIC 1181
lookup table. The function ignores trailing blanks in the
<compare_expression>.
If you create more than one set of triplets, the function implicitly joins all triplets with the AND operator to compute
the final lookup condition.
 Example
[c1,
 
'=',10,c2,'<',query.a,c3,'>=',lowe
r(query.name)]
<orderby_column_list> Optional. A list of column names from the <lookup_table>
separated by commas.
Working with <return_policy>, the function uses the
<orderby_column_list> to determine what row to return the output when more than one row satisfies the
lookup condition. When multiple rows occur, the function sorts the list of rows based on columns from the
<orderby_column_list> and choosing a row to return using the MIN/MAX <return_policy>.
The <orderby_column_list> is optional. If you leave it
blank, the orderby columns match the output columns.
 Example
With [c1,c3,c4], the function sorts the rows using column values in c1, c3, c4.
With [ ], the function interprets as an empty list. The
function uses it as a placeholder for specifying subsequent parameters.
1182 PUBLIC
Reference Guide
Data Services functions and procedures
<output_variable_list> Optional. A comma-separated list of output variables. When
you specify more than one output column in the function
call, the function uses the output variables to receive output
returns. Variables and output columns are matched by position.
This parameter is optional unless more than one output column appears in the <return_column_list>. In the case of
more than one output column, ensure that output variables
are equal in number to output columns.
To enable conversion, ensure that the variable data type is
compatible with the corresponding output column. You do
not need to specify output variables if the function is called
using the function wizard to map output columns in the
query window.
 Example
[$a,$b,$c]
Reference Guide
Data Services functions and procedures PUBLIC 1183
<sql_override> This parameter is available as a button called Custom
SQL in the function wizard. Enter a valid, single-quoted
SQL SELECT statement or a $variable of type VARCHAR
to populate the lookup cache when the cache specification is PRE_LOAD_CACHE. This setting in this parameter
replaces the SQL SELECT statement generated internally
by the function for populating the cache. Ensure that
the SELECT statement selects at least the columns contained in <return_column_list>, <condition_list>,
and <orderby_column_list>.
The function allows any valid SQL SELECT statement
and you can also include references to other tables besides the <lookup_table> to specify inner and outer
joins. <sql_override> can be specified only when the
<lookup_table> is a database table.
The value you choose for <cache_spec> affects the way the
software processes the function:
• NO_CACHE: The software executes the sql_override
query each time the function is called.
• NO_CACHE: When you pass in a dynamic SQL statement in the form of a variable, the software dynamically
executes the SQL.
• PRE_LOAD_CACHE: The software executes only the
first sql_override query to populate the lookup cache.
The software ignores all subsequent SQL statements
after it builds the lookup cache.
• DEMAND_LOAD_CACHE: The software converts the
caching mode to PRE_LOAD_CACHE and behaves accordingly.
 Example
['select out1,
 
out2,compare1,compare2,orderby1,ord
erby2 from lookuptbl,othertbl 
where c1=10
 and 
lookuptbl.c2=othertbl.c2']
The following table contains the SET options:
1184 PUBLIC
Reference Guide
Data Services functions and procedures
run_as_separate_process • Yes: Runs each operation as a separate process that
uses separate resources such as memory and computer, to improve performance and throughput.
• No: Disables this option. No is the default setting.
 Example
SET 
("run_as_separate_process"='yes')
output_cols_info • Yes: An output column contains an expression (when
the Expression checkbox is selected).
• No: An output column does not contain an expression
(when the Expression checkbox is not selected). No is
the default setting.
 Example
Use the following syntax. Notice that the first column
begins with index value of 1.
SET ("output_cols_info"='<?xml 
version="1.0" 
encoding="UTF-8"?> 
<output_cols_info>
<col index="1" expression="yes"/>
</output_cols_info>')
Related Information
Lookup tables and the lookup_ext function
match_pattern [page 1199]
match_regex [page 1202]
match_simple [page 1208]
Run as separate process
6.1.3.99.1  Optimize lookup_ext using pushdown
Optimize the performance of the lookup_ext by pushing down the function processing to the database.
For best performance, the lookup_ext function can be pushed down to the database under the following
conditions:
• Use the lookup_ext function in the column mapping, output schema, or SELECT WHERE clause of a Query
transform.
Reference Guide
Data Services functions and procedures PUBLIC 1185
• The <lookup_table> is a database table from the same datastore as the reader or from a linked
datastore to the reader.
• You set the <cache_spec> value to NO_CACHE.
• You set the <return_policy> value to either MAX or MIN.
• All conditions that you use in <condition_list> are database expressions.
• You use only the equals operator (=) in the lookup <condition_list>.
• You set the <run_as_separate_process> SET option to No.
• You ensure that for lookups with multiple-result column values, the database supports the rank, or
equivalent function.
When the database is SAP HANA, MySQL, SAP ASE, and Informix, you can utilize pushdown with restrictions.
Because there is no analytic function support for these databases, use pushdown only for single-result
columns, or for multiple-result columns for primary keys.
6.1.3.99.2  lookup_ext limitations
There are limitations that you should know about when you use the lookup_ext function.
• You cannot call the lookup_ext function from an ABAP data flow. Instead, use the lookup function.
• The caching mode is always NO_CACHE when you call the lookup_ext function in script objects, jobs, or
work flows. Selecting NO_CACHE is necessary because the software cannot determine when to release the
cache after executing the function.
• The following parameters in the lookup_ext function do not support long, blob, and NRDM data types:
• <default_value_list>
• <orderby_column_list>
• <condition_list>
Therefore, you cannot look up a long column or specify a column or expression of the long data type.
• If you do not set a value for an optional parameter, ensure that you add empty square brackets as an empty
placeholder [ ] for the optional parameter when it is followed by another optional parameter for which you
specify a value.
• Under certain circumstances, for best performance, use the equals operator to specify the lookup
condition.
 Example
• When you set the caching mode to NO_CACHE, and the lookup table is a database table, the
underlying DBMS uses fast access methods, such as index, to retrieve data based on an indexed
key.
• When you set the caching mode to PRE_LOAD_CACHE, the equals comparison results in more
efficient memory lookup than other comparison operators.
• When you set the caching method to PRE_LOAD_CACHE, the function pushes down any lookup
condition that uses a constant expression to the database. The pushdown results in smaller lookup
caches than the current lookup.
• When you set the lookup_ext function for pattern evaluation, your data flow could run out of memory. That
is because pattern evaluation uses virtual memory and is not included as part of pageable cache when the
lookup table is cached. When your lookup table has many patterns, select the Run as a separate process
1186 PUBLIC
Reference Guide
Data Services functions and procedures
option so the process runs separately from the rest of the function processes. Also consider using Run as a
separate process when you use expressions in output columns because of the same caching issue.
6.1.3.100  lookup_seq
Use the lookup_seq function to retrieve a value in a table or file based on the values in a different source table
or file and a sequence value.
 Syntax
lookup_seq (<lookup_table>, <result_column>, <default_value>, 
<sequence_column>, <sequence_expression>, <compare_column>, <expression>)
Return value
Any type
The value in the <lookup_table> that meets the lookup_seq requirements. The return type is the same as
<result_column>.
Reference Guide
Data Services functions and procedures
Where
<lookup_table> The table or file that contains the results or value you are looking up.
Use a fully qualified table name that includes the datastore, owner, and table name.
 Example
ERP_ds.OWNER.EMPLOYEES
For Netezza 7.x multischema, include the datastore, owner, schema, and table name.
 Example
NZ7_ds.DSDEV.SCHEMA1.TABLE1.
If you do not specify the schema name, the function uses the default schema.
 Example
NZ7_ds.DSDEV.TABLE1.
The software caches the <lookup_table> automatically for the operation of the
function.
 Note
The <sequence_column> and <compare_column> are also located in the table
or file that you specify for <lookup_table>.
<result_column> The name of the column containing the values you want to retrieve. This column is in
the <lookup_table>.
When the column contains varchar values, the function does not trim trailing blanks.
<default_value> The value returned when there is no matching row in the <lookup_table>.
<sequence_column> The column in <lookup_table> that indicates the sequence of the row. This column
may contain a date that indicates when new values were added to the row. For example, in some source tables, <sequence_column> is the EFFDT column, which
indicates when the data in the row became effective.
<sequence_expression> The value the function searches for in the <sequence_column> to find a matching
row.
 Example
To find changed rows in a dimension table as of the current date, use the return
value from the sysdate function for the value in <sequence_expression>.
If <sequence_expression> is an empty string, the function looks up a zero-length
varchar value in the lookup table.
1188 PUBLIC
Reference Guide
Data Services functions and procedures
<compare_column> The column in the <lookup_table> that the function uses to find a matching row.
<expression> The value that the function searches for in the <compare_column>. This can be
a simple column reference, such as a column found in both a source and the
<lookup_table>. This can also be a complex expression given in terms of constants
and input column references.
When <expression> refers to a unique source column, you do not need to include a
table name qualifier. If <expression> is from another table or is not unique among
the source columns, you need a table name qualifier.
If <expression> is an empty string, the function looks up a zero-length varchar value
in the lookup table.
The function ignores trailing blanks in comparisons of <expression > and values in
<compare_column>.
 Note
You can specify more than one <compare_column> and <expression> pair. To specify more
<compare_column> and <expression> values, add additional pairs at the end of the function statement.
Ensure that the values match for all specified pairs so the lookup function can find a matching row.
Details
The lookup_seq function uses a value you provide in <expression> to find a corresponding value in a different
file or table specified in <lookup_table>. When multiple rows match, the function uses the row sequence to
determine the matching row.
More specifically, the function searches for the rows in the <lookup_table> where the value in the
<compare_column> matches the value in <expression>. When the function finds multiple matching
rows, it searches in the <sequence_column> for the row with the closest value less than or equal to the
<sequence_expression>. If no row has a value less than or equal to the <sequence_expression>, the
function finds the row with the closest value to the <sequence_expression>. For the matching row, the
function returns the value in the <result_column>.
For example, if your source schema uses an employee ID to identify each row, and you want the employee's
salary at the end of the previous year in your target schema, you can use the lookup_seq function to return the
employee salary given the employee ID and the effective date of the salary. The salary returned will be the value
corresponding to the latest effective date less than or equal to the value of <sequence_expression>.
In SQL terms, the lookup_seq function evaluates <expression> for each row, then determines which
sequence column value meets the requirements:
SELECT MAX(<sequence_column>) 
 FROM <lookup_table>, <source_table>
 WHERE <sequence_column> <= <sequence_expression>
 AND <compare_column> =
 <source_table.expression>)
Reference Guide
Data Services functions and procedures PUBLIC 1189
Suppose this query stores the <sequence_column> value returned as <sequence_result>. Next, the
function uses the <sequence_result> to find the proper <result_column>:
SELECT <result_column>
 FROM <lookup_table, source_table>
 WHERE <sequence_column> = <sequence_result>
 AND <compare_column> =
 <source_table.expression>
The value returned by these queries is the result of the lookup_seq function for the row.
You can specify multiple <compare_column> and <expression> pairs to uniquely identify the
<result_column> value. However, the function wizard only provides fields for one pair; add extra
<compare_column> and <expression> pairs to the output that the wizard generates.
Data Services always caches the comparison table when performing a lookup_seq function.
If the lookup_seq function does not find the value of <expression> in <compare_column>, then the function
evaluates and returns the <default_value>.
Example
You can use the lookup_seq function to return a value from a slowly changing dimension table given an
identifier. For example, suppose you have a source table that contains a numerical identifier, such as an
employee number, and you want to retrieve the employee's salary at a specific time in the past. You can use the
lookup_seq function to return the employee's salary on a particular date based on the employee number.
The source table contains the employee number and employee name.
You want the target table to contain the employee name and salary.
Use the lookup_seq function to translate the values from the source table to the desired values in the target
table. The lookup_seq function uses a third, "translation," table.
To produce the desired target column, select the column in the target schema. Next, click the Functions button,
located over the Mapping text box. In the function wizard, select Miscellaneous_functions under Function
categories, then select lookup_seq under Function name. Enter the function parameters as follows:
Option Value
Translate table ODS_DS.SSB.FINANCE
Result column Salary
Default value '0'
Sequence column EffectiveDate
Sequence Expression '12.31.1999'
Compare column EmployeeID
Expression EmployID
The function wizard automatically produces the mapping text
lookup_seq(Ora_DS.RBH.FINANCE, SALARY, '0',
1190 PUBLIC
Reference Guide
Data Services functions and procedures
 EFFECTIVEDATE, '12.3.1.1999', Employee_ID, EmployID)
For each employee, this lookup_seq function returns the value from the salary column for that employee that is
the most recent before December 31, 1999.
6.1.3.101  lower
Use the lower function to change the characters in a string to lower case.
 Syntax
lower(<value>,'<locale>')
Return value
varchar
The lowercase string. The return type is the same as <value>. The function leaves any characters that are not
letters unchanged.
Where
<value> The string to be modified.
<locale> Optional. Specify a locale to convert the string to the locale.
 Note
The function supports the ISO 639 language code and the ISO 3166 country code formats.
Details
 Example
Function Results
lower('Accounting101') 'accounting101'
Reference Guide
Data Services functions and procedures PUBLIC 1191
Function Results
upper((LastName,1,1))|
lower(substr(LastName,2,LENGTH(LastName
)))
The value in column LastName with the first letter uppercase and the rest of the value lowercase. Note that this
example does not account for two-word last names.
lower(LastName,'tr') The value in column LastName is converted to all lowercase. It is also converted to the Turkish locale, using the
ISO 639 language code.
6.1.3.102  lpad
Use the lpad function to pad the left side of a string with specific characters.
 Syntax
lpad(<input_string>,<size>,'<pad_string>')
Return value
varchar
The modified string. The return type is the same as <value>. The function leaves any characters that are not
letters unchanged.
Where
<input_string> The string source, such as a column name.
<size> An integer value indicating the number of characters in the
return string.
<pad_string> A character or set of characters that this function concatenates to <input_string>.
Details
This function repeats the pattern at the beginning of the input string until the final string is the appropriate
length. If the input_string is already longer than the expected length, then this function returns a truncated
string without adding special characters.
1192 PUBLIC
Reference Guide
Data Services functions and procedures
 Example
Function Results
lpad('Tanaka', 15, ' ') ' Tanaka'
 Note
The character in <pad_string> is a space.
lpad(last_name, 25, ' ') The value in the column last_name, padded with spaces
from the left to 25 characters. If the value in last_name
exceeds 25 characters, truncates from the right.
6.1.3.103  lpad_ext
Use the lpad_ext function to pad the left side of a string with logical characters from a given pattern.
 Syntax
lpad_ext(<input_string>,<size>,'<pad_string>')
Return value
varchar
The modified string. The return type is the same as <value>. The function leaves any characters that are not
letters unchanged.
Where
<input_string> The string source.
<size> An integer value indicating the number of characters in the
return string.
<pad_string> A logical character or set of logical characters that this function concatenates to the <input_string>.
Reference Guide
Data Services functions and procedures PUBLIC 1193
Details
The logical characters prohibit this function from getting pushed down to the database.
The function repeats the value in <pad_string> from the beginning of the input string until the final string is
the length set in <size>. If the value in <input_string> is already longer than the expected length, then this
function truncates the string from the right.
 Example
Function Results
lpad_ext('Tanaka', 15, ' ') ' Tanaka' 
 
lpad_ext(last_name, 25, ' ') The value in the column last_name, padded with spaces
to 25 characters on the left. If the string alone exceeds 25
characters, truncates the string to 25 characters from the
right.
 Example
The lpad_ext and lpad functions exhibit the same behavior when the software evaluates the functions.
However, the database behavior is different when the software pushes the function down to the database
and the value in <input_string> and—or <pad_string> contain multibyte characters.
Function Input Output
lpad lpad("abc¶¶", 10,' ') ' abc¶¶'
lpad_ext lpad_ext("abc¶¶", 10,' ') ' abc¶¶'
lpad lpad("abc¶¶", 10,'') 'abc¶¶'
lpad_ext lpad_ext("abc¶¶", 10,'') 'abc¶¶'
lpad lpad("abcd", 10, '¶') '¶¶¶abcd'
lpad_ext lpad_ext("abcd", 10, '¶') '¶¶¶¶¶¶abcd'
6.1.3.104  ltrim
Use the ltrim function to remove specified characters from the start of the string.
 Syntax
ltrim(<input_string>, <trim_string>)
1194 PUBLIC
Reference Guide
Data Services functions and procedures
Return value
varchar
The modified string. The return type is the same as <input_string>.
Where
<input_string> The string to be modified.
<trim_string> The characters to remove from <input_string>.
Details
The ltrim function is case-sensitive.
The function scans <input_string> left-to-right removing all characters that appear in <trim_string>
until it reaches a character not in <trim_string>.
 Example
Function Results
ltrim('Marilyn', ' ') 'Marilyn'
ltrim('ABCABCD', 'ABC') 'D'
ltrim('ABCABCD', 'EFG') 'ABCABCD'
ltrim('ABCDEABCDE', 'ABC' 'DEABCDE'
 Example
To remove all leading blanks in a string, use ltrim as follows:
ltrim(EMPLOYEE.NAME, ' ')
where EMPLOYEE.NAME specifies the NAME column in the EMPLOYEE table. You may also use the
ltrim_blanks or ltrim_blanks_ext functions for this.
Reference Guide
Data Services functions and procedures PUBLIC 1195
6.1.3.105  ltrim_blanks
Use the ltrim_blanks function to remove blank characters from the start of a string.
 Syntax
ltrim_blanks(<input_string>)
Return value
varchar
The modified string. The return type is the same as <input_string>.
Where
<input_string> The string to be modified.
Details
 Example
Function Results
ltrim_blanks(' Marilyn') 'Marilyn'
ltrim_blanks(last_name) The value contained in the column last_name, with all
leading blanks removed.
6.1.3.106  ltrim_blanks_ext
Use the ltrim_blanks_ext function to remove blank and control characters from the start of a string.
 Syntax
ltrim_blanks_ext(<input_string>)
1196 PUBLIC
Reference Guide
Data Services functions and procedures
Return value
varchar
The modified string. The return type is the same as <input_string>.
Where
<input_string> The string to be modified.
Details
 Example
Function Results
ltrim_blanks_ext(' Marilyn') 'Marilyn'
ltrim_blanks_ext(last_name) The value contained in the column last_name, with all
leading blanks and control characters removed.
6.1.3.107  mail_to
Use the mail_to function to e-mail a specified number of lines in a trace and error log file to specified recipients.
 Syntax
mail_to(<recipients_list>, <subject>, <message>, <number_of_trace_lines>, 
<number_of_error_lines>)
Return value
int
Returns:
• 0: Function suceeded.
Reference Guide
Data Services functions and procedures PUBLIC 1197
• 1: Function failed.
0 if function succeeds. Returns an integer that is not 0 if function fails.
Where
<recipients_list> A string containing one or more recipient e-mail addresses
separated by commas (,). This string cannot be empty. Ensure that it contains valid qualified e-mail address information.
<subject> Optional. A string containing the subject of the e-mail. This
string can be empty.
<message> Optional. A string containing the e-mail message. This string
can be empty.
<number_of_trace> <_lines> The number of lines from the end of the trace log file to
append to the end of the e-mail. This input cannot be empty.
<number_of_error> <_lines> The number of lines from the end of the error log file to
append at the end of the e-mail. This input cannot be empty.
Details
The function performs the following tasks:
• Captures the specified number of lines in the trace log and error log.
• Packages the information as e-mail.
• Uses your Job Server computer mail client to send e-mail messages to your local mail server for standard
e-mail processing.
Use this function only within a script.
Before you use this function, ensure that the computer on which your Job Server is installed has a mail client.
Also ensure that the logon account for the mail client has the same user name and password as the SAP Data
Services service. The type of client varies by the operating system. The following lists the client type for each
operating system:
• MAPI (message application programming interface): Applicable for Job Servers running on a computer
with the Windows operating system. Ensure that the mail client is configured as the default mail client. For
example, on Windows, make Microsoft Outlook your default mail client. Microsoft Outlook is a MAPI-based
mail client.
• Mailx: Applicable for Job Servers running on a computer with the UNIX operating system.
 Note
If you do not have the required mail client, contact SAP Business User Support for assistance.
1198 PUBLIC
Reference Guide
Data Services functions and procedures
 Example
Function Results
$myvar = mail_to('admin@company.com',
'Out of memory error in the SalesFact
job. Please fix the error before
running recovery job.',' ', 10, 10)
The message is sent to one recipient. It has a subject line
but no message. The e-mail contains 10 lines from the
trace log and 10 lines from the error log.
$myvar = mail_to('admin@company.com,
manager@company.com', 'Out of memory
error:' || systime(), 'Out of memory
error while running the data flow:' ||
$dataflow_name || ' in the job:' ||
$job_name || '.', 10, 20)
The message is sent to two recipients. The job name and
data flow names are included in the text of the message as
variables. Note that the software trims blank spaces from
the end of strings; this example includes a blank on the
beginning of the next string. You can also concatenate a
string with a single blank.
In the script, type "$a = ;" where $a is the local integer
variable defined in the work flow. Put the cursor just ahead
of the semicolon before clicking the Functions button to
construct a mail_to statement.
 Note
If your mail system is compatible with the software mail_to function, you can use e-mail nicknames
(comma separated) as values in the <recipients_list>. When you use nicknames, the software mailer
program searches your e-mail address book for the nickname and uses the corresponding qualified e-mail
address for message routing.
Limitation for Windows 2000
The mail_to function might not work properly on Windows 2000. The malfunction may occur after
downloading a security patch for Microsoft Outlook that includes e-mail prompts. If you experience this
problem, you have two options:
• Change the Outlook security settings to suppress prompts.
• Use the smtp_to function instead of the mail_to function.
6.1.3.108  match_pattern
Use the match_pattern function to match a whole input string to simple patterns supported by the software.
 Syntax
match_pattern(<input_string>,<pattern_string>)
Reference Guide
Data Services functions and procedures PUBLIC 1199
Return Value
int
Returns:
• 1: Pattern matched
• 0: Pattern did not match
Where
input_string String to be matched. Supports UNICODE characters.
pattern_string Pattern to find in the whole input string. Create <pattern_string> using characters
listed in the following table.
The function does not support substring matches.
Details
Characters for pattern_string
X Represents uppercase characters. Unicode 4.2 General Category Values specification. Key = Lu, uppercase letter (For example, Latin, Greek, Cyrillic, Armenian, Deseret, and archaic Georgian.)
x Represents non uppercase characters. Unicode 4.2 General Category Values specifications keys:
• Ll = Lowercase letter (For example, Latin, Greek, Cyrillic, Armenian, Deseret, and archaic Georgian.)
• Lt = Titlecase letters (For example, Latin capital letter D with small letter Z.)
• Lm = Modifier letter (For example acute accent, grave accent.)
• Lo = Other letter (Includes Chinese, Japanese, and so on.)
9 Represents numbers.
\ Escape character.
* Any characters occurring zero or more times.
? Any single character occurring once and only once.
[ ] Any one character inside the braces occurring once.
[!] Any character except the characters after the exclamation point. For example, [!12] can allow any number
that does not start with a 1 or 2.
All other characters represent themselves. To specify a special character as itself, use an escape character. For
example, [!9] means any character except a digit. To specify any digit except 9, use [!\9].
1200 PUBLIC
Reference Guide
Data Services functions and procedures
The following table displays pattern strings that represent example values:
Example pattern strings
Example value Pattern string
Henrick Xxxxxxx
DAVID XXXXX
Tom Le Xxx Xx
Real-time Xxxx-xxxx
JJD)$@&*hhN8922hJ7# XXX)$@&*xxX9999xX9#
1,553 9,999
0.32 9.99
-43.88 -99.99
Returns names with last name Jones *Jones
Returns Henrick1 or HenrickZ Henrick?
Returns David1 or David2 or David3 David[123]
 Example
Use the match_pattern function in the Validation transform or in a WHERE clause of a Query transform.
The input string can be from sources such as columns, variables, or constant strings.
Use case Pattern Function call in a script Results
To match a zip code except
one that begins with 1 or 2.
'[!12]9999' if
(match_pattern('150
14', '[!12]9999')
<> 0)
print('matched');
else print('not
matched');
Function prints “not
matched”.
To match a zip code except
one that begins with 1 or 2.
'[!12]9999' if
(match_pattern('550
14', '[!12]9999')
<> 0)
print('matched');
else print('not
matched');
Function prints “matched”.
Reference Guide
Data Services functions and procedures PUBLIC 1201
Use case Pattern Function call in a script Results
To process only customer
phone numbers that fit the
same pattern.
'999-999-9999' WHERE
MATCH_PATTERN(CUSTO
MER.PHONE_NUM,'999-
999-9999') <> 0
Phone numbers that do not
match the pattern throw error 0.
To check a string against a
complex pattern and print
result to trace log.
'XXX)$@&*xxX9999xX9#' if(match_pattern('J
JD)
$@&*hhN8922hJ7#',
'XXX)
$@&*xxX9999xX9#')
<> 0) print
('matched'); else
print('not
matched');
The result for this call is
“matched”.
6.1.3.109  match_regex
Use the match_regex function to match whole input strings to the pattern that you specify with regular
expressions and flags.
 Syntax
match_regex (<input_string>, <regular_expression_pattern>, <flags>) 
Return Value
int
Returns:
• 1 = Pattern matched
• 0 = Pattern does not match
Where
<input_string> String to be matched. The function supports UNICODE characters.
1202 PUBLIC
Reference Guide
Data Services functions and procedures
<regular_expression_pattern> Pattern you want to find in a whole input string. The function
does not match substrings.
Provide the pattern in regular expression format with a varchar data type.
<flags> Allows you to specify additional behavior that you want to
occur while Data Services searches the input_string for pattern matches.
Specify a flag, or specify more than one flag separated by
commas. Ensure that you enter flags using the correct case
because flag options are case sensitive.
If you do not want a flag, enter NULL.
Details
Use POSIX standards when you enter regular expressions. POSIX refers to the POSIX.1 standard
IEEE Std 1003.1, which defines system interfaces and headers with relevance for string handling and
internationalization. The XPG3, XPG4, Single Unix Specification (SUS), and other standards include POSIX.1 as
a subset. The patterns that we list in the following tables adhere to the current standard. For more information
and updates, see “Regular Expressions” in the International Components for Unicode (ICU) User Guide at
https://unicode-org.github.io/icu/userguide/ .
Use the regular expression patterns in the following table for the <regular_expression_pattern>
argument.
Character Description
\a Match a BELL, \u0007.
\A Match at the beginning of the input. Differs from ^ in that \A
does not match after a new line within the input.
\b, outside of a [Set] Match if the current position is a word boundary. Boundaries occur at the transitions between \w (word character or
characters) and \W (nonword character or characters), with
combining marks ignored. For better word boundaries, see
ICU Boundary Analysis.
\b, within a [Set] Match a BACKSPACE, \u0008.
\B Match if the current position is not a word boundary.
\cX Match a control-X character.
Reference Guide
Data Services functions and procedures PUBLIC 1203
Character Description
\d Match any character with the Unicode General Category of
Nd (Number, Decimal Digit).
\D Match any character that is not a decimal digit.
\e Match an ESCAPE, \u001B.
\E Terminates a \Q ... \E quoted sequence.
\f Match a FORM FEED, \u000C.
\G Match if the current position is at the end of the previous
match.
\n Match a LINE FEED, \u000A.
\N{UNICODE CHARACTER NAME} Match the named character.
\p{UNICODE PROPERTY NAME} Match any character with the specified Unicode Property.
\P{UNICODE PROPERTY NAME} Match any character not having the specified Unicode Property.
\Q Quotes all following characters until \E.
\r Match a CARRIAGE RETURN, \u000D.
\s Match a white space character. White space is defined as
[\t\n\f\r\p{Z}].
\S Match a non-white space character.
\t Match a HORIZONTAL TABULATION, \u0009.
\uhhhh Match the character with the hex value hhhh.
\Uhhhhhhhh Match the character with the hex value hhhhhhhh. Provide
exactly eight hex digits, even though the largest Unicode
code point is \U0010ffff.
\w Match a word character. Word characters are [\p{Ll}\p{Lu}
\p{Lt}\p{Lo}\p{Nd}].
\W Match a nonword character.
\x{hhhh} Match the character with hex value hhhh. From one to six
hex digits may be supplied.
\xhh Match the character with two digit hex value hh.
1204 PUBLIC
Reference Guide
Data Services functions and procedures
Character Description
\X Match a Grapheme Cluster.
\Z Match if the current position is at the end of input, but before
the final line terminator, if one exists.
\z Match if the current position is at the end of input.
\n Back reference. Match whatever the nth capturing group
matched. n must be a number greater than 1 and less than
the total number of capture groups in the pattern. Note: Octal escapes, such as \012, are not supported in ICU regular
expressions.
[pattern] Match any one character from the set. See Unicode Set for a
full description of what may appear in the pattern.
. Match any character.
^ Match at the beginning of a line.
$ Match at the end of a line.
\ Quotes the following character. Characters that require
quotes to be treated as literals are * ? + [ ( ) { } ^ $ | \ . /
Use the regular expression operators in the following table for the <regular_expression_pattern>
argument.
Operator Description
| Alternation. A|B matches either A or B.
* Match 0 or more times. Match as many times as possible.
+ Match 1 or more times. Match as many times as possible.
? Match zero or one time. Prefer one.
{n} Match exactly n times.
{n,} Match at least n times. Match as many times as possible.
{n,m} Match between n and m times. Match as many times as
possible, but not more than m.
*? Match 0 or more times. Match as few times as possible.
+? Match 1 or more times. Match as few times as possible.
Reference Guide
Data Services functions and procedures PUBLIC 1205
Operator Description
?? Match zero or one time. Prefer zero.
{n}? Match exactly n times.
{n,}? Match at least n times, but no more than required for an
overall pattern match.
{n,m}? Match between n and m times. Match as few times as possible, but not less than n.
*+ Match 0 or more times. Match as many times as possible
when first encountered, do not retry with fewer even if overall match fails. Possessive match.
++ Match 1 or more times. Possessive match.
?+ Match zero or one time. Possessive match.
{n}+ Match exactly n times.
{n,}+ Match at least n times. Possessive match.
{n,m}+ Match between n and m times. Possessive match.
( ... ) Capturing parentheses. Range of input that matched the
parenthesized subexpression is available after the match.
(?: ... ) Non-capturing parentheses. Groups the included pattern,
but does not provide capturing of matching text. Somewhat
more efficient than capturing parentheses.
(?> ... ) Atomic-match parentheses. First match of the parenthesized subexpression is the only one tried; if it does not lead
to an overall pattern match, back up the search for a match
to a position before the "(?>"
(?# ... ) Free-format comment (?# comment ).
(?= ... ) Look-ahead assertion. True if the parenthesized pattern
matches at the current input position, but does not advance
the input position.
(?! ... ) Negative look-ahead assertion. True if the parenthesized pattern does not match at the current input position. Does not
advance the input position.
1206 PUBLIC
Reference Guide
Data Services functions and procedures
Operator Description
(?<= ... ) Look-behind assertion. True if the parenthesized pattern
matches text preceding the current input position, with the
last character of the match being the input character just
before the current position. Does not alter the input position.
The length of possible strings matched by the look-behind
pattern must not be unbounded (no * or + operators).
(?<! ... ) Negative look-behind assertion. True if the parenthesized
pattern does not match text preceding the current input
position, with the last character of the match being the input
character just before the current position. Does not alter the
input position. The length of possible strings matched by
the look-behind pattern must not be unbounded (no * or +
operators).
(?ismx-ismx: ... ) Flag settings. Evaluate the parenthesized expression with
the specified flags enabled or disabled.
(?ismx-ismx) Flag settings. Change the flag settings. Changes apply to the
portion of the pattern following the setting. For example, (?i)
changes to a case-insensitive match.
Use the flags in the following table for the <flag> argument.
Flag Options Description
'CASE_INSENSITIVE' If set, matching takes place in a case-insensitive manner.
'COMMENTS' If set, allows use of white space and #comments within patterns.
'DOTALL' If set, a "." in a pattern matches a line terminator in the input
text. By default, it will not.
Note that a carriage return or line feed pair in text behave
as a single line terminator and match a single "." in a regular
expression pattern.
'MULTILINE' If set, the function treats the input string as multiple lines
instead of a single line. The '^' and '$' characters apply to
each line in the input string instead of the entire input string.
'NO_PUSHDOWN' If set, the match_regex function is processed but is never
pushed down to the database.
 Example
Use the match_regex function in the Validation transform by accessing the Smart Editor or function wizard
or in a WHERE clause of a Query transform. The input string can be from sources such as columns,
variables, or constant strings.
Reference Guide
Data Services functions and procedures PUBLIC 1207
Use Case Pattern Function Call
To match phone numbers in
(408)-933-6000 format.
'([0-9]{3}-[0-9]{3}-[0-9]{4}' match_regex
(pho_number,'([0-9]
{3}-[0-9]{3}-[0-9]
{4}',NULL)
To match a string that starts with "topicA" regardless of case.
'topicA.*' match_regex (subject,
'topicA.*','CASE_INSENSIT
IVE')
6.1.3.110  match_simple
Use the match_simple function to match a whole input string to simple patterns supported by the software for
this function.
 Syntax
match_simple(<input_string>,<pattern_string>)
Return Value
int
Returns:
• 1 = Pattern matches
• 0 = Pattern does not match
Where
<input_string> String to be matched. Supports UNICODE characters.
<pattern_string> Pattern you want to find in a whole input string.
Details
The match_simple function does not match substrings.
Use the characters in the following table for <pattern_string>.
1208 PUBLIC
Reference Guide
Data Services functions and procedures
. Represents any single character.
* Represents any character zero or more times.
# Represents any single alphabetic character including non-English letters.
$ Represents any alphabetic character, including non-English letters, zero or more times.
+ Matches the previous character one or more times.
(string)+ Matches the string one or more times.
[number1..number2] Numeric range (integers only). Matches any number between number1 and number2.
\ Escape character
; OR operator. If the data matches any of the identified patterns, the result is TRUE. Enclose
the list with curly brackets {}. Example:
{ABC+;XYZ*}
If the data matches either ABC+ or XYZ*, the result is TRUE.
<> NOT operator. Specify the pattern after the <>. Example:
<><pattern>
{EMPTY} and {empty} Special predefined patterns that match empty data.
{NULL} and {null} Special predefined patterns that match NULL data.
If the pattern is empty, then the function matches all data.
If the value of a pattern column is NULL, then the function does not match with any value.
All other characters represent themselves. If you want to specify a special character as itself, then use an
escape character.
 Example
Example patterns
Example Value Pattern string
ACCT1234567 ACCT*
ZIP10000 to ZIP99999 ZIP[10000..99999]
ACCT123 or ACCOUNT234 {ACCT*;ACCOUNT*}
www.anything.com www.$.com
Example
Use the match_simple function in the Validation transform or in a WHERE clause of Query transform. The input
string can be from sources such as columns, variables, or constant strings. The following example illustrates
sample code used in a script.
Reference Guide
Data Services functions and procedures PUBLIC 1209
Use Case Pattern Function Call Results
To match account numbers
from ACCT1 to ACCT5000
ACCT[1..5000] if
(match_simple('ACCT
14',
'ACCT[1..5000]'))
<> 0 print
('matched'); else
print('not
matched');
Function prints "matched".
6.1.3.111  max
Use the max function to return the maximum value from a list.
 Syntax
max(<value_list>)
Return value
Any type
The maximum value of the column values. The return type is the same as the values in <value_list>.
Where
<value_list> The source values for which to identify a maximum.
Details
 Example
To calculate the maximum value in the salary column of a table, use the max function in a query:
• In the Mapping tab of the query editor, enter:
max(SALARY)
1210 PUBLIC
Reference Guide
Data Services functions and procedures
• In the Group By tab in the query editor, specify the columns for which you want to find the maximum
salary, such as the department column. For each unique set of values in the group by list, such as each
unique department, Data Services calculates the maximum salary.
6.1.3.112  min
Use the min function to return the minimum value from a list.
 Syntax
min(<value_list>)
Return value
Any type
The minimum value of the column values. The return type is the same as the values in <value_list>.
Where
<value_list> The source values for which to identify a minimum.
Details
 Example
To calculate the minimum value in the salary column of a table, use the min function in a query:
• In the Mapping tab of the query editor, enter:
min(SALARY)
• In the Group By tab in the query editor, specify the columns for which you want to find the minimum
salary, such as the department column. For each unique set of values in the group by list, such as each
unique department, Data Services calculates the minimum salary.
Reference Guide
Data Services functions and procedures PUBLIC 1211
6.1.3.113  mod
Use the mod function to return the remainder when one number is divided by another.
 Syntax
mod(<numerator>, <denominator>)
Return Value
integer
Where
<numerator> Integer to be divided.
<denominator> Divisor of first integer.
Details
 Note
The % operator from SAP Information Steward syntax produces the same result.
 Example
Function Result
mod(10,3)
1
mod(17,5)
2
mod(10,5)
0
1212 PUBLIC
Reference Guide
Data Services functions and procedures
6.1.3.114  month
Use the month function to determine the month in which the given date falls.
 Syntax
month(<date1>)
Return value
int
The number from 1 to 12 that represents the month component of <date1>.
Where
<date1> The source date.
Details
 Example
Function Results
month(to_date('Jan 22, 1997', 'mon dd,
yyyy'))
1
month(to_date('3/97', 'mm/yy')) 3
6.1.3.115  num_to_interval
Use the num_to_interval function to convert a numeric value to an interval.
 Syntax
num_to_interval(<number1, format>)
Reference Guide
Data Services functions and procedures PUBLIC 1213
Return value
interval
The converted interval.
Where
<number1> The value of type int, real, decimal, or numeric to convert.
<format> A string describing the format of the interval. Choose from the following values:
D: Days
H: Hours
M: Minutes
S: Seconds
Details
 Example
Function Results
num_to_interval(elapsed_days, 'D') The value from the column elapsed_days converted to
an interval of days.
start_time +
num_to_interval(elapsed_seconds, 'S')
This example assumes that the function is acting on an input schema that contains at least the columns 'start_time'
and 'elapsed_seconds.' For example, the start_time might
be '2005-12-01 00:00:00' and elapsed_seconds might
be 200. The example indicates a time that is the number of elapsed seconds after the start time ('2005-12-01
00:03:20').
1214 PUBLIC
Reference Guide
Data Services functions and procedures
6.1.3.116  nvl
Use the nvl function to replace NULL values with a given value.
 Syntax
nvl(<expression1>, <replacement_value>)
Return value
Any type
The value of <expression1> if not NULL, otherwise, the value of <replacement_value>.
Where
<expression1> The value to be tested for NULL.
<replacement_value> The value to replace <expression1> if <expression1>
is NULL. Ensure that <replacement_value> is the same
data type as <expression1>.
Details
 Example
Function Results
nvl(modification_date, sysdate()) If the column modification_date for a row hasn't
been set, this function inserts the current date.
nvl(lookup(r3..vbpa, kunnr, 'NULL',
vbeln, vbak.vbeln, posnr, vbap.posnr,
parvw, 'RE'), lookup(r3..vbpa, kunnr,
'NULL', vbeln, vbak.vbeln, posnr,
vbap.posnr, parvw, 'RG'))
Both expressions are determined by the result of lookup
functions.
Reference Guide
Data Services functions and procedures PUBLIC 1215
6.1.3.117  power
Use the power function to return the value of the given expression to the specified power.
 Syntax
power(<num>, <num>)
Return Value
Float data type
Where
<num> Numeric expression representing a base number.
<num> Numeric expression representing the power.
Details
 Example
Function Results
power(2.2,3)); 10.648000
6.1.3.118  previous_row_value
Use the previous_row_value function to return the column value of the previous row.
 Syntax
previous_row_value(<expression>)
1216 PUBLIC
Reference Guide
Data Services functions and procedures
Return Value
Data type of the input parameter. First row always returns NULL.
Where
<expression> Valid Input expression.
Details
Each call to the previous_row_value() function returns the value stored during the previous call of this function.
If the function is not called for each row, the results of this function might not be what you expect because it
may not be the previous row value.
 Example
This scenario can happen for example, if you use the previous_row_value() inside an ifthenelse() function:
If_then_else (table1.status = 'new', 0 , previous_row_value(table1.value))
A better solution to the scenario is to use the following expression: If_then_else (table1.status =
'new', 0 , 1) * previous_row_value(table1.value)
Alternately, use two queries: One for the previous_row_value() and one for the final result including the
if_then_else().
 Example
The previous_row_value function is useful in Query transform. For example, the input stream of the column
might be 1;2;3;4 for the first four rows. The function returns NULL;1;2;3.
 Example
The following is a list of records of sales figures for a series of days. Each record lists the record number,
date, and revenue.
Date Revenue
rec 1 1/1/2005 1000
rec 2 1/2/2005 1100
rec 3 1/3/2005 900
rec 4 1/4/2005 1200
The requirement is to calculate the delta of the revenue with the previous day. So the query uses "order by
Date" and subtracts the previous row revenue from the current row revenue.
Results:
Date Revenue Delta = Revenue - Previous_Row_Value
Reference Guide
Data Services functions and procedures PUBLIC 1217
rec 1 1/1/2005 1000 NULL
rec 2 1/2/2005 1100 +100
rec 3 1/3/2005 900 -200
rec 4 1/4/2005 1200 +300
6.1.3.119  print
Use the print function to print a given string to the trace log.
 Syntax
print('<input_string>')
Return value
int
Value is <input_string> when the string contains valid data. Value is NULL and no string prints when the
string contains NULL data.
Where
<input_string> The message to be written to the trace log.
Details
 Example
Function Results
print('Reached decision point for
running full or incremental data
flows')
Writes "Reached decision point for running full or incremental flows" to trace log and returns <input_string>.
print('The date is: [$start_date]') Writes "The date is 2000.06.03" to trace log and returns
<input_string>.
1218 PUBLIC
Reference Guide
Data Services functions and procedures
Function Results
print('[$month_sal*12]') Writes "48000" to trace log and returns
<input_string>.
print('Total Sal is: [$month_sal*12]'); Writes "Total Sal is: 48000" to trace log and returns
<input_string>.
print('The return value from the SQL()
function is > [$y]');
Writes "The return value from the SQL() function is >
23456" to trace log and returns <input_string>.
6.1.3.120  pushdown_sql
Use the pushdown_sql function to create dynamic WHERE clauses.
 Syntax
pushdown_sql (<datastore>, <input_string>)
Return Value
None
Where
<datastore> The name of the datastore containing the data you want to
retrieve. Data Services creates a WHERE clause and pushes
it down to this database. Surround the datastore name by
single quotes.
<input_string> A character string that forms the WHERE clause. Surround the character string by single quotes. Typically, the
<input_string> is a column from another source to
the query, such as an XML message. Delimit columns or
parameters with curly braces. For example, {XML_IN.STATUS_QUERY}. If the string contains a curly brace, use the
backslash escape key to delimit the curly brace.
Reference Guide
Data Services functions and procedures PUBLIC 1219
Details
The pushdown_sql function allows you to create WHERE clauses that change based on data input. With the
pushdown_sql function, you do not prespecify the WHERE clause. The pushdown_sql function is particularly
useful in real-time jobs to select data based on input from an XML message.
Unlike other functions, the pushdown_sql function can be used only in the WHERE clause of a Query transform.
You cannot use the pushdown_sql function in other places, such as in a query mapping, in a conditional, or in a
script. Using the pushdown_sql function in the Query transform ensures that Data Services pushes the WHERE
clause that it creates from the function to the database.
Because Data Services does not parse the SQL contained in the input string, ensure that the input is well
formed with the correct syntax.
 Note
Data Services does not allow use of the backslash as an escape character to delimit curly braces within
the pushdown_sql function. If your input string contains a curly brace, ensure that the string is a variable.
Therefore, instead of entering 'a\{b\}c', pass your data through as 'a{$x}c' where $x = '\{b\}'.
 Example
You have a datastore named EC_DS that contains the table BIKES. BIKES stores information about different
bike models. The QUERY_REQUEST column in the XML_IN message contains requests for information from
this table. For example, a value in the QUERY_REQUEST column might be:
TYPE = 'MOUNTAIN' and PRICE < 1500
When you set up your real-time data flow, use the pushdown_sql function in a query to select data from
the BIKES table based on the data in the XML_IN message. Return the data in another XML message. The
following table shows the function and the results.
Function Results
pushdown_sql ('EC_DS',
'{XML_IN.QUERY_REQUEST}')
Data Services includes the following WHERE clause in the
SQL SELECT statement:
WHERE TYPE = 'MOUNTAIN' and PRICE <
1500
6.1.3.121  quarter
Use the quarter function to determine the quarter in which the given date falls.
 Syntax
quarter(<date1>)
1220 PUBLIC
Reference Guide
Data Services functions and procedures
Return value
int
The number from 1 to 4 that represents the quarter component of <date1>.
Where
<date1> The source date.
Details
 Example
Function Results
quarter(to_date('Jan 22, 1997', 'mon
dd, yyyy'))
1
quarter(to_date('5/97', 'mm/yy')) 2
6.1.3.122  raise_exception
Use the raise_exception function to generate an exception message for the Job Server error log..
 Syntax
raise_exception(<error_msg>)
Return Value
int
Always returns 1.
Reference Guide
Data Services functions and procedures PUBLIC 1221
Where
<error_msg> The string that the software writes to the Job Server error
log.
Details
If you surround the function with a try—catch block, the work flow or job may or may not terminate based on
how you set the block.
 Example
ifthenelse(sal < 1000000, 0, raise_exception('Salary exceeds 1 million 
dollars.'))
6.1.3.123  raise_exception_ext
Use the raise_exception_ext function generates an exception with an exit code.
 Syntax
raise_exception_ext(<error_msg>, <exit_code>)
Return Value
int
Always returns 1.
Where
<error_msg> The string that the software writes to the Job Server error
log.
1222 PUBLIC
Reference Guide
Data Services functions and procedures
<exit_code> If the exception is not caught in a try—catch block, the code
with which the job exits. Use a number in range 1 to 255
(zero means "success" to all operating systems).
Details
The software may or may not terminate the work flow or job may based on whether a try-catch block
surrounds the call.
 Example
ifthenelse(sal < 1000000, 0, raise_exception_ext('Salary exceeds 1 million 
dollars.', sal/1000000 + 1))
6.1.3.124  rand
Use the rand function to return a random number between 0 and 1.
 Syntax
rand()
Return value
real
The random number between 0 and 1.
 Example
Function Results
100 * rand() The function multiplies the random number by 100. The
result is a random number between 0 and 100.
Reference Guide
Data Services functions and procedures PUBLIC 1223
6.1.3.125  rand_ext
Use the rand_ext to return a random number between 0 inclusive and 1 exclusive.
 Syntax
real rand_ext(<seed>)
Return value
real
The random number. The return value is between 0 and 1.
Where
<seed> (Optional) Can be any positive integer greater than or equal
to 0. If unspecified, the software uses the current time to
create a seed.
Details
Similar to, and more powerful than the rand function. This function uses the linear-congruential generator
(LCG) algorithm:
x n = (ax n-1 + b)mod m where:
x n is an integer from 0 to m-1 and the initial value of x n is called the "seed" (x 0).
For each call to the random number generator, the software calculates a new x n by taking the value of the
previous result x n-1, multiplying by a, adding b, then taking the remainder mod m.
Data Services uses this formula to generate an integer from 0 to m-1. After Data Services calculates x n, it
divides that number by m to obtain a number equal to or greater than 0 and less than 1.
By specifying the same seed number, you can regenerate an exact number sequence. Specifying the same
seed number is useful in repeat experiments.
 Example
Function Results
100 * rand_ext() A random number between 0 and 100.
1224 PUBLIC
Reference Guide
Data Services functions and procedures
6.1.3.126  regex_replace
Use the regex_replace function to match a whole input string to a pattern that you specify with regular
expressions. The function flags and replaces the matching portion of the input string with a replacement string.
 Syntax
regex_replace(<input_string>, <regular expression pattern string>, 
<replacement string>, <regular expression processing flags>)
Return Value
String
Where
<input_string> String to be replaced. Supports UNICODE characters.
<regular_expression_pattern_string> Pattern you want to find in a whole input string. The function
does not support substring matches.
<replacement_string> String to replace the <input_string>.
<regular_expression_processing_flags> Allows you to specify additional behavior that you want to
occur while Data Services searches the input_string for pattern matches.
Enter NULL if you do not want to specify a flag. To specify
multiple flags, delimit each flag using commas. Specify flag
options in upper case.
Base the regular expression on the POSIX standard. For a list of valid regular expression pattern parameters,
operators, and flags, see match_regex [page 1202].
Reference Guide
Data Services functions and procedures PUBLIC 1225
Details
 Example
Function Results
regex_replace( ‘Accounting’, '\\[a-h\
\]','X', 'CASE_INSENSITIVE')
'XXXountXnX'
regex_replace(‘Accounting’, '\\[a-h\
\]', 'X')
'AXXoutXnX'
6.1.3.127  replace_substr
Use the replace_substr function to replace each occurrence of a specified substring with a different substring.
 Syntax
replace_substr(<in_str>, <search_str>, <replace_str>)
Return value
varchar
Where
<in_str> The input string that contains the substring to be changed. If
<in_str> is NULL, the software returns NULL.
<search_str> Substring to be replaced. If <search_str> is NULL, the
software returns the string in <in_str>.
<replace_str> Substring to use in place of <search_str>. If
<replace_str> is blank or NULL, the software removes all
occurrences of <search_str> from the <in_str>.
1226 PUBLIC
Reference Guide
Data Services functions and procedures
Details
 Example
Function Result
replace_substr('a penny saved is a
penny earned', 'penny', 'million')'
Replaces the word "penny" with "million."
'a million saved is a million earned'
6.1.3.128  replace_substr_ext
Use the replace_substr_ext function to replace each occurrence of a specified substring with a replacement
string. The specified substring can contain hexadecimals that refer to a UNICODE character, or non printable
character references such as form feed or new line.
 Syntax
replace_substr_ext(<in_str>, <search_str>, <replace_str>, 
<start_at_occurance>, <number_of_occurances>)
Return Value
varchar
Where
in_str The input string that contains the substring to be changed. If <in_str> is NULL, the
software returns NULL.
Reference Guide
Data Services functions and procedures PUBLIC 1227
search_str Substring to be replaced. If <search_str> is NULL, the software returns the string
in <in_str>.
You can use /x0000 to specify the hexadecimal value for a special character. For
example, if you use /x000A, then if Data Services encounters /x it converts the next
4 characters to a hexadecimal value. This function converts the hexadecimal value
to a UNICODE character. This option provides more flexibility when you use a search
string.
You can also represent special characters using the escape character '/'. The software supports the following characters:
/a Bell (alert)
/b Backspace
/f Formfeed
/n New line
/r Carriage return
/t Horizontal tab
/v Vertical tab
To include the escape character '/' in the search string, escape it using '//'. For
example, if the input is 'abc/de', Data Services converts search_str to 'abcde'. If
the input is 'abc//de', Data Services converts search_str to 'abc/de'.
If search_str is NULL, Data Services returns a varchar with the data in in_str.
replace_str Substring to use in place of <search_str>. If <replace_str> is blank or NULL, the
software removes all occurrences of <search_str> from the <in_str>.
start_at_occurrence Occurrence of the <search_str> with which to start replacing. If NULL, start at the
1st occurrence. For example, enter 2 to replace or remove the second occurrence of a
search_str.
number_of_occurrences Number of occurrences to replace. If NULL, replace all occurrences. For example,
enter 2 to replace or remove two sequential occurrences of the search_str.
1228 PUBLIC
Reference Guide
Data Services functions and procedures
Details
 Example
Function Result
replace_substr_ext('ayyyayyyayyyayyy',
'a', 'B', 2, 2)'
Replaces 'a' with 'B' starting from second occurrence and
replaces two occurrences.
'ayyyByyyByyyayyy'
replace_substr_ext('ayyya</n>yyya</
n>yyyayyy', 'a/n', 'B', 2, 2)
Searches a string containing 'a' followed by a new line;
replaces it with 'B' starting from second occurrence; replaces two occurrences.
'ayyyByyyByyyayyy'
replace_substr_ext('ayyya</n>yyya</
n>yyyayyy', 'a/x000a', 'B', 2, 2)
Searches a string containing 'a' followed by a new line;
replaces it with 'B' starting from second occurrence; replaces two occurrences.
'ayyyByyyByyyayyy'
6.1.3.129  repository_name
Use the repository_name function to return a database connection string and owner name.
 Syntax
repository_name()
Return Value
varchar
Details
For example, a return value of beq-local.DBUser is the ID for the repository from which the job is run.
 Example
print('Repository Name: [repository_name()]')
Reference Guide
Data Services functions and procedures PUBLIC 1229
6.1.3.130  restore_repserver_cdb_backlogged_transactions
Use the restore_repserver_cdb_backlogged_transactions function to restore backlogged transactions saved in
the Replication Server real-time CDC (changed data capture) datastore.
Syntax
restore_repserver_cdb_backlogged_transactions (tablespec, dataflowname, jobname)
Return values
int
0 = Recovery request is pending.
1 = Recovery request has been recorded and is processed by the CDC job when it finishes processing the
current changed dataset transactions.
Where
 Note
All parameters are mandatory and support global variables and substitution parameters.
1230 PUBLIC
Reference Guide
Data Services functions and procedures
<tablespec> Consists of <datastore>.<owner>.<table>.
Ensure that the datastore name is a valid Replication Server real-time CDC datastore. Values for
<owner> and <table> can have a wild card character *. Otherwise, ensure that the owner and table
that you specify in the parameter are imported to CDC datastore and executed to retrieve data from the
queue.
 Example
The following are example values for <tablespec>:
ORACLE_CDC_DATASTORE.PUBLISHER.BOOKS
ORACLE_CDC_DATASTORE.*.BOOKS
ORACLE_CDC_DATASTORE.PUBLISHER.*
ORACLE_CDC_DATASTORE.*.*
<dataflowname
>
Valid data flow name or wild card character *.
<jobname> Valid job name.
6.1.3.131  round
Use the round function to round a given number to a specified precision.
 Syntax
round(<num1>, <precision>)
Return value
decimal, double, int, or real
The rounded number using the same data type as the original number, <num1>.
Where
<num1> The source number.
<precision> An integer indicating the number of decimals in the result. If
<precision> is negative, the software rounds the digits left
of the decimal point.
Reference Guide
Data Services functions and procedures PUBLIC 1231
Details
 Example
Function Results
round(120.12345, 2) 120.12
round(120.12999, 2) 120.13
round(120, -2) 100
round(120.123, 5) 120.12300
6.1.3.132  rpad
Use the rpad function to pad a string of characters from a given pattern.
 Syntax
rpad(<input_string>, <size>, '<pad_string>')
Return value
varchar
The new string.
Where
<input_string> The source string.
<size> An integer value indicating the number of characters in the
resulting string.
<pad_string> A character or set of characters that this function concatenates to <input_string>.
1232 PUBLIC
Reference Guide
Data Services functions and procedures
Details
The function repeats the pattern at the end of the input string until the final string is the appropriate length. If
the input string is already longer than the expected length, the function truncates the string.
 Example
Function Results
rpad('Tanaka',15,' ') 'Tanaka '
rpad(last_name,25,' ') The value in the column last_name, padded with spaces
to 25 characters, or truncated to 25 characters.
6.1.3.133  rpad_ext
Use the rpad_ext function to pad a string with logical characters from a given pattern.
 Syntax
rpad_ext(<input_string>, <size>, '<pad_string>')
Return value
varchar
The new string.
Where
<input_string> The source string.
<size> An integer value indicating the number of characters in the
resulting string.
<pad_string> A logical character or set of logical characters that this function concatenates to <input_string>.
Reference Guide
Data Services functions and procedures PUBLIC 1233
Details
 Note
The logical characters prohibit this function from getting pushed down to an Oracle database.
The function repeats the pattern at the end of the input string until the final string is the appropriate length. If
the input string is already longer than the expected length, this function truncates the string.
 Example
Function Results
rpad_ext('Tanaka',15,' ') 'Tanaka '
rpad_ext(last_name,25,' ') The value in the column last_name, padded with spaces
to 25 characters, or truncated to 25 characters.
The rpad_ext and rpad functions exhibit the same behavior when the software evaluates the functions.
In situations where the function is pushed down to the database, the database behavior may differ when
<input_string> and—or <pad_string> parameters contain multibyte characters.
Function Input Output
rpad ("abc¶¶", 10,' ') 'abc¶¶ '
rpad_ext ("abc¶¶", 10,' ') 'abc¶¶ '
rpad ("abc¶¶", 10,'') 'abc¶¶'
rpad_ext ("abc¶¶", 10,'') 'abc¶¶'
rpad ("abcd", 10, '¶') 'abcd¶¶¶'
rpad_ext ("abcd", 10, '¶') 'abcd¶¶¶¶¶¶'
6.1.3.134  rtrim
Use the rtrim function to remove specified characters from the end of a string.
 Syntax
rtrim('<input_string>', '<trim_string>')
1234 PUBLIC
Reference Guide
Data Services functions and procedures
Return value
varchar
The modified string. The return type is the same as <input_string>.
Where
<input_string> The string to be modified.
<trim_string> The characters to remove from <input_string>.
Details
The function scans <input_string> from right to left removing all characters that appear in <trim_string>
until it reaches a character not in <trim_string>.
Removes trailing blanks only if <trim_string> contains trailing blanks. If the length of the modified string
becomes zero after trimming, the function returns '' (empty string).
To remove all trailing blanks in a string, use the rtrim_blanks function.
 Example
Function Results
rtrim('Marilyn ', ' ') 'Marilyn'
rtrim('ZABCABC', 'ABC') 'Z'
rtrim('ZABCABC', 'EFG') 'ZABCABC'
You may also use the rtrim_blanks or rtrim_blanks_ext functions for this.
6.1.3.135  rtrim_blanks
Use the rtrim_blanks function to remove blank characters from the end of a string.
 Syntax
rtrim_blanks(<input_string>)
Reference Guide
Data Services functions and procedures PUBLIC 1235
Return value
varchar
The modified string. The return type is the same as <input_string>.
Where
<input_string> The string to be modified.
Details
If the length of the modified string becomes zero after trimming, the function returns '' (empty string).
 Example
Function Results
rtrim_blanks('Marilyn ') 'Marilyn'
rtrim_blanks(last_name) The value contained in the column last_name with trailing blanks removed.
6.1.3.136  rtrim_blanks_ext
Use the rtrim_blanks_ext function to remove blank and control characters from the end of a string.
 Syntax
rtrim_blanks_ext(<input_string>)
Return value
varchar
The modified string. The return type is the same as <input_string>.
1236 PUBLIC
Reference Guide
Data Services functions and procedures
Where
<input_string> The string to be modified.
Details
If the length of the modified string becomes zero after trimming, the function returns '' (empty string).
 Example
Function Results
rtrim_blanks('Marilyn ') 'Marilyn'
rtrim_blanks(last_name) The value contained in the column last_name with trailing blanks and control characters removed.
6.1.3.137  sap_openhub_processchain_execute
Use the sap_openhub_processchain_execute function to start a process chain that extracts data from an
InfoProvider on SAP Business Warehouse (BW) and loads the extracted data into an Open Hub Destination
table. Monitors the process chain status and Open Hub Destination request notification.
 Syntax
sap_openhub_processchain_execute('<datastore>','<open_hub_table>',
'<process_chain>',<$logid>,<$ReturnTxt>)
Return value
varchar(1)
Returns one of the values described in the following table.
Return values
Return
value Description
B Open Hub Destination is being read by another user.
E Data Services error while executing the function.
Reference Guide
Data Services functions and procedures PUBLIC 1237
Return
value Description
R Process chain execution failed with errors in BW system.
X Process chain execution has been canceled in BW system.
S Function successfully executed the Open Hub extraction Data Transfer Process (DTP) and received extraction
request notification.
Where
<datastore> Specifies the datastore name. Specify either a constant
string or a substitution parameter.
The data type is varchar(256).
 Note
The maximum length depends on the Data Services repository type. For most repository types the maximum
length is 256, for MySQL the length is 64, and for MS
SQL server the length is 128.
<open_hub_table> Specifies the Open Hub Destination table. Specify either a
constant string or a substitution parameter.
The data type is varchar(30).
<process_chain> Specifies the name of the process chain that extracts data
from the InfoProvider in SAP BW and loads the data to the
Open Hub Destination table. Specify either a constant string
or a substitution parameter.
The data type is varchar(30).
<$logid > Optional. Specifies a variable to obtain a value that depends
on the function return value.
The required variable data type is varchar(25).
<$ReturnTxt> Optional. Specifies a variable to retrieve the description of
the return status of the process chain.
The required variable data type is varchar. You can define the
length for this variable.
Details
This function performs the following tasks:
1238 PUBLIC
Reference Guide
Data Services functions and procedures
• Starts the process chain that extracts data from an InfoProvider such as InfoArea, InfoCube, or DataStore
object on SAP BW.
• Loads the extracted data into an Open Hub Destination table.
• Monitors the process chain status.
• Monitors the Open Hub Destination request notification.
When the function returns successfully, an Open Hub table source in SAP Data Services reads the data from
the Open Hub Destination table.
 Note
Use this function only in a script. It is not valid in a query or audit object.
 Example
The following sample script commands check the return value, generate an exception, and print the error if
the function is not successful.
$status = sap_openhub_processchain_execute('open_hub_datastore',
'Materials','Materials_PC',<$lpcogid>, <$returntxt>); If ($status != 'S')
raise_exception ('Materials_PC process chain execution failed ' || $returntxt);
Limitations
The following are limitations for using Open Hub Destinations:
• Only one job at a time can read an Open Hub Destination table.
• A process chain of an Open Hub Destination can contain only one of its Data Transfer Processes (DTPs).
• A process chain cannot contain DTPs for more than one Open Hub Destination.
Related Information
Defining an sap_openhub_processchain_execute function
6.1.3.137.1  Relationship between return value and logid
variable value
The logid output variable depends on the sap_openhub_processchain_execute function return value.
The following table shows how the function return value relates to the other values in the function, and action
to take.
Reference Guide
Data Services functions and procedures PUBLIC 1239
Return value $logid variable value $ReturnText variable value Action
B Process chain log ID of another user who is currently
reading the Open Hub Destination.
Status of current Open Hub
extraction.
Either wait and try executing
the data flow again or stop
executing the data flow that
contains the Open Hub Destination table.
E Data Services error log number.
Data Services error text. Stop executing the data flow
that contains the Open Hub
Destination table and analyze
the Data Services error.
R Your process chain log ID. Error from process chain. Stop executing the data flow
that contains the Open Hub
Destination table and use the
log ID in the BW system to
see the detail state of the
process chain error.
X Your process chain log ID. Error from process chain . Stop executing the data flow
that contains the Open Hub
Destination table, and use
the log ID in the BW system
to see the detail state of the
process chain error.
S Open Hub extraction request
ID.
Status of your Open Hub extraction.
Use the request ID in the BW
system to obtain detail loading statistics (such as number of packets loaded and
number of records loaded).
6.1.3.138  sap_openhub_set_read_status
Use the sap_openhub_set_read_status function to send the read status for the Open Hub table to SAP
Business Warehouse (BW).
 Syntax
sap_openhub_set_read_status('<datastore>','<destination>',
<status>,<$returntxt>)
Return value
varchar(1)
A successful read status causes SAP BW to delete the data from the Open Hub Destination table. Returns one
of the following values.
1240 PUBLIC
Reference Guide
Data Services functions and procedures
Return value Description
S Success
E Error
Where
<datastore> Specifies the datastore name. Specify either a constant string or a substitution
parameter.
The data type is varchar(256).
 Note
The maximum length depends on the Data Services repository type. For most
repository types the maximum length is 256, for MySQL the length is 64, and
for MS SQL server the length is 128.
<destination> Specifies the Open Hub Destination in the BW system. Specify either a constant
string or a substitution parameter.
The data type is varchar(30).
<status> Specifies the read status. Possible values are either a variable or one of the following string constants:
• X for Read Successful
• Any other value indicates that the Read failed.
The data type is varchar(1).
<$returntxt> Optional. Specifies a variable to return the status log of the function.
The required variable data type is varchar. Define the length you want for this
variable.
Details
 Example
The following script sends the status of the Open Hub table read to the BW system and prints the status.
$status = sap_openhub_set_read_status('BR9", 'PS_BOOK_5', 'X', $returntxt):
print ('Status: ' || $status);
Reference Guide
Data Services functions and procedures PUBLIC 1241
6.1.3.139  search_replace
Use the search_replace function to perform a simple search and replace based on a string or ford value, or an
entire field.
 Syntax
search_replace([<sr_table_spec>,<search_column>,<replace_column>],<sr_type>,
[<case_sensitivity>],[<default_replace_value>],[<input_column_list>],
[<output_column_list>],[<output_variable_list>]) SET (...)
Return value
varchar
Where
<sr_table_spec> A constant string that specifies the search and replace table or file. Use one of the
valid forms:
• <Datastore.owner.table>: Specifies a database table containing the
search and replace values.
• <Datastore.owner.schema.table>: Specifies a database table containing
the search and replace values for Netezza 7.x multischema only.
• <Fileformat.filename>: Specifies a fixed or delimited file containing the
search and replace values.
• NULL: Use when the software performs the search and replace using custom
SQL or an internal table that you define in the SET options.
<search_column> Specifies the column name in the table or file containing the search values. If
<sr_table_spec> is an internal table, set <search_column> to NULL.
Varchar.
<replace_column> Specifies the column name in the <sr_table_spec> table or file containing the replacement values. If <sr_table_spec> is an internal table, set
<replace_column> to NULL.
Varchar.
1242 PUBLIC
Reference Guide
Data Services functions and procedures
<sr_type> Specifies the type of search and replace operation to perform. Use one of the
following values:
• 'SR_FIELD': Matches the entire contents of the search field and replaces
the entire contents of the search field.
• 'SR_WORD': Replaces only the word that matches the search value. Any
unmatched data remains in the search field. A word is a set of characters set
apart by whitespace.
• 'SR_STRING': Replaces only a specific substring of characters found next
to or between other characters in the search field. Any unmatched data remains in the search field.
<case_sensitivity> A value that indicates whether or not the search and replace operation is case
sensitive.
yes: Case sensitive
no: Not case sensitive
<default_replace_value> A varchar that specifies the default replacement value if the software does not fine
the search value.
The <default_replace_value> setting applies only when you set <sr_type> to
'SR_FIELD'.
<input_column_list> A varchar that specifies a comma-separated list of input expressions on which the
search and replace operation is performed.
<output_column_list> A varchar that specifies a comma-separated list of output columns.
<output_variable_list> A varchar that specifies a comma-separated list of output variables.
When you specify more than one output column in <output_column_list>, the
software uses the output variables to receive output returns. The software matches
variables and output columns by position.
This parameter is optional except when you specify more than one output column
in <output_column_list>.
SET options Specifies custom SQL or search and replace values in XML format.
 Example
For an internal search and replace table:
SET (
"internal_table"=
'<?xml version="1.0" encoding="UTF-8"?>
 <searchTable>
 <item>
 <Search><value></Search>
 <Replace><value></Replace>
 </item>
 ...
 ...
 </searchTable>
')
 Example
For custom SQL:
SET ( 
"external_custom_sql"= 
'<?xml version="1.0" encoding="UTF-8"?> 
 <database_datastore> 
 <datastore_name>
 </database_datastore> 
 <search_column> 
 <search_column_name>
 </search_column> 
 <replace_column> 
 <replace_column_name>
 </replace_column> 
 <SQLText>
 <custom_sql_string>
 </SQLText> 
')
Details
Specify search and replace values with an internal table, an existing external table or file, or with a custom SQL
command. In all cases, the software loads the search and replace values into memory to optimize performance
while performing the operation.
 Note
We recommend that you use the search_replace function as a function call in the query output and not
as a mapping in a column. By using it as a function call, you can use the wizard interface to fill in the
function parameters. You can also return to the wizard at any time to change the parameters. using
search_replace as a function call also allows you to create multiple output columns when you use multiple
input expressions. Using the function in a script or regular mapping is possible, but the syntax can be hard
to read and difficult to maintain.
1244 PUBLIC
Reference Guide
Data Services functions and procedures
 Note
The search_replace function wizard makes it easy to select search and replace columns, and if needed,
define search terms and replacement values.
 Example
Search for Mr in input_column and replace with M to output_column using an internal search and replace table.
search_replace(NULL,'SR_STRING',1,,'input_column','output_column',) SET (
"internal_table"='<?xml version="1.0" encoding="UTF-8"?>
 <searchTable>
 <item>
 <Search>Mr</Search>
 <Replace>M</Replace>
 </item>
 </searchTable>
)
Related Information
Defining a search_replace function
6.1.3.140  set_cdc_checkpoint
Use the set_cdc_checkpoint function to set a check point in a data flow for a Microsoft SQL Server changed
data capture (CDC) job.
 Syntax
set_cdc_checkpoint(<datastore>)
Return value
int
Returns 1 if successful, otherwise 0.
Reference Guide
Data Services functions and procedures PUBLIC 1245
Where
<datastore> The name of the CDC-enabled datastore containing the tables used to obtain the changes.
Details
Use the set_cdc_checkpoint function for data flows that run in a WHILE loop. The function retrieves changed
data for each iteration of the loop. Call this function for all the datastores used in all the data flows of the job.
 Example
set_cdc_checkpoint('MyCdcSource'); 
6.1.3.141  set_env
Use the set_env function to set a system environment variable to a specific value for the duration of a job.
 Syntax
set_env('<variable_name>', <variable_value>)
Return value
int
Returns 1 if successful, otherwise, 0.
Where
<variable_name> The name of an environment variable. Surround the name
with single quotes.
<variable_value> The value to assign to the environment variable. If the value
is text, surround the text by single quotes. Data Services
only sets the variable to this value for the duration of the
current job.
1246 PUBLIC
Reference Guide
Data Services functions and procedures
Details
Use the get_env and set_env functions to set and retrieve variables across operations in a job.
 Example
Function Results
set_env('TMP','C:\Data Services\Temp') Sets the value of the TMP environment variable to
"C:\Data Services\Temp" and returns a 1.
6.1.3.142  sleep
Use the sleep function to suspend the execution of the calling data flow or work flow.
 Syntax
sleep(<num_millisecs>)
Return Value
int
Always returns 1.
Where
<num_millisecs> The number of milliseconds to "sleep".
Details
Calling this function causes the thread that executes this function to halt operations for the given number of
milliseconds. To force a job to halt operations until a condition becomes true, call this function in a work flow,
not in a data flow.
Reference Guide
Data Services functions and procedures PUBLIC 1247
 Example
The following example invokes sleep for one second when a file exists in a directory called 'c'.
while (file_exists('c:/temp.msg') == 0)
begin
sleep(1000);
end
6.1.3.143  soundex
Use the soundex function to encode the input string using the soundex algorithm and return a string.
 Syntax
soundex(<input_str>)
Return Value
varchar(4)
Returns a string containing the soundex encoding of the input string. The return string length is always four
characters.
Where
<input_str> The source string to be encoded.
Details
Function results may vary when you push down to different database types.
Only use this function for input strings in English. Non-English characters are ignored.
The software ignores any invalid leading characters in the input string.
If an input string cannot be encoded, then the software returns '0000'.
1248 PUBLIC
Reference Guide
Data Services functions and procedures
 Example
Function Result
Print(soundex('Hello'); Prints the soundex of the word “Hello.”
$VAR=soundex(emp_name); Returns the soundex encoding for the string stored
in the variable emp_name and then assigns it to
$VAR
$VAR=soundex('1234567'); Returns '0000' because the input data is numeric.
6.1.3.144  sql
Use the sql function to run an SQL operation against tables in the specified database.
 Syntax
sql(<datastore, sql_command>)
Return value
varchar(1020)
Keep in mind the following results if you assign the value returned to a variable:
• If <sql_command> is a SELECT statement, the return value is the first row value of the first column.
• If <sql_command> is not a SELECT statement, the return value is NULL.
Where
<datastore> A string containing the name of the datastore where the tables involved in the SQL operation
reside. This name is the name you specified when you created the datastore in Data Services.
Include this string in single quotation marks.
Reference Guide
Data Services functions and procedures PUBLIC 1249
<sql_command> A string containing the text of the SQL command to execute. Enclose the string in single
quotation marks. If the string contains quoted values, make the internal quotation marks
single quotation marks preceded by the backslash (\) escape character.
Data Services makes column and table names uppercase when sending the <sql_command>
to Oracle to resolve. To specify a lowercase column or table name from an Oracle database,
enclose the name with double quotation marks (").
Details
 Example
Function Results
sql('source_ds',
'SELECT EmpID FROM Emp WHERE sal > 
100000')
Runs the SQL command against the database connected
through the datastore source_ds.
sql('source_ds','SELECT 
customer.LastName 
FROM customer 
WHERE customer.State = \'CA\'')
Returns the last names of the customers in California
from the customer table. Note that the quotation marks
around the state value require a backslash to indicate
that the single quotation marks are considered part of the
<sql_command> string.
sql('oracle_ds', ('SELECT 
"start_timestamp" 
FROM "status_table" 
WHERE "extract_name" = 
\'DF_RecoverDim\' 
AND "stop_timestamp" = NULL')
Returns the timestamp from a status table for the completed data flow. An Oracle datastore requires double
quotation marks around the lowercase column and table
names.
$start_date=sql('warehouse_ds',
'SELECT finish_timestamp 
FROM time_table 
WHERE table_name= "Component_Orders" 
');
In this script example, because the function returns a varchar value, it is not possible to assign the return value to
a date variable directly. Modify your statement to the next
example.
$temp_char=sql('warehouse_ds', 
'SELECT finish_timestamp FROM 
time_table 
WHERE table_name= "Component_Orders" 
');
$start_date=to_date($temp_char,'ddmon-yyyy');
This script example assumes the database returns the
date in dd-mon-yyyy format. If you are unsure of the
format the database returns, then force it to return the
date in a specific format by doing a conversion. To accomplish this, use the to_char function in Oracle or the convert
function in MS SQL.
1250 PUBLIC
Reference Guide
Data Services functions and procedures
6.1.3.145  sqrt
Use the sqrt function to return the square root of the given expression.
 Syntax
sqrt(<num>)
Return Value
Float
Where
<num> The number for which you want the square root.
Details
Return value is NULL if the input is negative.
 Example
Function Results
sqrt(625.25); 25.005000
6.1.3.146  smtp_to
Use the smtp_to function to capture the specified number of lines in the trace and error logs, package the
information into an e-mail, and send it to the recipients using an SMTP server.
 Syntax
smtp_to(<recipients_list>, <subject>, <message>, <number_of_trace_lines>, 
<number_of_error_lines>)
Reference Guide
Data Services functions and procedures PUBLIC 1251
Return value
int
Returns 0 if function succeeds. Returns a non-zero integer if function fails.
Where
<recipients_list> Required. A string containing one or more recipient e-mail addresses separated by commas (,).
Ensure that you enter valid, qualified e-mail address information.
<subject> Optional. A string containing the subject of the e-mail.
<message> Optional. A string containing the e-mail message.
<number_of_trace>
<_lines>
Required. The number of lines from the end of the trace log file to append to the end of the
e-mail.
<number_of_error>
<_lines>
Required. The number of lines from the end of the error log file to append at the end of the
e-mail.
Details
Use the smtp_to function in a script. For example, use the function in a conditional clause, while loop, or
try-catch block.
 Note
The smtp_to function does not support nicknames.
 Example
The following example goes to one recipient, admin@company.com.
$myvar = smtp_to('admin@company.com', 'Out of memory error in the SalesFact 
job. Please fix the error before running recovery job.',' ',10, 10) 
 Example
The following message goes to two recipients, admin@company.com and manager@company.com. The job
name and data flow names are included in the text of the message as variables. Note that Data Services
trims blank spaces from the end of strings; this example includes a blank on the beginning of the next
string. You can also concatenate a string with a single blank.
1252 PUBLIC
Reference Guide
Data Services functions and procedures
In the script, type $a = ; where $a is the local integer variable defined in the work flow. Put the cursor
just ahead of the semicolon before clicking the Functions button to construct a smtp_to statement.
$myvar = smtp_to('admin@company.com, manager@company.com', 'Out of memory 
error:' || systime(), 'Out of memory error while running the data flow:' || 
$dataflow_name || ' in the job:' || $job_name || '.', 10, 20) 
 Example
The smtp_to function also supports global variables. This example from a script shows the smtp_to
function substituting the values from global variables.
$address_list = 'nkumar@businessobjects.com,pkulkarn@businessobjects.com';
$subject_text = 'Testing SMTP job smtp011';
$message_text = 'The job smtp011 has the following trace lines & errors';
$trace_log = 8;
$error_log = 19;
$smtp_output = 9;
print ('before execution :- ' || $smtp_output);
$smtp_output = smtp_to($address_list,$subject_text,$message_text,
$trace_log,$error_log);
print ('after execution :- ' || $smtp_output);
 Example
Use smtp_to in any user-defined custom function and invoke it in a script.
Create a custom function my_smtp that contains the following:
begin return(smtp_to('nkumar@ness-gsg.com','Testing job smtp012','Test 
message of smtp012 job',4,5)); End
Use the custom function my_smtp in a script as follows:
print('before smtp :- '); my_smtp( ); print('after smtp :- '); 
Related Information
Defining and enabling the smtp_to function
6.1.3.147  string_to_number
Use the string_to_number function to return the integer sum of all characters from the input string.
 Syntax
string_to_number(<input string>)
Reference Guide
Data Services functions and procedures PUBLIC 1253
Return Value
Int
Details
Returns the integer sum of all characters from the input string. Input string size is limited to 4000 characters.
 Example
Function Results
string_to_number('SAP') 228
6.1.3.148  substr
Use the substr function to return a specific portion of a string starting at a given point in the string.
 Syntax
substr(<input_string>, <start>, <length>)
Return value
varchar
The modified string. The return data type is the <input_string>. If the length is a constant, then it is a
varchar of the given length.
Where
<input_string> The string to be modified.
1254 PUBLIC
Reference Guide
Data Services functions and procedures
<start> The position in the <input_string> where the function obtains the first character of the new
string. The function counts characters from the beginning of <input_string>.
• In normal data flows, the first character is position number 1.
• If <start> is 0, the new string begins with the first character (position 1).
• If <start> is negative, the function counts characters from the end of <input_string>.
The new string begins with the character in that position from the end of the string. The function
returns NULL or an empty string under the following circumstances:
• If <start> is greater than the number of characters in <input_string>, the function
returns NULL.
• If <length> is less than 1, the function returns an empty string.
<length> The number of characters in the resulting string.
• If <length> is 0 or negative, the function returns an empty string.
• If <length> is greater than the number of characters remaining in <input_string> after
<start> , the function returns only the remaining characters.
The function keeps the trailing blanks in the remaining <input_string> after <start>.
For information about how Data Services uses the substr function with HANA, see SAP Note 2808903 .
Details
 Example
Function Results
substr('94025-3373', 1, 5) '94025'
substr('94025-3373', 7, 4) '3373'
substr('94025', 7, 4) NULL
substr('Dr. Schultz', 4, 18) 'Schultz'
substr('San Francisco, CA',-4, 18) ', CA'
6.1.3.149  sum
Use the sum function to calculate the sum of a given set of values.
 Syntax
sum(<value_list>)
Reference Guide
Data Services functions and procedures PUBLIC 1255
Return value
decimal, double, int, or real
The total of the values. The return type is the same as the values in <value_list>.
Where
<value_list> The source values to sum.
Details
 Example
To calculate the sum of values in the salary column of a table, use the sum function in a query:
• In the Mapping tab of the query editor, enter:
sum(SALARY)
• In the Group By tab in the query editor, specify the columns for which you want to find the total salary,
such as the department column. For each unique set of values in the group by list, such as each unique
department, Data Services calculates the sum of the salary.
6.1.3.150  sysdate
Use the sysdate function to return the current date as listed by the system.
 Syntax
sysdate()
Return value
date
1256 PUBLIC
Reference Guide
Data Services functions and procedures
Today's date.
Details
Returns the current date as listed by the Job Server operating system.
 Note
The value that the sysdate function returns is a datetime value. Internally Data Services reads both the date
and the time when it runs a sysdate function. The data that is used by the job depends on the data type of a
particular column. For example, if the data type of a column in a query is date, Data Services only uses the
date for calculations. It ignores the time data. If you change the data type to datetime, Data Services uses
both a date and a time.
 Example
Function Results
isweekend(sysdate()) Tests whether today is a Saturday or Sunday.
to_char(sysdate(), 'yyyy.mm.dd') Converts the sysdate function datetime value to a
string that displays only the date.
Use this, for example, to exclude part of the datetime
data by providing only a format for the data to display in a
report.
To convert a datetime value to a string containing only
the date, use this expression and change the column data
type to varchar.
6.1.3.151  system_user_name
Use the system_user_name function to return the name of the user who logged onto the Job Server operating
system.
 Syntax
system_user_name()
Reference Guide
Data Services functions and procedures PUBLIC 1257
Return Value
varchar
Details
 Example
print('Starting execution of Job: [job_name()] as user: 
[system_user_name()]');
6.1.3.152  systime
Use the systime function to return the current time as listed by the system.
 Syntax
systime()
Return value
time
The current time.
Details
Returns the current time as listed by the Job Server's operating system.
1258 PUBLIC
Reference Guide
Data Services functions and procedures
 Example
Function Results
$timestamp = sql('my_datastore',
('UPDATE status_table SET 
job_start_time = \' '||
to_char(systime(),'hh24:mi:ss.ff'))||
'\'');
Updates the job_start_time column of the
status_table with the current time. It also formats the
time data.
to_char(systime(),'hh24:mi:ss.ff') Trims date data from the systime() function in cases
where it is added by default. Set the column that contains
this expression to the data type varchar.
The data type for a column that calls the systime() function should be time. If the data type is set to datetime,
Data Services will add the default date for the datetime
data type (1900:01:01) because systime() does not read
dates.
6.1.3.153  sysutcdate
Returns the current UTC date as listed by the operating system of the server where the Agent is installed.
 Note
The value that the sysutcdate function returns is a UTC datetime value. Internally Data Services reads both
the date and the time when it runs a sysutcdate function. The data that is used by the task depends on the
data type of a particular column. For example, if the data type of a column in a query is date, Data Services
only uses the date for calculations. The time data is ignored. If you change the data type to datetime, both
a date and a time are used.
 Syntax
sysutcdate()
Return value
date
Today's date.
Reference Guide
Data Services functions and procedures PUBLIC 1259
Example
Function Results
isweekend(sysutcdate()) Tests whether today (UTC) is a Saturday or Sunday.
to_char(sysutcdate(), 'yyyy.mm.dd') Converts the sysutcdate function's datetime value to a
string that displays only the date (UTC).
For example, you can use this to exclude part of the
datetime data by only providing a format for the data you
want to display in a report. To convert a datetime value
to a string containing only the date, use this expression and
change the column's data type to varchar.
6.1.3.154  table_attribute
Use the table_attribute function to retrieve the value of the specified table attribute.
 Syntax
table_attribute(<table_name, attribute_name>)
Return Value
varchar
The value of the table attribute. If the specified attribute does not exist, the software returns NULL.
where
<table_name> Enter the table name using the following format: datastore.owner.table. For Netezza
7.x multi-schema, use the following format:
datastore.owner.schema.table. If a valid table by
this name does not exist, the software returns NULL. This
parameter is case sensitive.
<attribute_name> The name of a table attribute. Valid attributes for a table are
listed in the applicable table Properties. This parameter is
case sensitive.
1260 PUBLIC
Reference Guide
Data Services functions and procedures
Details
 Example
Function Result
table_attribute('mssql.awez.CUSTOMER',
'Number_Of_Inserts')
'1788'
6.1.3.155  to_char
Use the to_char function to convert a date or numeric data type to a string.
 Syntax
to_char(<date or numeric_expression>,'<format>')
Return
varchar
A formatted string that describes the specified <numeric_expression>.
Where
<numeric expression> The source int, real, double, or decimal data value.
<format> A string indicating the format of the generated string.
 Note
Provide format to ensure correct results.
Choose from the codes listed in the following Format codes
table.
Reference Guide
Data Services functions and procedures PUBLIC 1261
Format codes
Format Description Example
9 Number.
Suppresses leading and trailing zeros
from the results.
Includes a leading minus sign (-) for
negative numbers or one leading space
for pos numbers.
to_char(123,'9999') = ' 123'
0 Number.
Includes leading and trailing zeros.
to_char(123,'09999') = ' 0123'
to_char(123,'9999D.00') = ' 123.00'
D<.|,> Sets position of decimal point followed
by character to use as decimal separator.
Currently the software supports only
dot (.) and comma (,) as decimal separators.
to_char(12.34,'99D.99') = ' 12.34'
G<.|,|space > Position of group separator followed by
character to be used as group separator.
Currently the software supports only
dot (.), comma (,), and space (' ') as
group separators.
to_char(1234,' 9G,999') = ' 1,234'
x Lower case "x."
String containing unsigned hexadecimal integer, using "abcdef". If the number is not 2 bytes long, the software
does not pad the output.
to_char(123,'xx') = ' 7b'
to_char(12,'x') = ' c'
X Upper case "X."
String containing unsigned hexadecimal integer, using "ABCDEF". If the
number is not 2 bytes long, the software does not pad the output.
to_char(123,'XX') = ' 7B'
to_char(12,'X') = ' C'
0 String containing unsigned octal integer. This option is not case-sensitive.
If the number is not 2 bytes long, the
software does not pad the output.
to_char(12,'oo') = ' 14'
to_char(1,'o') = ' 1'
1262 PUBLIC
Reference Guide
Data Services functions and procedures
Where
 Note
The to_char function supports the Oracle 9i timestamp data type up to 9 digits precision for sub-seconds.
<date> The source date, time, or datetime value.
<format> A string indicating the format of the generated string.
Choose from the following codes:
DD: 2-digit day of the month.
MM: 2-digit month.
MONTH: Full name of month.
MON: 3-character name of month.
YY: 2-digit year.
YYYY: 4-digit year.
HH24: 2-digit hour of the day (00-23).
MI: 2-digit minute (00-59).
SS: 2-digit second (00-59).
FF: Up to 9-digit sub-seconds.
Other values included in <format> appear unchanged in the
result.
Details
 Example
Function Results
to_char(call_date,
 'dd-mon-yy hh24:mi:ss.ff')
The date value from the call_date column formatted as a
string. Result:
28-FEB-97 13:45:23.32
The software reproduces the hyphens and spaces in the <format> parameter. The software recognizes
all the other characters as part of a parameter string from the Date string table and substitutes with
appropriate current values.
Reference Guide
Data Services functions and procedures PUBLIC 1263
6.1.3.156  to_date
Use the to_date function to convert an input string to a date type based on the input format.
 Syntax
to_date(<input_string>,'<format>')
Return value
date, time, or datetime
A date, time, or both representing the original string.
Where
<input_string> The source string.
<format> A string indicating the format of the source string. Choose from the following codes:
DD: 2-digit day of the month
MM: 2-digit month
MONTH: Full name of month
MON: 3-character name of month
YY: 2-digit year
YYYY: 4-digit year
HH24: 2-digit hour of the day (00-23)
MI: 2-digit minute (00-59)
SS: 2-digit second (00-59)
FF: Up to 9-digit sub-seconds
 Note
Ensure that you set a format. If you do not set a format, the results may be incorrect.
Details
If the input string has more characters than the format string, the software ignores the extra characters in the
input string and initializes to the default value.
1264 PUBLIC
Reference Guide
Data Services functions and procedures
 Example
The software converts the following expression but ignores and initializes the extra characters to zero in the
time part of the input string:
to_date('10.02.2007 13:25:45', 'DD.MM.YYYY') converts to 10.02.2007 00.00.00
This function also supports the Oracle 9i timestamp data type. Its precision allows up to 9 digits for subseconds.
 Example
Function Results
to_date('Jan 8, 1968', 'mon dd, yyyy') 1968.01.08 stored as a date.
6.1.3.157  to_decimal
Use the to_decimal function to convert a varchar to a decimal.
 Syntax
to_decimal('<in_str>','<decimal_sep>','<thousand_sep>',<scale>)
Return Value
decimal
Uses a precision of 28 and the given scale.
Where
<in_str> The number string. Null implies a NULL return. If <in_str>
is invalid, the software returns a 0.
<decimal_sep> The character that separates the decimal component from
the whole number component.
<thousand_sep> The character that separates thousands from hundreds in
the whole number component.
Reference Guide
Data Services functions and procedures PUBLIC 1265
<scale> The number of digits to the right of the decimal point in the
returned value.
Details
 Example
Function Result
to_decimal('99,567.99', '.', ',', 3) 99567.990
6.1.3.158  to_decimal_ext
Use the to_decimal_ext function to convert a varchar to a decimal and includes precision as a parameter.
 Syntax
to_decimal_ext('<in_str>','<decimal_sep>','<thousand_sep>',<precision>,<scale>
)
Return Value
decimal
Uses the given precision and scale.
Where
<in_str> The number string. Null implies a NULL return.
<decimal_sep> The character that separates the decimal component from
the whole number component.
<thousand_sep> The character that separates thousands from hundreds in
the whole number component.
1266 PUBLIC
Reference Guide
Data Services functions and procedures
<precision> The total number of digits in the returned value.
<scale> The number of digits to the right of the decimal point in the
returned value.
Details
The to_decimal_ext function supports the use of DECIMAL data types with up to 96 precision.
 Example
Function Result
to_decimal_ext('99,567.99', '.',
',',38,3)
99567.990
6.1.3.159  to_varchar
Use the to_varchar function to convert a date or numeric data type expression to a string.
 Syntax
to_varchar(<date_expression or numeric_expression>,'<format>')
Return value
varchar
Where
<date_expression> The source date, time, or date/time value. For example,
2010-01-11 00:00:00.
<numeric_expression> The source int, real, double, or decimal value. For example,
10.30 or -0.001.
Reference Guide
Data Services functions and procedures PUBLIC 1267
<format> Indicates the format of the generated string. Include a format to ensure correct results.
For applicable formats, see the Date formats table and the
Numeric formats table.
Details
The to_varchar function generates a string that describes either the specified <date_expression> or the
specified <numeric_expression> in the given numeric or data format specified in <format>.
For examples of the to_varchar function, see the Date formats table and the Numeric formats table.
Date formats for to_varchar function [page 1268]
Set an output format for the date expression in the to_varchar function.
Numeric formats for to_varchar function [page 1271]
Set an output format for the numeric expression given in the to_varchar function.
6.1.3.159.1  Date formats for to_varchar function
Set an output format for the date expression in the to_varchar function.
Use an applicable date format in the '<format>' portion of the to_varchar function to set the output format.
For simplicity, instead of including the entire date expression in the examples, we include the following
representations of the source date expression:
• D = 2010-01-11 00:00:00
• D1 = 2010-01-11 11:59:00
• D2 = 2010-01-11 23:59:59
The following table contains applicable date format values with descriptions and examples.
Date formats
Format Description Example
YYYY Outputs a four-digit year. Format is case
insensitive. to_varchar(D, 'YYYY') = 
'2010'
YY Outputs a two-digit year. Format is case
insensitive. to_varchar(D, 'YY') = 
'10'
MM Outputs a numeric month. Format is
case insensitive. to_varchar(D, 'MM') = 
'01'
1268 PUBLIC
Reference Guide
Data Services functions and procedures
Format Description Example
MONTH Outputs the month name. Format is
case-sensitive only for the first two
characters as follows:
• If the format starts with MO, the
function outputs a month name in
upper case.
• If the format starts with Mo, the
function outputs the month name
with the first letter capitalized.
• If the format starts with mo or mO,
the function outputs the month
name in lower case.
to_varchar(D, 'MONTH') 
= 'JANUARY'
to_varchar(D, 'Month') 
= 'January'
to_varchar(D, 'month') 
= 'january'
MON Outputs the three-character abbreviation for the month. Format is case-sensitive only for the first two characters as
follows:
• If the format starts with MO, the
function outputs a month abbreviation in upper case.
• If the format starts with Mo, the
function outputs a month abbreviation with the first letter capitalized.
• If the format starts with mo or mO,
the function outputs a month abbreviation in lower case.
to_varchar(D, 'MON') = 
'JAN'
to_varchar(D, 'Mon') = 
'Jan'
to_varchar(D, 'mon') = 
'jan'
DDD Outputs a three-digit value representing
the day of the year. Format is case insensitive.
to_varchar(D, 'DDD') = 
'011'
DD Outputs a two-digit value representing
the day of the month. Format is case
insensitive.
to_varchar(D, 'DD') = 
'11'
D Outputs the one-digit day value representing the day of the week, ranging
from 1 through 7. Format is case insensitive.
to_varchar(D, 'D') = '1'
Reference Guide
Data Services functions and procedures PUBLIC 1269
Format Description Example
DAY Outputs the name of the day. Format
is case sensitive for only the first two
characters as follows:
• If the format starts with DA, the
function outputs the day in upper
case.
• If the format starts with Da, the
function outputs the day with the
first letter capitalized.
• If the format starts with da or dA,
the function outputs the day in
lower case.
to_varchar(D, 'DAY') = 
'MONDAY'
to_varchar(D, 'Day') = 
'Monday'
to_varchar(D, 'day') = 
'monday'
AM, PM Outputs the given hour with AM or PM.
• If the given hour is before noon,
outputs AM.
• If the given hour is after noon, outputs PM.
The function is case-sensitive, and outputs value using the input case.
to_varchar(D, 'PM') = 
'AM'
to_varchar(D1, 'AM') = 
'AM'
to_varchar(D2, 'am') = 
'am'
to_varchar(D, 'aM') = 
'aM'
HH12, HH Outputs an hour between 1 and 12.
to_varchar(D2, 'HH12') 
= '11'
to_varchar(D2, 'HH') = 
'11'
HH Outputs an hour between 0 and 23.
to_varchar(D2, 'HH24') 
= '23'
MI Outputs the minutes in the given hour
from 0 through 59. to_varchar(D2, 'MI') = 
'59'
SS Outputs the seconds in the given minute from 0 through 59. to_varchar(D2, 'SS') = 
'59'
1270 PUBLIC
Reference Guide
Data Services functions and procedures
Format Description Example
FF Outputs the milliseconds in the given
second, excluding the number of subseconds.
to_varchar(D, 'FF') = 
'000000000'
 Note
In the example we didn’t set milliseconds, therefore, the value is zeros.
Other characters Outputs the replicated character in the
specified position. to_varchar(D, 'dd/mm/
yyyy') = '11/01/2010'
Parent topic: to_varchar [page 1267]
Related Information
Numeric formats for to_varchar function [page 1271]
6.1.3.159.2  Numeric formats for to_varchar function
Set an output format for the numeric expression given in the to_varchar function.
Use an applicable numeric format code in the '<format>' portion of the to_varchar function as described in
the following table.
Numeric formats
Format Description Example
9 Outputs a number in the specified position. If there’s no number in the source
for this position, the function outputs a
blank.
This format is repeatable.
to_varchar(100, 
'9999.00') = '100.00'
0 Outputs a number in the specified position. If there’s no number in the source
for this position, the function outputs a
zero.
This format is repeatable.
to_varchar(100, 
'0000.00') = '0100.00'
Reference Guide
Data Services functions and procedures PUBLIC 1271
Format Description Example
S Outputs a positive or negative symbol in
the specified position.
• Outputs a “+” for a positive number
• Outputs a “-” for a negative number
to_varchar(100, 
'S0000.00') = '+0100.00'
E Outputs the source numeric expression
divided into the significant part and the
exponent part.
to_varchar(-0.001, 
'S0.0E00') = '-1.0E-03'
% Outputs the result of multiplying the
source number by 100 and adds a percent symbol at the end of the output.
to_varchar(10.30, 
'S9.9%') = '+1030.%'
· Outputs the source numeric expression
with a period inserted in the specified
position.
to_varchar(1, '00.00') 
= '10.00'
Other characters Outputs the source numeric expression
with the character in the specified positon.
to_varchar(1000, 
'$9,999.99') = '$1,000.'
Parent topic: to_varchar [page 1267]
Related Information
Date formats for to_varchar function [page 1268]
6.1.3.160  to_WKT_point
Use the to_WKT_point function to convert latitude and longitude to a geometry point in Well Known Text (WKT)
format.
 Syntax
to_WKT_point (x, y)
1272 PUBLIC
Reference Guide
Data Services functions and procedures
Return value
Long
Point data that represents the location on a map for the given latitude and longitude.
Where
<x> Latitude
<y> Longitude
The software issues an error if the input latitude and longitude fields are not in one of the following formats:
• Decimal
• Integer
• Float
• Double
Details
The software outputs point data using geometry data type. You can upload the data objects to your external
spatial data, such as a shapefile. This function is limited to loading data to SAP HANA.
The return value represents a point on the map based on the decimal latitude and longitude from your input
data. The software outputs the WKT point information as long data type. Long data type provides enough
space so that the software does not truncate the WKT point information.
 Example
Input:
x = 3
y = 6
Output:
POINT (3 6)
Reference Guide
Data Services functions and procedures PUBLIC 1273
6.1.3.161  total_rows
Use the total_rows function to return the number of rows in a spcified table in a datastore.
 Syntax
total_rows(<datastore.owner.table_name>)
For a Netezza 7.x multischema datastore:
total_rows(<datastore.owner.schema.table_name>)
For a memory datastore:
total_rows(<datastore..table_name>)
Return value
int
The number of rows in the table.
Where
<datastore> The name of the datastore containing the table.
<owner> The name of the datastore owner. Not applicable for memory tables.
<schema> The name of the datastore schema. Applicable only for Netezza 7.x datastore.
<table_name> The name of the database table or memory table containing
the rows you want to count.
1274 PUBLIC
Reference Guide
Data Services functions and procedures
Details
 Example
Function Results
total_rows (ora_ds.scott.emp_table) Retrieves the total number of rows from an Oracle table.
total_rows (mem_ds..bigtable) Retrieves the total number of rows from a memory table.
6.1.3.162  translate
Use the translate function to translate selected characters of an input string into other specified characters.
 Syntax
translate(<input string>, <from string>, <to string>) 
Return Value
String
Returns the input string translated in the following way: The software replaces all occurrences of each
character in the <from string> with the corresponding character in the <to string>.
Where
<input string> The string to be translated.
<from string> The characters to be replaced from the <input string>.
• The software does not replace the characters in the
<input string> that are not in the <from string>.
• The software removes the characters in the <from
string> that do not have a corresponding character
in the <to string> from the <input string>.
<to string> The corresponding characters to replace the characters in
<from string>.
Reference Guide
Data Services functions and procedures
Details
If the <from string> or <to string> is null, then the software returns null. This function is case sensitive
with parameter values.
 Example
Function Results
translate(‘Business
Objects’,’sne’,’xyz’)
'Buxiyzxx Objzctx'
translate(‘Business Objects’,’st’,’x’) 'Buxinexx Objecx'
translate(‘Business Objects’,’s’,’’) 'Buine Object'
translate(‘Business
Objects’,’abcd’,NULL)
NULL
6.1.3.163  trunc
Use the trunc function to truncate a given number to the specified precision without rounding the value.
 Syntax
trunc(<num1>, <precision>)
Return value
decimal, double, int, or real
The truncated number. The return type is the same as the original number, <num1>.
Where
<num1> The source number.
<precision> An integer indicating the number of decimals in the result.
If <precision> is negative, digits to the left of the decimal
point are truncated and the value is padded with zeros.
1276 PUBLIC
Reference Guide
Data Services functions and procedures
Details
 Example
Function Results
trunc(120.12345, 2) 120.12
trunc(120.12999, 2) 120.12
trunc(180, -2) 100
trunc(120.123, 5) 120.12300
6.1.3.164  truncate_table
Use the truncate_table function to explicitly expunge data from a memory table or truncate physical files used
for a persistent cache table.
 Syntax
trunc(<ds..tab_name>)
Return value
int
The return value is always 1.
Where
<ds> The datastore containing the memory table or persistent
cache table.
<tab_name> The name of the memory table from which you want to expunge data or the name of the persistent cache table from
which you want to truncate physical files.
Reference Guide
Data Services functions and procedures PUBLIC 1277
Details
With regard to memory tables, this function provides finer control than the active job has over your data and
memory usage. Use this function with memory tables and persistent cache tables.
 Example
Function Results
truncate_table (ds..bigtable) Truncates rows from the memory table or persistent_cache table.
Usage scenarios
The following scenarios show some situations in which you use the truncate_table function.
1. A data flow in your job creates a persistent cache table. You can use the persistent cache table in
subsequent data flows within the job by using the lookup_ext function, for example.
Add a custom function and include the truncate_table function. Set the truncate_table function to remove
the persistent cache table after running all data flows within the job.
2. Create a job that includes a script to clean up all unused persistent cache tables. When run, the job
truncates your physical files, which frees disk space.
6.1.3.165  upper
Use the upper function to change the characters in a string to uppercase.
 Syntax
upper(<value>,'<locale>')
Return value
varchar
The uppercase string. The return type is the same as <value>. The software does not change the characters
that are not letters.
1278 PUBLIC
Reference Guide
Data Services functions and procedures
Where
<value> The string to be modified.
<locale> Optional. A locale to which the function converts the string.
 Note
The software supports ISO 639 language code and ISO 3166 country code
formats.
Details
 Example
Function Results
upper('Accounting101') 'ACCOUNTING101'
upper(substr(LastName,1,1))|
lower(substr(LastName,2,LENGTH(LastName
)))
The value in column LastName with the first letter uppercase and the rest of the value lowercase. Note that this
example does not account for last names with two words.
upper(LastName, 'tr') The value in column LastName is converted to all uppercase. It is also converted to the Turkish locale, using the
ISO 639 language code.
6.1.3.166  utc_to_local
Use the utc_to_local function to convert an input that is in Coordinated Universal Time (UTC) to the set time
zone value.
 Syntax
utc_to_local(<input datetime>, <timezone to convert with UTC offset>) 
Return Value
datetime
Reference Guide
Data Services functions and procedures PUBLIC 1279
Details
Converts the input in UTC to the desired time zone value. The second parameter UTC offset is a constant value.
If the UTC offset is not provided, then the software uses the time zone of the job server host to calculate the
UTC offset.
 Example
Function Results
utc_to_local(‘2014.01.31 15:30:00’,
‘UTC+08:30’)
'2014.02.01 00:00:00'
6.1.3.167  varchar_to_long
Use the varchar_to_long function to convert a data type value of a given column from varchar to long.
 Syntax
varchar_to_long(<column_name>)
Return value
long
Where
<column_name> The name of the table column for which you want to convert
a data type from varchar to long.
Related Information
XML extraction and parsing for columns
1280 PUBLIC
Reference Guide
Data Services functions and procedures
6.1.3.168  wait_for_file
Use the wait_for_file function to look for a specified file pattern in a file system, polling for the file at intervals,
until the job timeout is reached.
 Syntax
wait_for_file (file_name_pattern, timeout, poll_interval,max_match, file_name_list, list_size, list_separator)
Return Values
int
Values are:
• 0 - No file matched.
• 1 - At least one file is matched.
• -1 - Timed out.
• -2 - At least one input value is illegal.
Where
<file_name_pattern> The file name and path, relative to where the Job Server is running. It can be an absolute
or relative path. File name can contain wildcard characters.
<timeout> Wait timeout in milliseconds.
• If timeout is 0, then the function doesn’t block.
• If timeout is -1, then the function waits indefinitely for at least one file to exist that
matches the file pattern.
If you enter any other negative value, the software considers it illegal.
On a computer where millisecond timing accuracy isn’t available, timeout is rounded up
to the nearest legal value available on that system.
<poll_interval> Polling interval in milliseconds to look for the existence of the file. On a computer where
millisecond timing accuracy isn’t available, the polling interval is rounded up to the nearest legal value available on that system. If the poll interval exceeds the timeout value,
then, it is rounded up to time out value.
<max_match > Optional. Specifies the maximum number of matched file names that the function returns. The default value is 0. -1 specifies that the function return all the matched file
names.
Reference Guide
Data Services functions and procedures PUBLIC 1281
< file_name_list > Optional. Output varchar variable that returns the list of matched file names. Order of
the file names in the list is determined by the way the operating system returns the file
names.
< list_size> Optional. Output integer variable that returns the list size.
<list_separator> Optional. File name list separator character(s). Default value is comma (,).
Details
This function looks for the specified file pattern in the file system. If it doesn’t find the file(s), it waits for
the specified timeout period, polling for the file(s) at every polling interval. The value specified in poll_interval
determines how often to poll for the file pattern until timeout is reached. After timeout, the job stops, and
polling for the file ceases.
This function waits a maximum of up to timeout interval for at least one file to exist that matches the pattern.
Poll interval determines how often to poll for files.
Example
Use this function in a script at the beginning of a job. When you execute the job, the job suspends until it finds
the specified file. A job stays suspended until the file is present, as shown in the following business use case.
During the night, an external process puts source files in a file system that the system can access. The process
is usually complete at 1:00 AM or later. Tonight, however, you schedule the job to start at 1:00 AM. You include a
script in the first step of the job that checks for the existence of the last file. If the last file doesn’t exist, the job
waits for an interval of time and tries again. Once the file is present, the job finds the file and continues with the
rest of the process. You set a timeout so that the job stops if the file is still not found at 9:00 tomorrow morning.
6.1.3.169  week_in_month
Use the week_in_month function to determine the week number of the month in which the given date falls.
 Syntax
week_in_month(<date1>)
Return value
int
1282 PUBLIC
Reference Guide
Data Services functions and procedures
The number from 1 to 5 that represents which week in the month that <date1> occurs.
This function considers the first week of the month to be first seven days. The day of the week is ignored when
calculating the weeks.
Where
<date1> The source date.
Details
 Example
The following examples use the to_date function to convert the input date to a date type.
Function Results
week_in_month(to_date('Jan 22, 1997',
'mon dd, yyyy'))
4
week_in_month(to_date('Jan 21, 1997',
'mon dd, yyyy'))
3
6.1.3.170  week_in_year
Use the week_in_year function to return the week in the year in which the given date falls.
 Syntax
week_in_year(<inputdate>,'<weektype>')
Return value
int
Returns from 1 to 53.
Reference Guide
Data Services functions and procedures PUBLIC 1283
Where
<inputdate> The source date
<weektype> Optional.
This function returns the week in the year in two ways based
on your setting:
• 'WW' - Absolute week number of the given date.
• 'IW' - ISO week number of the given date.
Details
Consider the following information when you use this function:
• This function considers the first week of the year to be the first seven days when it determines the absolute
week number.
• Under the ISO standard, a week always begins on a Monday, and ends on a Sunday.
• The first week of a year is that week which contains the first Thursday of the year.
• An ISO week number may be between 1 and 53.
• Under the ISO standard, week 1 always has at least 4 days.
• If 1-Jan falls on a Friday, Saturday, or Sunday, the first few days of the year are defined as being in the last
(52nd or 53rd) week of the previous year.
 Example
Some business applications use week numbers to categorize dates. For example, a business may report
sales amounts by week, and identify each period as "9912", representing the 12th week of 1999. An ISO
week is more meaningful than an absolute week for such a purpose.)
Following are more example results for week_in_year applied to three different input dates:
Function Results
week_in_year(to_date('Jan 01,
2001','mon dd, yyyy'))
1
week_in_year(to_date('2005.01.01',
'yyyy.mm.dd'),'WW')
1
week_in_year(to_date('2005.01.01',
'yyyy.mm.dd'),'IW')
53
1284 PUBLIC
Reference Guide
Data Services functions and procedures
6.1.3.171  WL_GetKeyValue
Use the WL_GetKeyValue function to return the value of a given keyword in Web log search strings.
 Syntax
WL_GetKeyValue(<string>, <keyword>)
Details
 Example
If you search for BusinessObjects on Google, the following appears in a Web log:
GET "http://www.google.com/search?
hl=en&lr=&safe=off&q=BusinessObjects&btnG=Google+Search"
WL_GetKeyValue('http://www.google.com/search?
hl=en&lr=&safe=off&q=BusinessObjects&btnG=Google+Search','q') 
returns 'BusinessObjects'.
6.1.3.172  word
Use the word function to return one word out of a given string.
 Syntax
word(<input_string>, <word_num>)
Return value
varchar
A string containing the indicated word. The return type is the same as <input_string>.
Where
<input_string> The source string.
Reference Guide
Data Services functions and procedures PUBLIC 1285
<word_num> A nonnegative integer specifying the index of the target word
in the string. The first word in a string is word number 1.
If <word_num> is 0 or greater than the number of words in
<input_string>, then the word function returns a NULL
string.
Details
A word is defined to be any string of consecutive non-white space characters terminated by white space, or the
beginning and end of <input_string>. White space characters are the following:
• Space
• Horizontal or vertical tab
• Newline
• Linefeed
 Example
Function Results
word('Accounting Department', 1) 'Accounting'
word('Accounting', 1) 'Accounting'
word('Accounting', 2) NULL
6.1.3.173  word_ext
Use the word_ext function to return a word that you identify by a position in a delimited string.
 Syntax
word_ext('<string>', <word_num>, '<separator(s)>')
Return value
varchar
A string containing the indicated word. Return type is the same as <string>.
1286 PUBLIC
Reference Guide
Data Services functions and procedures
Where
<string> The source string.
<word_num> A nonnegative integer specifying the index of the target word
in the string. The first word in a string is word number 1.
If <word_num> is 0 or greater than the number of words in
<string>, then the word function returns a NULL string.
<separator(s)> Any character specified.
The function considers a word to be:
• Any string of consecutive characters, not including white spaces
• String of characters terminated by white space or the beginnning and end of <string>.
The function considers white space characters to be:
• Space
• Horizontal or vertical tab
• Newline
• Linefeed
Details
This function is useful for parsing Web log URLs or file names.
 Example
Function Results
word_ext('www.sap.com',2,'.') 'sap'
word_ext('www.cs.wisc.edu', -2, '.') 'wisc'
A negative word number, -2 in the example, means the
function counts from right to left.
word_ext('www.cs.wisc.edu', 5, '.') NULL
word_ext('aaa+=bbb+=ccc+zz=dd', 4,
'+=')
'zz'
If 2 separators are specified (+=), the function looks for
either one.
word_ext(',,,,,aaa,,,,bb,,,c ', 2, ',') 'bb'
This function skips consecutive delimiters.
Reference Guide
Data Services functions and procedures PUBLIC 1287
6.1.3.174  workflow_name
Use the workflow_name function to reurn the name of the current work flow.
 Syntax
workflow_name()
Return Value
varchar
Details
In cases where several work flows enclose this function, the function returns the name of the inner most work
flow. If the function does not find a work flow, it returns the job name.
 Example
print('Work Flow Name: [workflow_name()]')
6.1.3.175  year
Use the year function to determine the year in which the given date falls.
 Syntax
year(<date1>)
Return value
int
The number that represents the year component of <date1>.
1288 PUBLIC
Reference Guide
Data Services functions and procedures
Where
<date1> The source date.
Details
 Example
Function Results
year(to_date('Jan 22, 1997','mon dd,
yyyy'))
1997
year(to_date('03/97', 'mm/yy')) 1997
year(to_date('03/19', 'mm/yy')) 2019
6.2 Data Services procedures
SAP Data Services supports stored procedures, which are executable objects or named entities that you store
in a database.
A stored procedure is one or more precompiled SQL statements. By calling a stored procedure from within
Data Services, you can call business logic that you have already coded. The ability to use your existing business
logic enables you to quickly and conveniently develop data extraction and data management tasks. You can
also use stored procedures for the following purposes:
• Maintain business logic rules and provide a single point of control to ensure rules are accurate and
enforced
• Reduce network overhead with client/server applications. The software stores procedures on the database
server and retains compiled execution plans for procedures in the data dictionary.
Data Services supports using stored procedures for the following databases:
• DB2
• ODBC
• Oracle
• Microsoft SQL Server
• SAP HANA
• SAP SQL Anywhere
• SAP ASE
• SAP Sybase IQ
Reference Guide
Data Services functions and procedures PUBLIC 1289
• Teradata
Call stored procedures from the jobs you create and run in Data Services.
Stored procedures must exist in the database before you can use the procedure in Data Services. Create a
stored procedure in a database using the client tools provided with the database, such as Oracle SQL *Plus.
After it is created, users who have execution permissions for procedures can call the stored procedure. After
you import a stored procedure into Data Services, use stored procedures like functions in Data Services jobs.
Stored procedures include parameters. Each parameter has the following elements:
• Name
• Data type
• Mode such as IN, INOUT, or OUT
A stored procedure can use a NULL or default parameter value for its input and can produce more than one
output parameter value.
For complete information about working with procedures, see the Designer Guide.
1290 PUBLIC
Reference Guide
Data Services functions and procedures
7 Data Services scripting language
Use the SAP Data Services scripting language to write scripts, custom functions, and expressions. also known
as user-script functions. Further, you can use the scripting language to write expressions such as complex
column mapping expressions and WHERE clause conditions.
Custom functions are also known as user-script functions. Further, use the scripting language to write
expressions such as complex column mapping expressions and WHERE clause conditions.
The software uses the scripting language internally to save objects that you create into repository tables.
Export saved objects to a file with the .atl extension. Later import the file to another repository. You export
and import objects for such tasks as migrating to a new environment or backing up a repository before an
upgrade.
SAP scripting language operators [page 1291]
Operators act like functions but the are symbols that specify the action the function takes.
SAP scripting language keywords [page 1293]
Keywords are select words in the scripting language that you use in expressions based on syntax rules
and desired behavior.
7.1 SAP scripting language operators
Operators act like functions but the are symbols that specify the action the function takes.
The following table contains descriptions of the operators that you use in scripts and expressions. The table
lists the operators in order of precedence.
 Note
When the software pushes operations to a DBMS, the DBMS determines the precedence based on DBMS
rules.
Operator Description
+ Addition
- Subtraction
* Multiplication
/ Division
= Assignment, comparison
< Comparison, less than
<= Comparison, less than or equal to
Reference Guide
Data Services scripting language PUBLIC 1291
Operator Description
> Comparison, greater than
>= Comparison, greater than or equal to
!= Comparison, not equal to
|| Concatenate
% Return the remainder when one number is divided by another
AND Logical AND
OR Logical OR
NOT Logical NOT
IS NULL Comparison, is a NULL value
IS NOT NULL Comparison, is not a NULL value
LIKE Comparison, matches a specific character string with a specified pattern.
Use the following wildcards with LIKE:
• %: A string of zero or more characters.
• _ (underscore): A single character.
• []: A single character with a specific range or set.
• [^]: A single character not within the specified range or set.
 Note
LIKE does not support the function character ‘[‘ inside a rang. For example, ‘\[\[\]%’ .
NOT LIKE Comparison, excludes rows that match the LIKE criterion.
When you use the smart editor to add operators, type operators or use the built-in key pad. Access the key pad
from the smart editor tool bar.
Use a comparison operator in the following ways:
• In a script or script function as a condition; for example:
if ($x IN (1,2,3)), while ($x IN (1,2,3)) and ifthenelse()
• In a data flow such as in a WHERE clause ifthenelse() function, case transform, etc.
• As a condition of the IF block, WHILE block or TRY CATCH block
The following examples illustrate valid comparison expression syntax:
expression = expression
expression != expression
expression < expression
expression > expression
expression <= expression
expression >= expression
expression IS NULL
expression IS NOT NULL
expression IN (expression list)
expression IN domain
expression LIKE constant
1292 PUBLIC
Reference Guide
Data Services scripting language
expression NOT LIKE constant
NOT (any of the valid comparisons); for example NOT ($x IN (1,2,3))
comparison OR comparison
comparison AND comparison
The following syntax is not valid:
$x NOT IN (1,2,3)
EXIST or NOT EXIST 
Parent topic: Data Services scripting language [page 1291]
Related Information
SAP scripting language keywords [page 1293]
7.2 SAP scripting language keywords
Keywords are select words in the scripting language that you use in expressions based on syntax rules and
desired behavior.
Keywords are listed in the selection list of the smart editor filtered by the context from which the smart editor is
opened.
BEGIN [page 1294]
The keyword BEGIN indicates the beginning of the code that becomes the function, script, or other
construct.
CATCH [page 1294]
The keyword CATCH indicates a catch for a try—catch block.
ELSE [page 1295]
The keyword ELSE defines the second branch for an IF statement.
END [page 1296]
The keyword END indicates the end of the code that becomes the function, script, or other construct.
IF [page 1296]
The keyword IF indicates a conditional step in the code.
RETURN [page 1297]
The keyword RETURN indicates the value to be returned by a function.
TRY [page 1297]
The keyword TRY indicates the start of a try—catch block.
WHILE [page 1298]
The keyword WHILE defines a set of statements to execute until a condition evaluates to FALSE.
Reference Guide
Data Services scripting language PUBLIC 1293
Parent topic: Data Services scripting language [page 1291]
Related Information
SAP scripting language operators [page 1291]
7.2.1  BEGIN
The keyword BEGIN indicates the beginning of the code that becomes the function, script, or other construct.
The software automatically adds BEGIN and END statements to function, transform, and script definitions.
Parent topic: SAP scripting language keywords [page 1293]
Related Information
CATCH [page 1294]
ELSE [page 1295]
END [page 1296]
IF [page 1296]
RETURN [page 1297]
TRY [page 1297]
WHILE [page 1298]
7.2.2  CATCH
The keyword CATCH indicates a catch for a try—catch block.
If an error occurs while executing any of the statements between the TRY and the CATCH statements, the
software executes the statements defined by the CATCH. Use the CATCH keyword as shown in the following
script, or use CATCH(ALL).
BEGIN
TRY
 BEGIN
 <script_step>;
 <script_step>;
 END
CATCH (<exception_number>)
 BEGIN
 <catch_step>;
1294 PUBLIC
Reference Guide
Data Services scripting language
 <catch_step>;
 END
CATCH (<exception_number>)
 BEGIN
 <catch_step>;
 <catch_step>;
 END
END
Parent topic: SAP scripting language keywords [page 1293]
Related Information
BEGIN [page 1294]
ELSE [page 1295]
END [page 1296]
IF [page 1296]
RETURN [page 1297]
TRY [page 1297]
WHILE [page 1298]
7.2.3  ELSE
The keyword ELSE defines the second branch for an IF statement.
If there is no ELSE following an IF statement, the software takes no action if the condition is not met.
Parent topic: SAP scripting language keywords [page 1293]
Related Information
BEGIN [page 1294]
CATCH [page 1294]
END [page 1296]
IF [page 1296]
RETURN [page 1297]
TRY [page 1297]
WHILE [page 1298]
Reference Guide
Data Services scripting language PUBLIC 1295
7.2.4  END
The keyword END indicates the end of the code that becomes the function, script, or other construct.
The software automatically adds BEGIN and END statements to function, transform, and script definitions.
Parent topic: SAP scripting language keywords [page 1293]
Related Information
BEGIN [page 1294]
CATCH [page 1294]
ELSE [page 1295]
IF [page 1296]
RETURN [page 1297]
TRY [page 1297]
WHILE [page 1298]
7.2.5  IF
The keyword IF indicates a conditional step in the code.
Construct an IF statement with or without an ELSE step. Use the IF keyword as follows:
IF (<condition>) <script_step>; ELSE <script_step>;
or
IF (<condition>) <script_step>;
where <condition> is an expression that evaluates to True or False. <script_step> indicates the set of
instructions to execute based on the value of <condition> . If <script_step> contains more than one
statement, enclose these statements in BEGIN and END statements.
Parent topic: SAP scripting language keywords [page 1293]
Related Information
BEGIN [page 1294]
CATCH [page 1294]
ELSE [page 1295]
END [page 1296]
1296 PUBLIC
Reference Guide
Data Services scripting language
RETURN [page 1297]
TRY [page 1297]
WHILE [page 1298]
7.2.6  RETURN
The keyword RETURN indicates the value to be returned by a function.
Use the RETURN keyword as follows:
RETURN (<expression>);
where <expression> defines the value to be returned.
Parent topic: SAP scripting language keywords [page 1293]
Related Information
BEGIN [page 1294]
CATCH [page 1294]
ELSE [page 1295]
END [page 1296]
IF [page 1296]
TRY [page 1297]
WHILE [page 1298]
7.2.7  TRY
The keyword TRY indicates the start of a try—catch block.
Parent topic: SAP scripting language keywords [page 1293]
Related Information
BEGIN [page 1294]
CATCH [page 1294]
ELSE [page 1295]
END [page 1296]
IF [page 1296]
Reference Guide
Data Services scripting language PUBLIC 1297
RETURN [page 1297]
WHILE [page 1298]
CATCH [page 1294]
7.2.8  WHILE
The keyword WHILE defines a set of statements to execute until a condition evaluates to FALSE.
Use the WHILE keyword as follows:
WHILE (<condition>) <script_step>;
where <condition> is an expression that evaluates to True or False. <script_step> indicates the set of
instructions to execute based on the value of <condition>. If <script_step> contains more than one
statement, enclose each statement in BEGIN and END statements.
Parent topic: SAP scripting language keywords [page 1293]
Related Information
BEGIN [page 1294]
CATCH [page 1294]
ELSE [page 1295]
END [page 1296]
IF [page 1296]
RETURN [page 1297]
TRY [page 1297]